!function(e,r){"use strict";r.fileM=e.module("file.manager",["crip.core","angular-loading-bar","angularFileUpload","ngCookies","ngResource","ngSanitize","ui.bootstrap","ui-notification","io.dennis.contextmenu"])}(angular,window.crip||(window.crip={})),function(){"use strict";angular.module("app",["file.manager"])}(),function(e,r,n){"use strict";function t(e){var n=r("#settings");e.fireBroadcast=function(r,n){e.$broadcast(r,n)},e.baseUrl=function(){return n.data("base-url")}}n.fileM.run(t),t.$inject=["$rootScope"]}(angular,jQuery,window.crip||(window.crip={})),function(e,r){"use strict";function n(r,n,t,o,i,a){function l(){n.isDir=d,n.isDirUp=c,n._error=u,n._warning=f,n._success=m,n.manager={path:"/"},a.query(g)}function d(r){return r&&e.isDefined(r.mime)&&"dir"===r.mime}function c(e){return d(e)&&".."==e.name}function s(r){var n=!1;return e.isDefined(r.notification)&&(n=r.notification),e.isDefined(r.data)&&e.isDefined(r.data.notification)&&(n=r.data.notification),n?{hasMessage:!0,message:n}:{hasMessage:!1}}function u(e){n.fireBroadcast("_error");var r=s(e);r.hasMessage&&o.error({message:r.message})}function f(e){n.fireBroadcast("_warning");var r=s(e);r.hasMessage&&o.error({message:r.message})}function m(e){var r=s(e);r.hasMessage&&o.success({message:r.message})}function g(e){i.extend(e),n.fireBroadcast("tree-changed",e.dirs()),n.fireBroadcast("folder-changed",e.items())}l()}r.fileM.controller("BaseController",n),n.$inject=["$log","$scope","$cookies","Notification","DirService","Dir"]}(angular,window.crip||(window.crip={})),function(e,r){"use strict";function n(r,n,t,o,i,a,l){function d(){n.folder={loading:!0,creating:!1,name:"",items:[],filters:{image:!0,media:!0,document:!0,file:!0},order:{func:h,change:w,by:"name",reverse:!1,name:!0,size:!1,date:!1},enableCreate:C,create:F,refresh:$,isFiltersEnabled:v},n.folderFilter=p}function c(){return n.folder.loading?(r.warn("FolderController -> loading","Previous item still loading"),!1):!0}function s(e){n.folder.loading=!1}function u(e,r){c()&&(n.folder.loading=!0,i.query(r,function(e){n._success(e),y(e,r)},n._error))}function f(e,r){n.folder.loading=!1,n.folder.items=r}function m(e,r){a.extendItem(r,n.folder.items.length),n.folder.items.unshift(r)}function g(e,r){}function p(r,t,o){if(e.isDefined(r.type)){if("dir"==r.type)return!0;if(v())return n.folder.filters[r.type];if(l.getType()==r.type)return!0}return!1}function h(e){return"dir"===e.type?".."==e.name?-1:"0 "+e[n.folder.order.by]:"z"+e[n.folder.order.by]}function w(e){n.folder.order.by=e;var r=["name","size","date"];for(var t in r)r.hasOwnProperty(t)&&(n.folder.order[r[t]]=!1);return n.folder.order[e]=!0,!1}function v(){return"file"==l.getType()}function $(){c()&&(n.folder.loading=!0,n.manager.path=n.manager.path.replace(/^\/|\/$/g,""),i.query({path:n.manager.path||"/"},function(e){y(e,n.manager)},n._error))}function y(e,o){r.log("FolderController -> changeFolder -> onFolderChanged",{response:e,folder:o}),a.extend(e),n.folder.items=e.items(),n.folder.loading=!1,n.manager.path="/"+(o.path||""),t.put("path",o.path||"")}function C(){n.folder.creating=!0,o("#create-dir-input")}function F(){c()&&n.folder.name&&""!==n.folder.name&&a.create(n.manager.path,n.folder.name,b,n._error)}function b(e){r.log("FolderController -> create -> onFolderCreated",{response:e}),n._success(e),n.folder.creating=!1,n.folder.name="";var t=e.data;a.extendItem(t,n.folder.items.length),n.folder.items.unshift(t),n.fireBroadcast("folder-created",t)}d(),n.$on("_error",s),n.$on("_warning",s),n.$on("change-folder",u),n.$on("folder-changed",f),n.$on("file-uploaded",m),n.$on("folder-deleted",g),n.$on("file-deleted",g)}r.fileM.controller("FolderController",n),n.$inject=["$log","$scope","$cookies","focus","Dir","DirService","Settings"]}(angular,window.crip||(window.crip={})),function(e,r,n,t,o){"use strict";function i(r,i,a,l,d,c){function s(){i.click=u,i.canRename=f,i.enableRename=m,i.disableRename=h,i.rename=g,i.select=$,i.hasThumbs=b,i.thumbName=D,i["delete"]=y}function u(e){return i.folder.loading?void r.warn("FolderItemController -> click","Previous item still loading"):(r.log("FolderItemController -> click",{item:e}),i.isDir(e)?void i.fireBroadcast("change-folder",e):void $(e))}function f(e){return!i.isDirUp(e)}function m(e){if(e.rename=!0,i.isDir(e))e.newName=e.name;else{e.ext=e.name.split(".").pop();var r=0;e.ext.length&&(r=e.ext.length+1),e.newName=e.name.substring(0,e.name.length-r)}a("#"+e.id+" input")}function g(){return i.isDir(i.item)?void(".."!=i.item.name&&l.rename(i.manager.path,i.item.name,i.item.newName,w,i._error)):void d.rename(i.manager.path,i.item.name,p(i.item),v,i._error)}function p(r){return e.isDefined(r.ext)&&r.ext.length?r.newName+"."+r.ext:r.newName}function h(e){e.rename=!1}function w(n){r.log("FolderItemController -> onFolderRenamed",{response:n,item:i.item}),i._success(n);var t=e.copy(i.item);i.item.rename=!1,i.item.path=n.data.path,i.item.name=n.data.name,i.item.url=n.data.url,i.fireBroadcast("folder-renamed",{"new":n.data,old:t})}function v(e){r.log("FolderItemController -> onFileRenamed",{response:e}),i._success(e),i.item.rename=!1,i.item.name=e.data.name,i.item.url=e.data.url,i.item.thumbs=e.data.thumbs}function $(e,o){var i=e.url;if(o&&(i=e.thumbs[o]),c.isTarget("tinyMCE"))if(r.info("FolderItemController -> select -> tinymce",{tinymce:n.tinymce}),n.tinymce.majorVersion<4){n.tinymce.activeEditor.windowManager.params.setUrl(i);var a=n.tinymce.activeEditor.windowManager.params.mce_window_id;n.tinymce.activeEditor.windowManager.close(a)}else r.info("FolderItemController -> select -> tinymce4",{params:n.tinymce.activeEditor.windowManager.getParams()}),n.tinymce.activeEditor.windowManager.getParams().setUrl(i),n.tinymce.activeEditor.windowManager.close();if(c.isTarget("callback")){var l=t.filemanager||t.parent.filemanager||{};l&&l.onSelected&&l.onSelected(i,c.getParams())}}function y(e){return i.isDir(e)?void(".."!=e.name&&l["delete"](i.manager.path,e.name,C,i._error)):void d["delete"](i.manager.path,e.name,F,i._error)}function C(e){r.log("FolderItemController -> onFolderDeleted",{response:e}),i._success(e),i.fireBroadcast("folder-deleted",e.data)}function F(e){r.log("FolderItemController -> onFileDeleted",{response:e}),i._success(e),i.fireBroadcast("file-deleted",e.data)}function b(r){return!!r&&e.isDefined(r.thumbs)&&o.keys(r.thumbs).length>1}function D(e,r,n){if(e){var t=c.getThumbSize(e);r=t[0],n=t[1]}var o="({width} x {height})",i={width:r,height:n};return o.supplant(i)}r.log("FolderItemController controller <- started"),s()}e.module("file.manager").controller("FolderItemController",i),i.$inject=["$log","$scope","focus","DirService","FileService","Settings"]}(angular,jQuery,top,window,Object),function(e,r){"use strict";function n(r,n,t,o){function i(){n.isOpen=u,n.isEmpty=f,n.changeFolder=g,n.tree={loading:!0,items:[],root:{name:"/",url:n.baseUrl+"dir"},expand:m}}function a(e){n.tree.loading=!1}function l(e,t){r.log("TreeController -> treeChanged",{event:e,tree:t}),n.tree.items=t,n.tree.loading=!1}function d(e,t){r.log("TreeController -> onFolderCreated",{event:e,folder:t}),-1===t.path.indexOf("/")&&n.tree.items.unshift(t)}function c(e,t){var o=t.old,i=t["new"];r.log("TreeController -> onFolderRenamed",{event:e,newFolder:i,oldFolder:o});for(var a=0;a<n.tree.items.length;a++)n.tree.items[a].path==o.path&&(n.tree.items[a].path=i.path,n.tree.items[a].name=i.name,n.tree.items[a].url=i.url)}function s(e,t){r.log("TreeController -> removeByPath",{event:e,item:t,items:n.tree.items}),n.tree.items.removeItem(t.path,"path")}function u(r){return r&&e.isDefined(r.folders)}function f(e){return u(e)?0==e.folders.length:!1}function m(e){return n.tree.loading||f(e)?void r.warn("TreeController -> expand","Previous item still loading"):(r.log("TreeController -> expand",{curr:e}),u(e)?void(e.folders=void 0):(n.tree.loading=!0,void t.query({path:e.path},function(r){o.extend(r),n.tree.loading=!1,e.folders=r.dirs()},n._error)))}function g(e){n.fireBroadcast("change-folder",e)}r.log("TreeController controller <- started"),i(),n.$on("_error",a),n.$on("_warning",a),n.$on("tree-changed",l),n.$on("folder-created",d),n.$on("folder-renamed",c),n.$on("folder-deleted",s)}e.module("file.manager").controller("TreeController",n),n.$inject=["$log","$scope","Dir","DirService"]}(angular,jQuery),function(e,r){"use strict";function n(r,n,t){function o(){n.uploader=new t({url:i})}function i(){return n.baseUrl()+"file/upload"+n.manager.path}r.log("UploadController controller <- started"),o(),n.uploader.onWhenAddingFileFailed=function(e,n,t){r.info("onWhenAddingFileFailed",e,n,t)},n.uploader.onAfterAddingFile=function(e){e.uploader.url=e.url=i(),r.info("onAfterAddingFile",e)},n.uploader.onErrorItem=function(e,n,t,o){r.info("onErrorItem",e,t,o)},n.uploader.onCompleteItem=function(e,t,o,i){200===o&&(r.info("UploadController -> uploader -> onCompleteItem",{fileItem:e,response:t,status:o,headers:i}),n.fireBroadcast("file-uploaded",t),n._success(t))},n.uploader.onCompleteAll=function(){r.info("UploadController -> uploader -> onCompleteAll",{uploader:n.uploader});var t=!1;e.forEach(n.uploader.queue,function(e){e.isReady||e.isUploading||e.isSuccess||(t=!0)}),t||n.uploader.clearQueue()}}e.module("file.manager").controller("UploadController",n),n.$inject=["$log","$scope","FileUploader"]}(angular,jQuery),function(e,r){"use strict";function n(r,n,t){function o(r){e.isDefined(r.DirServiceExtended)&&r.DirServiceExtended||(e.extend(r,{dirs:function(){var n=[];return e.forEach(r,function(e,r){"dir"===e.mime&&".."!=e.full_name&&(c(e,r),this.push(e))},n),n},items:function(){var n=[];return e.forEach(r,function(e,r){c(e,r),this.push(e)},n),n}}),r.DirServiceExtended=!0)}function i(e,r,o,i,a){var l=n.baseUrl()+"dir/rename/"+e;t.post(l,{old:r,"new":o}).then(i,a)}function a(e,r,o,i){var a=n.baseUrl()+"dir/create/"+e;t.post(a,{name:r}).then(o,i)}function l(e,r,o,i){var a=n.baseUrl()+"dir/delete/"+e;t.post(a,{name:r}).then(o,i)}function d(e){return"list-item-"+e}function c(e,r){e.id=d(r)}return{extend:o,extendItem:c,rename:i,create:a,"delete":l,idGen:d}}r.fileM.service("DirService",n),n.$inject=["$log","$rootScope","$http"]}(angular,window.crip||(window.crip={})),function(e,r){"use strict";function n(e,r,n){function t(t,o,i,a,l){e.log("FileService -> rename",{dir:t,oldName:o,newName:i});var d=r.baseUrl()+"file/rename/"+t;n.post(d,{old:o,"new":i}).then(a,l)}function o(t,o,i,a){e.log("FileService -> delete",{dir:t,name:o});var l=r.baseUrl()+"file/delete/"+t;n.post(l,{name:o}).then(i,a)}return{rename:t,"delete":o}}r.fileM.service("FileService",n),n.$inject=["$log","$rootScope","$http"]}(angular,window.crip||(window.crip={})),function(e,r,n){"use strict";function t(){function n(e){return a().target.toLowerCase()===e.toLowerCase()}function t(){return(a().type?d.type.toLowerCase():!1)||"file"}function o(r){var n=e.fromJson(l.data("sizes").replace(/\'/g,'"'));return n[r]}function a(){if(!d){var e=l.data("params");if(0===e.length)return{};d=i(e)}return d}var l=r("#settings"),d=!1;return{isTarget:n,getType:t,getThumbSize:o,getParams:a}}function o(e){return e.replace(/\'/g,'"')}function i(r){return e.fromJson(o(r))}n.fileM.service("Settings",t)}(angular,jQuery,window.crip||(window.crip={})),function(e){"use strict";function r(e,r,n){return r(n.baseUrl()+"dir/:dir/:name",{dir:"@dir",name:"@name"})}e.fileM.service("Dir",r),r.$inject=["$log","$resource","$rootScope"]}(window.crip||(window.crip={}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zb3VyY2UvZmlsZW1hbmFnZXIvbW9kdWxlLmpzIiwiL3NvdXJjZS9hcHAuanMiLCIvc291cmNlL3J1bi5qcyIsIi9zb3VyY2UvY29udHJvbGxlcnMvQmFzZUNvbnRyb2xsZXIuanMiLCIvc291cmNlL2NvbnRyb2xsZXJzL0ZvbGRlckNvbnRyb2xsZXIuanMiLCIvc291cmNlL2NvbnRyb2xsZXJzL0ZvbGRlckl0ZW1Db250cm9sbGVyLmpzIiwiL3NvdXJjZS9jb250cm9sbGVycy9UcmVlQ29udHJvbGxlci5qcyIsIi9zb3VyY2UvY29udHJvbGxlcnMvVXBsb2FkQ29udHJvbGxlci5qcyIsIi9zb3VyY2Uvc2VydmljZXMvRGlyU2VydmljZS5qcyIsIi9zb3VyY2Uvc2VydmljZXMvRmlsZVNlcnZpY2UuanMiLCIvc291cmNlL3NlcnZpY2VzL1NldHRpbmdzLmpzIiwiL3NvdXJjZS9yZXNvdXJjZXMvRGlyLmpzIl0sIm5hbWVzIjpbIm5nIiwiY3JpcCIsImZpbGVNIiwibW9kdWxlIiwiYW5ndWxhciIsIndpbmRvdyIsIiQiLCJSdW4iLCIkcm9vdFNjb3BlIiwiJHNldHRpbmdzIiwiZmlyZUJyb2FkY2FzdCIsImV2ZW50TmFtZSIsImFyZ3MiLCIkYnJvYWRjYXN0IiwiYmFzZVVybCIsImRhdGEiLCJydW4iLCIkaW5qZWN0IiwialF1ZXJ5IiwiQmFzZUNvbnRyb2xsZXIiLCIkbG9nIiwiJHNjb3BlIiwiJGNvb2tpZXMiLCJOb3RpZmljYXRpb24iLCJEaXJTZXJ2aWNlIiwiRGlyIiwiYWN0aXZhdGUiLCJpc0RpciIsImlzRGlyVXAiLCJfZXJyb3IiLCJfd2FybmluZyIsIl9zdWNjZXNzIiwibWFuYWdlciIsInBhdGgiLCJxdWVyeSIsIm9uSW5pdGlhbERpckxvYWRlZCIsIml0ZW0iLCJpc0RlZmluZWQiLCJtaW1lIiwibmFtZSIsIl9fcmVzb2x2ZU1lc3NhZ2UiLCJyZXNwb25zZSIsIm5vdGlmaWNhdGlvbiIsImhhc01lc3NhZ2UiLCJtZXNzYWdlIiwiaGFuZGxlciIsImVycm9yIiwic3VjY2VzcyIsImV4dGVuZCIsImRpcnMiLCJpdGVtcyIsImNvbnRyb2xsZXIiLCJGb2xkZXJDb250cm9sbGVyIiwiZm9jdXMiLCJTZXR0aW5ncyIsImZvbGRlciIsImxvYWRpbmciLCJjcmVhdGluZyIsImZpbHRlcnMiLCJpbWFnZSIsIm1lZGlhIiwiZG9jdW1lbnQiLCJmaWxlIiwib3JkZXIiLCJmdW5jIiwiY2hhbmdlIiwiY2hhbmdlT3JkZXIiLCJieSIsInJldmVyc2UiLCJzaXplIiwiZGF0ZSIsImVuYWJsZUNyZWF0ZSIsImNyZWF0ZSIsInJlZnJlc2giLCJpc0ZpbHRlcnNFbmFibGVkIiwiZm9sZGVyRmlsdGVyIiwiX19jYW5Mb2FkIiwid2FybiIsIm9uRXJyb3JIYW5kbGVkIiwiZXZlbnQiLCJjaGFuZ2VGb2xkZXIiLCJyIiwib25Gb2xkZXJDaGFuZ2VkIiwib25Gb2xkZXJFeHRlcm5hbGx5Q2hhbmdlZCIsImFkZE5ld0ZpbGUiLCJleHRlbmRJdGVtIiwibGVuZ3RoIiwidW5zaGlmdCIsInJlbW92ZUJ5UGF0aCIsInZhbHVlIiwiaW5kZXgiLCJhcnJheSIsInR5cGUiLCJnZXRUeXBlIiwibmV3TmFtZSIsIm9wdGlvbnMiLCJpIiwiaGFzT3duUHJvcGVydHkiLCJyZXBsYWNlIiwibG9nIiwicHV0Iiwib25Gb2xkZXJDcmVhdGVkIiwiJG9uIiwidG9wIiwidyIsIk8iLCJGb2xkZXJJdGVtQ29udHJvbGxlciIsIkZpbGVTZXJ2aWNlIiwiY2xpY2siLCJjYW5SZW5hbWUiLCJlbmFibGVSZW5hbWUiLCJkaXNhYmxlUmVuYW1lIiwicmVuYW1lIiwic2VsZWN0IiwiaGFzVGh1bWJzIiwidGh1bWJOYW1lIiwiZGVsZXRlSXRlbSIsImV4dCIsInNwbGl0IiwicG9wIiwiY3V0Iiwic3Vic3RyaW5nIiwiaWQiLCJvbkZvbGRlclJlbmFtZWQiLCJnZXRJdGVtTmV3TmFtZSIsIm9uRmlsZVJlbmFtZWQiLCJjb3B5IiwidXJsIiwibmV3Iiwib2xkIiwidGh1bWJzIiwidGh1bWJJbmRleCIsImZpbGVfdXJsIiwiaXNUYXJnZXQiLCJpbmZvIiwidGlueW1jZSIsIm1ham9yVmVyc2lvbiIsImFjdGl2ZUVkaXRvciIsIndpbmRvd01hbmFnZXIiLCJwYXJhbXMiLCJzZXRVcmwiLCJlZGl0b3JfaWQiLCJtY2Vfd2luZG93X2lkIiwiY2xvc2UiLCJnZXRQYXJhbXMiLCJmaWxlbWFuYWdlciIsInBhcmVudCIsIm9uU2VsZWN0ZWQiLCJvbkZvbGRlckRlbGV0ZWQiLCJvbkZpbGVEZWxldGVkIiwia2V5cyIsIndpZHRoIiwiaGVpZ2h0IiwiZ2V0VGh1bWJTaXplIiwidGVtcGxhdGUiLCJzdXBwbGFudCIsIk9iamVjdCIsIlRyZWVDb250cm9sbGVyIiwiaXNPcGVuIiwiaXNFbXB0eSIsInRyZWUiLCJyb290IiwiZXhwYW5kIiwidHJlZUNoYW5nZWQiLCJpbmRleE9mIiwiZm9sZGVycyIsIm9sZEZvbGRlciIsIm5ld0ZvbGRlciIsInJlbW92ZUl0ZW0iLCJjdXJyRm9sZGVyIiwiY3VyciIsInVuZGVmaW5lZCIsIlVwbG9hZENvbnRyb2xsZXIiLCJGaWxlVXBsb2FkZXIiLCJ1cGxvYWRlciIsIl9nZXRVcGxvYWRQYXRoIiwib25XaGVuQWRkaW5nRmlsZUZhaWxlZCIsImZpbHRlciIsIm9uQWZ0ZXJBZGRpbmdGaWxlIiwiZmlsZUl0ZW0iLCJvbkVycm9ySXRlbSIsInN0YXR1cyIsImhlYWRlcnMiLCJvbkNvbXBsZXRlSXRlbSIsIm9uQ29tcGxldGVBbGwiLCJoYXNOb3RVcGxvYWRlZEZpbGVzIiwiZm9yRWFjaCIsInF1ZXVlIiwiaXNSZWFkeSIsImlzVXBsb2FkaW5nIiwiaXNTdWNjZXNzIiwiY2xlYXJRdWV1ZSIsIiRodHRwIiwiRGlyU2VydmljZUV4dGVuZGVkIiwia2V5IiwiZnVsbF9uYW1lIiwidGhpcyIsInB1c2giLCJkaXIiLCJvbGROYW1lIiwib25TdWNjZXNzIiwib25FcnJvciIsInBvc3QiLCJ0aGVuIiwiZGVsZXRlRGlyIiwiaWRHZW4iLCJkZWxldGUiLCJzZXJ2aWNlIiwiZGVsZXRlRmlsZSIsImN1cnJfdGFyZ2V0IiwidGFyZ2V0IiwidG9Mb3dlckNhc2UiLCJzaXplS2V5Iiwic2l6ZXMiLCJmcm9tSnNvbiIsImRhdGFQYXJhbXMiLCJzdHJGcm9tSnNvbiIsImZpeFNlcmlhbGl6YWJsZVN0ciIsInN0ciIsIiRyZXNvdXJjZSJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxZQUVBQSxHQUFBQyxNQUFBRixFQUFBRyxPQUFBLGdCQUNBLFlBQ0Esc0JBQ0Esb0JBQ0EsWUFDQSxhQUNBLGFBQ0EsZUFDQSxrQkFDQSwyQkFHQUMsUUFBQUMsT0FBQUosT0FBQUksT0FBQUosVUNkQSxXQUNBLFlBRUFHLFNBQUFELE9BQUEsT0FDQSxvQkNMQSxTQUFBQyxFQUFBRSxFQUFBTCxHQUNBLFlBU0EsU0FBQU0sR0FBQUMsR0FDQSxHQUFBQyxHQUFBSCxFQUFBLFlBRUFFLEdBQUFFLGNBQUEsU0FBQUMsRUFBQUMsR0FDQUosRUFBQUssV0FBQUYsRUFBQUMsSUFHQUosRUFBQU0sUUFBQSxXQUNBLE1BQUFMLEdBQUFNLEtBQUEsYUFmQWQsRUFBQUMsTUFDQWMsSUFBQVQsR0FFQUEsRUFBQVUsU0FDQSxlQWNBYixRQUFBYyxPQUFBYixPQUFBSixPQUFBSSxPQUFBSixVQ3JCQSxTQUFBRCxFQUFBQyxHQUNBLFlBU0EsU0FBQWtCLEdBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEVBQUFDLEdBS0EsUUFBQUMsS0FDQUwsRUFBQU0sTUFBQUEsRUFDQU4sRUFBQU8sUUFBQUEsRUFHQVAsRUFBQVEsT0FBQUEsRUFDQVIsRUFBQVMsU0FBQUEsRUFDQVQsRUFBQVUsU0FBQUEsRUFFQVYsRUFBQVcsU0FDQUMsS0FBQSxLQUlBUixFQUFBUyxNQUFBQyxHQVNBLFFBQUFSLEdBQUFTLEdBQ0EsTUFBQUEsSUFBQXBDLEVBQUFxQyxVQUFBRCxFQUFBRSxPQUFBLFFBQUFGLEVBQUFFLEtBUUEsUUFBQVYsR0FBQVEsR0FDQSxNQUFBVCxHQUFBUyxJQUFBLE1BQUFBLEVBQUFHLEtBR0EsUUFBQUMsR0FBQUMsR0FD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RSxLQUFBa0UsT0FBQUMsZ0JBQUFGLEVBQUFFLGNBR0EsUUFBQXRILEtBQ0EsT0FBQW1ELElBQUFwRCxLQUFBK0MsRUFBQS9DLEtBQUF1SCxlQUFBLElBQUEsT0FHQSxRQUFBMUQsR0FBQTJELEdBQ0EsR0FBQUMsR0FBQXJOLEVBQUFzTixTQUFBN00sRUFBQU0sS0FBQSxTQUFBbUYsUUFBQSxNQUFBLEtBRUEsT0FBQW1ILEdBQUFELEdBR0EsUUFBQXBFLEtBQ0EsSUFBQUwsRUFBQSxDQUNBLEdBQUE0RSxHQUFBOU0sRUFBQU0sS0FBQSxTQUVBLElBQUEsSUFBQXdNLEVBQUFqSSxPQUNBLFFBRUFxRCxHQUFBNkUsRUFBQUQsR0FFQSxNQUFBNUUsR0FoQ0EsR0FBQWxJLEdBQUFILEVBQUEsYUFBQXFJLEdBQUEsQ0FFQSxRQUNBTixTQUFBQSxFQUNBeEMsUUFBQUEsRUFDQTRELGFBQUFBLEVBQ0FULFVBQUFBLEdBOEJBLFFBQUF5RSxHQUFBQyxHQUNBLE1BQUFBLEdBQUF4SCxRQUFBLE1BQUEsS0FHQSxRQUFBc0gsR0FBQUUsR0FDQSxNQUFBMU4sR0FBQXNOLFNBQUFHLEVBQUFDLElBN0NBek4sRUFBQUMsTUFDQTZNLFFBQUEsV0FBQXpKLElBOENBbEQsUUFBQWMsT0FBQWIsT0FBQUosT0FBQUksT0FBQUosVUNsREEsU0FBQUEsR0FDQSxZQVNBLFNBQUF3QixHQUFBTCxFQUFBdU0sRUFBQW5OLEdBR0EsTUFBQW1OLEdBQUFuTixFQUFBTSxVQUFBLGtCQUNBd0wsSUFBQSxPQUNBL0osS0FBQSxVQVpBdEMsRUFBQUMsTUFDQTZNLFFBQUEsTUFBQXRMLEdBRUFBLEVBQUFSLFNBQ0EsT0FBQSxZQUFBLGVBV0FaLE9BQUFKLE9BQUFJLE9BQUFKIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24obmcsIGNyaXApe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGNyaXAuZmlsZU0gPSBuZy5tb2R1bGUoJ2ZpbGUubWFuYWdlcicsIFtcbiAgICAgICAgJ2NyaXAuY29yZScsXG4gICAgICAgICdhbmd1bGFyLWxvYWRpbmctYmFyJyxcbiAgICAgICAgJ2FuZ3VsYXJGaWxlVXBsb2FkJyxcbiAgICAgICAgJ25nQ29va2llcycsXG4gICAgICAgICduZ1Jlc291cmNlJyxcbiAgICAgICAgJ25nU2FuaXRpemUnLFxuICAgICAgICAndWkuYm9vdHN0cmFwJyxcbiAgICAgICAgJ3VpLW5vdGlmaWNhdGlvbicsXG4gICAgICAgICdpby5kZW5uaXMuY29udGV4dG1lbnUnXG4gICAgXSk7XG5cbn0pKGFuZ3VsYXIsIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7IiwiLy8gaGVsbG8gZnJvbSBqc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXHJcbiAgICAgICAgJ2ZpbGUubWFuYWdlcidcclxuICAgIF0pO1xyXG5cclxufSkoKTsiLCIoZnVuY3Rpb24gKGFuZ3VsYXIsICQsIGNyaXApIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBjcmlwLmZpbGVNXHJcbiAgICAgICAgLnJ1bihSdW4pO1xyXG5cclxuICAgIFJ1bi4kaW5qZWN0ID0gW1xyXG4gICAgICAgICckcm9vdFNjb3BlJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBSdW4oJHJvb3RTY29wZSkge1xyXG4gICAgICAgIHZhciAkc2V0dGluZ3MgPSAkKCcjc2V0dGluZ3MnKTtcclxuXHJcbiAgICAgICAgJHJvb3RTY29wZS5maXJlQnJvYWRjYXN0ID0gZnVuY3Rpb24gKGV2ZW50TmFtZSwgYXJncykge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoZXZlbnROYW1lLCBhcmdzKTtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkcm9vdFNjb3BlLmJhc2VVcmwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkc2V0dGluZ3MuZGF0YSgnYmFzZS11cmwnKTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59KShhbmd1bGFyLCBqUXVlcnksIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7IiwiKGZ1bmN0aW9uIChuZywgY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuZmlsZU1cclxuICAgICAgICAuY29udHJvbGxlcignQmFzZUNvbnRyb2xsZXInLCBCYXNlQ29udHJvbGxlcik7XHJcblxyXG4gICAgQmFzZUNvbnRyb2xsZXIuJGluamVjdCA9IFtcclxuICAgICAgICAnJGxvZycsICckc2NvcGUnLCAnJGNvb2tpZXMnLCAnTm90aWZpY2F0aW9uJywgJ0RpclNlcnZpY2UnLCAnRGlyJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBCYXNlQ29udHJvbGxlcigkbG9nLCAkc2NvcGUsICRjb29raWVzLCBOb3RpZmljYXRpb24sIERpclNlcnZpY2UsIERpcikge1xyXG4gICAgICAgIC8vJGxvZy5sb2coJ0Jhc2VDb250cm9sbGVyIGNvbnRyb2xsZXIgPC0gc3RhcnRlZCcpO1xyXG5cclxuICAgICAgICBhY3RpdmF0ZSgpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmlzRGlyID0gaXNEaXI7XHJcbiAgICAgICAgICAgICRzY29wZS5pc0RpclVwID0gaXNEaXJVcDtcclxuXHJcbiAgICAgICAgICAgIC8vIG9ubHkgZm9yIHN1Yi1jb250cm9sbGVyIHVzYWdlXHJcbiAgICAgICAgICAgICRzY29wZS5fZXJyb3IgPSBfZXJyb3I7XHJcbiAgICAgICAgICAgICRzY29wZS5fd2FybmluZyA9IF93YXJuaW5nO1xyXG4gICAgICAgICAgICAkc2NvcGUuX3N1Y2Nlc3MgPSBfc3VjY2VzcztcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5tYW5hZ2VyID0ge1xyXG4gICAgICAgICAgICAgICAgcGF0aDogJy8nXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvLyBUT0RPOiBhZGQgY2FjaGluZyBhbmQgbG9hZCBsYXN0IG9wZW5lZCBkaXIgZm9yICRzY29wZS5mb2xkZXIuaXRlbXNcclxuICAgICAgICAgICAgRGlyLnF1ZXJ5KG9uSW5pdGlhbERpckxvYWRlZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDaGVjayBpcyBwYXNzZWQgaXRlbSBpcyBmb2xkZXJcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBpdGVtXHJcbiAgICAgICAgICogQHJldHVybnMgeyp8Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBpc0RpcihpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVtICYmIG5nLmlzRGVmaW5lZChpdGVtLm1pbWUpICYmIGl0ZW0ubWltZSA9PT0gJ2Rpcic7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDaGVjayBpcyBwYXNzZWQgaXRlbSBpcyBkaXIgdG8gZ28gdXBcclxuICAgICAgICAgKiBAcGFyYW0gaXRlbVxyXG4gICAgICAgICAqIEByZXR1cm5zIHsqfGJvb2xlYW58Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBpc0RpclVwKGl0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlzRGlyKGl0ZW0pICYmIGl0ZW0ubmFtZSA9PSAnLi4nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX19yZXNvbHZlTWVzc2FnZShyZXNwb25zZSkge1xyXG4gICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBpZiAobmcuaXNEZWZpbmVkKHJlc3BvbnNlLm5vdGlmaWNhdGlvbikpXHJcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb24gPSByZXNwb25zZS5ub3RpZmljYXRpb247XHJcblxyXG4gICAgICAgICAgICBpZiAobmcuaXNEZWZpbmVkKHJlc3BvbnNlLmRhdGEpICYmIG5nLmlzRGVmaW5lZChyZXNwb25zZS5kYXRhLm5vdGlmaWNhdGlvbikpXHJcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb24gPSByZXNwb25zZS5kYXRhLm5vdGlmaWNhdGlvbjtcclxuXHJcbiAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24pXHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge2hhc01lc3NhZ2U6IHRydWUsIG1lc3NhZ2U6IG5vdGlmaWNhdGlvbn07XHJcblxyXG4gICAgICAgICAgICAvLyRsb2cuZXJyb3IoJ0NhbnQgZ2V0IHVzZXIgZnJpZW5kbHkgbWVzc2FnZSBmcm9tIHJlc3BvbnNlJywge3Jlc3BvbnNlOiByZXNwb25zZX0pO1xyXG4gICAgICAgICAgICByZXR1cm4ge2hhc01lc3NhZ2U6IGZhbHNlfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIF9lcnJvcihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAkc2NvcGUuZmlyZUJyb2FkY2FzdCgnX2Vycm9yJyk7XHJcbiAgICAgICAgICAgIHZhciBoYW5kbGVyID0gX19yZXNvbHZlTWVzc2FnZShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIGlmIChoYW5kbGVyLmhhc01lc3NhZ2UpXHJcbiAgICAgICAgICAgICAgICBOb3RpZmljYXRpb24uZXJyb3Ioe21lc3NhZ2U6IGhhbmRsZXIubWVzc2FnZX0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX3dhcm5pbmcocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZpcmVCcm9hZGNhc3QoJ193YXJuaW5nJyk7XHJcbiAgICAgICAgICAgIHZhciBoYW5kbGVyID0gX19yZXNvbHZlTWVzc2FnZShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIGlmIChoYW5kbGVyLmhhc01lc3NhZ2UpXHJcbiAgICAgICAgICAgICAgICBOb3RpZmljYXRpb24uZXJyb3Ioe21lc3NhZ2U6IGhhbmRsZXIubWVzc2FnZX0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX3N1Y2Nlc3MocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgdmFyIGhhbmRsZXIgPSBfX3Jlc29sdmVNZXNzYWdlKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgaWYgKGhhbmRsZXIuaGFzTWVzc2FnZSlcclxuICAgICAgICAgICAgICAgIE5vdGlmaWNhdGlvbi5zdWNjZXNzKHttZXNzYWdlOiBoYW5kbGVyLm1lc3NhZ2V9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEluaXRpYWwgZGlyIGxvYWQgZm9yIGZvbGRlciBhbmQgdHJlZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHJlc3BvbnNlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gb25Jbml0aWFsRGlyTG9hZGVkKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIC8vJGxvZy5sb2coJ0Jhc2VDb250cm9sbGVyIC0+IG9uSW5pdGlhbERpckxvYWRlZCcsIHtyZXNwb25zZTogcmVzcG9uc2V9KTtcclxuXHJcbiAgICAgICAgICAgIERpclNlcnZpY2UuZXh0ZW5kKHJlc3BvbnNlKTtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS5maXJlQnJvYWRjYXN0KCd0cmVlLWNoYW5nZWQnLCByZXNwb25zZS5kaXJzKCkpO1xyXG4gICAgICAgICAgICAkc2NvcGUuZmlyZUJyb2FkY2FzdCgnZm9sZGVyLWNoYW5nZWQnLCByZXNwb25zZS5pdGVtcygpKTtcclxuXHJcbiAgICAgICAgICAgIC8vJGxvZy5sb2coJ0ZvbGRlckNhY2hlJywge3BhdGg6ICRjb29raWVzLmdldCgncGF0aCcpfSk7XHJcbiAgICAgICAgICAgIC8vaWYgKCEoJGNvb2tpZXMuZ2V0KCdwYXRoJykgPT09ICcvJyB8fCB0eXBlb2YgJGNvb2tpZXMuZ2V0KCdwYXRoJykgPT09ICd1bmRlZmluZWQnKSkge1xyXG4gICAgICAgICAgICAvLyAgICAkc2NvcGUuZmlyZUJyb2FkY2FzdCgnY2hhbmdlLWZvbGRlcicsIHtwYXRoOiAkY29va2llcy5nZXQoJ3BhdGgnKX0pO1xyXG4gICAgICAgICAgICAvL31cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKGFuZ3VsYXIsIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7IiwiKGZ1bmN0aW9uIChuZywgY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuZmlsZU1cclxuICAgICAgICAuY29udHJvbGxlcignRm9sZGVyQ29udHJvbGxlcicsIEZvbGRlckNvbnRyb2xsZXIpO1xyXG5cclxuICAgIEZvbGRlckNvbnRyb2xsZXIuJGluamVjdCA9IFtcclxuICAgICAgICAnJGxvZycsICckc2NvcGUnLCAnJGNvb2tpZXMnLCAnZm9jdXMnLCAnRGlyJywgJ0RpclNlcnZpY2UnLCAnU2V0dGluZ3MnXHJcbiAgICBdO1xyXG5cclxuICAgIGZ1bmN0aW9uIEZvbGRlckNvbnRyb2xsZXIoJGxvZywgJHNjb3BlLCAkY29va2llcywgZm9jdXMsIERpciwgRGlyU2VydmljZSwgU2V0dGluZ3MpIHtcclxuICAgICAgICAvLyRsb2cubG9nKCdGb2xkZXJDb250cm9sbGVyIGNvbnRyb2xsZXIgPC0gc3RhcnRlZCcpO1xyXG5cclxuICAgICAgICBhY3RpdmF0ZSgpO1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlciA9IHtcclxuICAgICAgICAgICAgICAgIGxvYWRpbmc6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGluZzogZmFsc2UsXHJcbiAgICAgICAgICAgICAgICBuYW1lOiAnJyxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBbXSxcclxuICAgICAgICAgICAgICAgIGZpbHRlcnM6IHtcclxuICAgICAgICAgICAgICAgICAgICBpbWFnZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBtZWRpYTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBkb2N1bWVudDogdHJ1ZSxcclxuICAgICAgICAgICAgICAgICAgICBmaWxlOiB0cnVlXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgb3JkZXI6IHtcclxuICAgICAgICAgICAgICAgICAgICBmdW5jOiBvcmRlcixcclxuICAgICAgICAgICAgICAgICAgICBjaGFuZ2U6IGNoYW5nZU9yZGVyLFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIG9yZGVyIGJ5IHByb3BlcnR5XHJcbiAgICAgICAgICAgICAgICAgICAgYnk6ICduYW1lJyxcclxuICAgICAgICAgICAgICAgICAgICByZXZlcnNlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlQ3JlYXRlOiBlbmFibGVDcmVhdGUsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGU6IGNyZWF0ZSxcclxuICAgICAgICAgICAgICAgIHJlZnJlc2g6IHJlZnJlc2gsXHJcbiAgICAgICAgICAgICAgICBpc0ZpbHRlcnNFbmFibGVkOiBpc0ZpbHRlcnNFbmFibGVkXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICRzY29wZS5mb2xkZXJGaWx0ZXIgPSBmb2xkZXJGaWx0ZXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBfX2NhbkxvYWQoKSB7XHJcbiAgICAgICAgICAgIC8vIGRvIG5vdGhpbmcgaWYgZm9sZGVyIHN0aWxsIGxvYWRpbmdcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5mb2xkZXIubG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgJGxvZy53YXJuKCdGb2xkZXJDb250cm9sbGVyIC0+IGxvYWRpbmcnLCAnUHJldmlvdXMgaXRlbSBzdGlsbCBsb2FkaW5nJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdfZXJyb3InLCBvbkVycm9ySGFuZGxlZCk7XHJcbiAgICAgICAgJHNjb3BlLiRvbignX3dhcm5pbmcnLCBvbkVycm9ySGFuZGxlZCk7XHJcbiAgICAgICAgZnVuY3Rpb24gb25FcnJvckhhbmRsZWQoZXZlbnQpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdjaGFuZ2UtZm9sZGVyJywgY2hhbmdlRm9sZGVyKTtcclxuICAgICAgICBmdW5jdGlvbiBjaGFuZ2VGb2xkZXIoZXZlbnQsIGZvbGRlcikge1xyXG4gICAgICAgICAgICBpZiAoIV9fY2FuTG9hZCgpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgLy8kbG9nLmxvZygnRm9sZGVyQ29udHJvbGxlciAtPiBjaGFuZ2VGb2xkZXInLCB7ZXZlbnQ6IGV2ZW50LCBmb2xkZXI6IGZvbGRlcn0pO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICBEaXIucXVlcnkoZm9sZGVyLCBmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLl9zdWNjZXNzKHIpO1xyXG4gICAgICAgICAgICAgICAgb25Gb2xkZXJDaGFuZ2VkKHIsIGZvbGRlcik7XHJcbiAgICAgICAgICAgIH0sICRzY29wZS5fZXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignZm9sZGVyLWNoYW5nZWQnLCBvbkZvbGRlckV4dGVybmFsbHlDaGFuZ2VkKTtcclxuICAgICAgICBmdW5jdGlvbiBvbkZvbGRlckV4dGVybmFsbHlDaGFuZ2VkKGV2ZW50LCBpdGVtcykge1xyXG4gICAgICAgICAgICAvLyRsb2cubG9nKCdGb2xkZXJDb250cm9sbGVyIC0+IG9uRm9sZGVyRXh0ZXJuYWxseUNoYW5nZWQnLCB7ZXZlbnQ6IGV2ZW50LCBpdGVtczogaXRlbXN9KTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5mb2xkZXIuaXRlbXMgPSBpdGVtcztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ2ZpbGUtdXBsb2FkZWQnLCBhZGROZXdGaWxlKTtcclxuICAgICAgICBmdW5jdGlvbiBhZGROZXdGaWxlKGV2ZW50LCBmaWxlKSB7XHJcbiAgICAgICAgICAgIC8vJGxvZy5sb2coJ0ZvbGRlckNvbnRyb2xsZXIgLT4gYWRkTmV3RmlsZScsIHtldmVudDogZXZlbnQsIGZpbGU6IGZpbGV9KTtcclxuICAgICAgICAgICAgRGlyU2VydmljZS5leHRlbmRJdGVtKGZpbGUsICRzY29wZS5mb2xkZXIuaXRlbXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5pdGVtcy51bnNoaWZ0KGZpbGUpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignZm9sZGVyLWRlbGV0ZWQnLCByZW1vdmVCeVBhdGgpO1xyXG4gICAgICAgICRzY29wZS4kb24oJ2ZpbGUtZGVsZXRlZCcsIHJlbW92ZUJ5UGF0aCk7XHJcbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlQnlQYXRoKGV2ZW50LCBpdGVtKSB7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IG5vdyB3ZSBkb250IGhhdmUgcGF0aCBwcm9wZXJ0eSwgZmluZCBhIHdheSB0byByZW1vdmUgaXRlbSBmcm9tIHVpIHdoZW4gZGVsZXRlZFxyXG4gICAgICAgICAgICAvLyRsb2cubG9nKCdGb2xkZXJDb250cm9sbGVyIC0+IHJlbW92ZUJ5UGF0aCcsIHtldmVudDogZXZlbnQsIGl0ZW06IGl0ZW0sIGl0ZW1zOiAkc2NvcGUuZm9sZGVyLml0ZW1zfSk7XHJcbiAgICAgICAgICAgIC8vJHNjb3BlLmZvbGRlci5pdGVtcy5yZW1vdmVJdGVtKGl0ZW0ucGF0aCwgJ3BhdGgnKTtcclxuICAgICAgICAgICAgLy9yZW1vdmVGcm9tQXJyKCRzY29wZS5mb2xkZXIuaXRlbXMsICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGaWx0ZXJzIGZvbGRlciBpdGVtc1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHZhbHVlXHJcbiAgICAgICAgICogQHBhcmFtIGluZGV4XHJcbiAgICAgICAgICogQHBhcmFtIGFycmF5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZm9sZGVyRmlsdGVyKHZhbHVlLCBpbmRleCwgYXJyYXkpIHtcclxuICAgICAgICAgICAgaWYgKG5nLmlzRGVmaW5lZCh2YWx1ZS50eXBlKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKHZhbHVlLnR5cGUgPT0gJ2RpcicpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKGlzRmlsdGVyc0VuYWJsZWQoKSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmZvbGRlci5maWx0ZXJzW3ZhbHVlLnR5cGVdO1xyXG5cclxuICAgICAgICAgICAgICAgIGlmIChTZXR0aW5ncy5nZXRUeXBlKCkgPT0gdmFsdWUudHlwZSlcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb3JkZXIoaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS50eXBlID09PSAnZGlyJykge1xyXG4gICAgICAgICAgICAgICAgaWYgKGl0ZW0ubmFtZSA9PSAnLi4nKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAtMTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAwICsgJyAnICsgaXRlbVskc2NvcGUuZm9sZGVyLm9yZGVyLmJ5XTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgcmV0dXJuICd6JyArIGl0ZW1bJHNjb3BlLmZvbGRlci5vcmRlci5ieV07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjaGFuZ2VPcmRlcihuZXdOYW1lKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5mb2xkZXIub3JkZXIuYnkgPSBuZXdOYW1lO1xyXG4gICAgICAgICAgICB2YXIgb3B0aW9ucyA9IFsnbmFtZScsICdzaXplJywgJ2RhdGUnXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAob3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShpKSlcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUuZm9sZGVyLm9yZGVyW29wdGlvbnNbaV1dID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5vcmRlcltuZXdOYW1lXSA9IHRydWU7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpc0ZpbHRlcnNFbmFibGVkKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gU2V0dGluZ3MuZ2V0VHlwZSgpID09ICdmaWxlJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlZnJlc2goKSB7XHJcbiAgICAgICAgICAgIGlmICghX19jYW5Mb2FkKCkpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIC8vJGxvZy5sb2coJ0ZvbGRlckNvbnRyb2xsZXIgLT4gcmVmcmVzaCcsIHttYW5hZ2VyOiAkc2NvcGUubWFuYWdlcn0pO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAkc2NvcGUubWFuYWdlci5wYXRoID0gJHNjb3BlLm1hbmFnZXIucGF0aC5yZXBsYWNlKC9eXFwvfFxcLyQvZywgJycpO1xyXG4gICAgICAgICAgICBEaXIucXVlcnkoe3BhdGg6ICRzY29wZS5tYW5hZ2VyLnBhdGggfHwgJy8nfSwgZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIG9uRm9sZGVyQ2hhbmdlZChyLCAkc2NvcGUubWFuYWdlcik7XHJcbiAgICAgICAgICAgIH0sICRzY29wZS5fZXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2FsbGJhY2sgZm9yIGZvbGRlciBkYXRhIGxvYWQgY29tcGxldGlvblxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHJlc3BvbnNlXHJcbiAgICAgICAgICogQHBhcmFtIGZvbGRlclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIG9uRm9sZGVyQ2hhbmdlZChyZXNwb25zZSwgZm9sZGVyKSB7XHJcbiAgICAgICAgICAgICRsb2cubG9nKCdGb2xkZXJDb250cm9sbGVyIC0+IGNoYW5nZUZvbGRlciAtPiBvbkZvbGRlckNoYW5nZWQnLFxyXG4gICAgICAgICAgICAgICAge3Jlc3BvbnNlOiByZXNwb25zZSwgZm9sZGVyOiBmb2xkZXJ9KTtcclxuICAgICAgICAgICAgRGlyU2VydmljZS5leHRlbmQocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLml0ZW1zID0gcmVzcG9uc2UuaXRlbXMoKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5tYW5hZ2VyLnBhdGggPSAnLycgKyAoZm9sZGVyLnBhdGggfHwgJycpO1xyXG4gICAgICAgICAgICAkY29va2llcy5wdXQoJ3BhdGgnLCAoZm9sZGVyLnBhdGggfHwgJycpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVuYWJsZUNyZWF0ZSgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5jcmVhdGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIGZvY3VzKCcjY3JlYXRlLWRpci1pbnB1dCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlKCkge1xyXG4gICAgICAgICAgICBpZiAoIV9fY2FuTG9hZCgpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmZvbGRlci5uYW1lICYmICRzY29wZS5mb2xkZXIubmFtZSAhPT0gJycpXHJcbiAgICAgICAgICAgICAgICBEaXJTZXJ2aWNlLmNyZWF0ZSgkc2NvcGUubWFuYWdlci5wYXRoLCAkc2NvcGUuZm9sZGVyLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgb25Gb2xkZXJDcmVhdGVkLCAkc2NvcGUuX2Vycm9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9uRm9sZGVyQ3JlYXRlZChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnRm9sZGVyQ29udHJvbGxlciAtPiBjcmVhdGUgLT4gb25Gb2xkZXJDcmVhdGVkJywge3Jlc3BvbnNlOiByZXNwb25zZX0pO1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLl9zdWNjZXNzKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5jcmVhdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLm5hbWUgPSAnJztcclxuICAgICAgICAgICAgdmFyIGZvbGRlciA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgIERpclNlcnZpY2UuZXh0ZW5kSXRlbShmb2xkZXIsICRzY29wZS5mb2xkZXIuaXRlbXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5pdGVtcy51bnNoaWZ0KGZvbGRlcik7XHJcbiAgICAgICAgICAgICRzY29wZS5maXJlQnJvYWRjYXN0KCdmb2xkZXItY3JlYXRlZCcsIGZvbGRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KShhbmd1bGFyLCB3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSkpOyIsIihmdW5jdGlvbiAoYW5ndWxhciwgJCwgdG9wLCB3LCBPKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2ZpbGUubWFuYWdlcicpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0ZvbGRlckl0ZW1Db250cm9sbGVyJywgRm9sZGVySXRlbUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIEZvbGRlckl0ZW1Db250cm9sbGVyLiRpbmplY3QgPSBbXHJcbiAgICAgICAgJyRsb2cnLCAnJHNjb3BlJywgJ2ZvY3VzJywgJ0RpclNlcnZpY2UnLCAnRmlsZVNlcnZpY2UnLCAnU2V0dGluZ3MnXHJcbiAgICBdO1xyXG5cclxuICAgIGZ1bmN0aW9uIEZvbGRlckl0ZW1Db250cm9sbGVyKCRsb2csICRzY29wZSwgZm9jdXMsIERpclNlcnZpY2UsIEZpbGVTZXJ2aWNlLCBTZXR0aW5ncykge1xyXG4gICAgICAgICRsb2cubG9nKCdGb2xkZXJJdGVtQ29udHJvbGxlciBjb250cm9sbGVyIDwtIHN0YXJ0ZWQnKTtcclxuXHJcbiAgICAgICAgYWN0aXZhdGUoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jbGljayA9IGNsaWNrO1xyXG4gICAgICAgICAgICAkc2NvcGUuY2FuUmVuYW1lID0gY2FuUmVuYW1lO1xyXG4gICAgICAgICAgICAkc2NvcGUuZW5hYmxlUmVuYW1lID0gZW5hYmxlUmVuYW1lO1xyXG4gICAgICAgICAgICAkc2NvcGUuZGlzYWJsZVJlbmFtZSA9IGRpc2FibGVSZW5hbWU7XHJcbiAgICAgICAgICAgICRzY29wZS5yZW5hbWUgPSByZW5hbWU7XHJcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3QgPSBzZWxlY3Q7XHJcbiAgICAgICAgICAgICRzY29wZS5oYXNUaHVtYnMgPSBoYXNUaHVtYnM7XHJcbiAgICAgICAgICAgICRzY29wZS50aHVtYk5hbWUgPSB0aHVtYk5hbWU7XHJcbiAgICAgICAgICAgICRzY29wZVsnZGVsZXRlJ10gPSBkZWxldGVJdGVtO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRGV0ZXJtaW5lcyBpdGVtIHR5cGUgYW5kIGRvZXMgYWN0aW9uIGZvciB0aGF0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gY2xpY2soaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmZvbGRlci5sb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBhZGQgd2FybmluZyBhYm91dCBsb2FkaW5nXHJcbiAgICAgICAgICAgICAgICAkbG9nLndhcm4oJ0ZvbGRlckl0ZW1Db250cm9sbGVyIC0+IGNsaWNrJywgJ1ByZXZpb3VzIGl0ZW0gc3RpbGwgbG9hZGluZycpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkbG9nLmxvZygnRm9sZGVySXRlbUNvbnRyb2xsZXIgLT4gY2xpY2snLCB7aXRlbTogaXRlbX0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRzY29wZS5pc0RpcihpdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpcmVCcm9hZGNhc3QoJ2NoYW5nZS1mb2xkZXInLCBpdGVtKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2VsZWN0KGl0ZW0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FuUmVuYW1lKGl0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuICEkc2NvcGUuaXNEaXJVcChpdGVtKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIE9uIHJlbmFtZSBpdGVtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZW5hYmxlUmVuYW1lKGl0ZW0pIHtcclxuICAgICAgICAgICAgaXRlbS5yZW5hbWUgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmlzRGlyKGl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLm5ld05hbWUgPSBpdGVtLm5hbWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmV4dCA9IGl0ZW0ubmFtZS5zcGxpdCgnLicpLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1dCA9IDA7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5leHQubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgIGN1dCA9IGl0ZW0uZXh0Lmxlbmd0aCArIDE7XHJcblxyXG4gICAgICAgICAgICAgICAgaXRlbS5uZXdOYW1lID0gaXRlbS5uYW1lLnN1YnN0cmluZygwLCBpdGVtLm5hbWUubGVuZ3RoIC0gY3V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb2N1cygnIycgKyBpdGVtLmlkICsgJyBpbnB1dCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVuYW1lKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmlzRGlyKCRzY29wZS5pdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5pdGVtLm5hbWUgIT0gJy4uJylcclxuICAgICAgICAgICAgICAgICAgICBEaXJTZXJ2aWNlLnJlbmFtZSgkc2NvcGUubWFuYWdlci5wYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbS5uYW1lLCAkc2NvcGUuaXRlbS5uZXdOYW1lLCBvbkZvbGRlclJlbmFtZWQsICRzY29wZS5fZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBGaWxlU2VydmljZS5yZW5hbWUoJHNjb3BlLm1hbmFnZXIucGF0aCxcclxuICAgICAgICAgICAgICAgICRzY29wZS5pdGVtLm5hbWUsIGdldEl0ZW1OZXdOYW1lKCRzY29wZS5pdGVtKSwgb25GaWxlUmVuYW1lZCwgJHNjb3BlLl9lcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRJdGVtTmV3TmFtZShpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChpdGVtLmV4dCkgJiYgaXRlbS5leHQubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubmV3TmFtZSArICcuJyArIGl0ZW0uZXh0O1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbS5uZXdOYW1lO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZGlzYWJsZVJlbmFtZShpdGVtKSB7XHJcbiAgICAgICAgICAgIGl0ZW0ucmVuYW1lID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvbkZvbGRlclJlbmFtZWQocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJGxvZy5sb2coJ0ZvbGRlckl0ZW1Db250cm9sbGVyIC0+IG9uRm9sZGVyUmVuYW1lZCcsIHtyZXNwb25zZTogcmVzcG9uc2UsIGl0ZW06ICRzY29wZS5pdGVtfSk7XHJcbiAgICAgICAgICAgICRzY29wZS5fc3VjY2VzcyhyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIHZhciBjb3B5ID0gYW5ndWxhci5jb3B5KCRzY29wZS5pdGVtKTtcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW0ucmVuYW1lID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IGNyZWF0ZSBpdGVtIGF1dG9tYXBwZXJcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW0ucGF0aCA9IHJlc3BvbnNlLmRhdGEucGF0aDtcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW0ubmFtZSA9IHJlc3BvbnNlLmRhdGEubmFtZTtcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW0udXJsID0gcmVzcG9uc2UuZGF0YS51cmw7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuZmlyZUJyb2FkY2FzdCgnZm9sZGVyLXJlbmFtZWQnLCB7J25ldyc6IHJlc3BvbnNlLmRhdGEsIG9sZDogY29weX0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb25GaWxlUmVuYW1lZChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnRm9sZGVySXRlbUNvbnRyb2xsZXIgLT4gb25GaWxlUmVuYW1lZCcsIHtyZXNwb25zZTogcmVzcG9uc2V9KTtcclxuICAgICAgICAgICAgJHNjb3BlLl9zdWNjZXNzKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW0ucmVuYW1lID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5pdGVtLm5hbWUgPSByZXNwb25zZS5kYXRhLm5hbWU7XHJcbiAgICAgICAgICAgICRzY29wZS5pdGVtLnVybCA9IHJlc3BvbnNlLmRhdGEudXJsO1xyXG4gICAgICAgICAgICAkc2NvcGUuaXRlbS50aHVtYnMgPSByZXNwb25zZS5kYXRhLnRodW1icztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdChpdGVtLCB0aHVtYkluZGV4KSB7XHJcbiAgICAgICAgICAgIHZhciBmaWxlX3VybCA9IGl0ZW0udXJsO1xyXG4gICAgICAgICAgICBpZiAoISF0aHVtYkluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBmaWxlX3VybCA9IGl0ZW0udGh1bWJzW3RodW1iSW5kZXhdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBpZiBzZWxlY3QgZm9yIHRpbnlNQ0VcclxuICAgICAgICAgICAgaWYgKFNldHRpbmdzLmlzVGFyZ2V0KCd0aW55TUNFJykpIHtcclxuICAgICAgICAgICAgICAgICRsb2cuaW5mbygnRm9sZGVySXRlbUNvbnRyb2xsZXIgLT4gc2VsZWN0IC0+IHRpbnltY2UnLCB7dGlueW1jZTogdG9wLnRpbnltY2V9KTtcclxuICAgICAgICAgICAgICAgIGlmICh0b3AudGlueW1jZS5tYWpvclZlcnNpb24gPCA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wLnRpbnltY2UuYWN0aXZlRWRpdG9yLndpbmRvd01hbmFnZXIucGFyYW1zLnNldFVybChmaWxlX3VybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVkaXRvcl9pZCA9IHRvcC50aW55bWNlLmFjdGl2ZUVkaXRvci53aW5kb3dNYW5hZ2VyLnBhcmFtcy5tY2Vfd2luZG93X2lkO1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcC50aW55bWNlLmFjdGl2ZUVkaXRvci53aW5kb3dNYW5hZ2VyLmNsb3NlKGVkaXRvcl9pZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkbG9nLmluZm8oJ0ZvbGRlckl0ZW1Db250cm9sbGVyIC0+IHNlbGVjdCAtPiB0aW55bWNlNCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtwYXJhbXM6IHRvcC50aW55bWNlLmFjdGl2ZUVkaXRvci53aW5kb3dNYW5hZ2VyLmdldFBhcmFtcygpfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wLnRpbnltY2UuYWN0aXZlRWRpdG9yLndpbmRvd01hbmFnZXIuZ2V0UGFyYW1zKCkuc2V0VXJsKGZpbGVfdXJsKTtcclxuICAgICAgICAgICAgICAgICAgICB0b3AudGlueW1jZS5hY3RpdmVFZGl0b3Iud2luZG93TWFuYWdlci5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoU2V0dGluZ3MuaXNUYXJnZXQoJ2NhbGxiYWNrJykpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmaWxlbWFuYWdlciA9IHcuZmlsZW1hbmFnZXIgfHwgdy5wYXJlbnQuZmlsZW1hbmFnZXIgfHwge307XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoZmlsZW1hbmFnZXIgJiYgZmlsZW1hbmFnZXIub25TZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVtYW5hZ2VyLm9uU2VsZWN0ZWQoZmlsZV91cmwsIFNldHRpbmdzLmdldFBhcmFtcygpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlSXRlbShpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuaXNEaXIoaXRlbSkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLm5hbWUgIT0gJy4uJylcclxuICAgICAgICAgICAgICAgICAgICBEaXJTZXJ2aWNlLmRlbGV0ZSgkc2NvcGUubWFuYWdlci5wYXRoLCBpdGVtLm5hbWUsIG9uRm9sZGVyRGVsZXRlZCwgJHNjb3BlLl9lcnJvcik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgRmlsZVNlcnZpY2UuZGVsZXRlKCRzY29wZS5tYW5hZ2VyLnBhdGgsIGl0ZW0ubmFtZSwgb25GaWxlRGVsZXRlZCwgJHNjb3BlLl9lcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvbkZvbGRlckRlbGV0ZWQocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJGxvZy5sb2coJ0ZvbGRlckl0ZW1Db250cm9sbGVyIC0+IG9uRm9sZGVyRGVsZXRlZCcsIHtyZXNwb25zZTogcmVzcG9uc2V9KTtcclxuICAgICAgICAgICAgJHNjb3BlLl9zdWNjZXNzKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZpcmVCcm9hZGNhc3QoJ2ZvbGRlci1kZWxldGVkJywgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvbkZpbGVEZWxldGVkKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICRsb2cubG9nKCdGb2xkZXJJdGVtQ29udHJvbGxlciAtPiBvbkZpbGVEZWxldGVkJywge3Jlc3BvbnNlOiByZXNwb25zZX0pO1xyXG4gICAgICAgICAgICAkc2NvcGUuX3N1Y2Nlc3MocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAkc2NvcGUuZmlyZUJyb2FkY2FzdCgnZmlsZS1kZWxldGVkJywgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBoYXNUaHVtYnMoaXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gISFpdGVtICYmIGFuZ3VsYXIuaXNEZWZpbmVkKGl0ZW0udGh1bWJzKSAmJiBPLmtleXMoaXRlbS50aHVtYnMpLmxlbmd0aCA+IDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0aHVtYk5hbWUodGh1bWJJbmRleCwgd2lkdGgsIGhlaWdodCkge1xyXG4gICAgICAgICAgICBpZiAodGh1bWJJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSBTZXR0aW5ncy5nZXRUaHVtYlNpemUodGh1bWJJbmRleCk7XHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9IHNpemVbMF07XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBzaXplWzFdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9ICcoe3dpZHRofSB4IHtoZWlnaHR9KScsXHJcbiAgICAgICAgICAgICAgICBwYXJhbXMgPSB7d2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGVtcGxhdGUuc3VwcGxhbnQocGFyYW1zKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKGFuZ3VsYXIsIGpRdWVyeSwgdG9wLCB3aW5kb3csIE9iamVjdCk7IiwiKGZ1bmN0aW9uIChhbmd1bGFyLCAkKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2ZpbGUubWFuYWdlcicpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1RyZWVDb250cm9sbGVyJywgVHJlZUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIFRyZWVDb250cm9sbGVyLiRpbmplY3QgPSBbXHJcbiAgICAgICAgJyRsb2cnLCAnJHNjb3BlJywgJ0RpcicsICdEaXJTZXJ2aWNlJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBUcmVlQ29udHJvbGxlcigkbG9nLCAkc2NvcGUsIERpciwgRGlyU2VydmljZSkge1xyXG4gICAgICAgICRsb2cubG9nKCdUcmVlQ29udHJvbGxlciBjb250cm9sbGVyIDwtIHN0YXJ0ZWQnKTtcclxuXHJcbiAgICAgICAgYWN0aXZhdGUoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5pc09wZW4gPSBpc09wZW47XHJcbiAgICAgICAgICAgICRzY29wZS5pc0VtcHR5ID0gaXNFbXB0eTtcclxuICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUZvbGRlciA9IGNoYW5nZUZvbGRlcjtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS50cmVlID0ge1xyXG4gICAgICAgICAgICAgICAgbG9hZGluZzogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBbXSxcclxuICAgICAgICAgICAgICAgIHJvb3Q6IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnLycsIC8vIFRPRE86IGdldCB0cmFuc2xhdGlvbiBmb3IgdGhpcyB0ZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAkc2NvcGUuYmFzZVVybCArICdkaXInXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZXhwYW5kOiBleHBhbmRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRPRE86IGFkZCB0cmVlIHJlZnJlc2hcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignX2Vycm9yJywgb25FcnJvckhhbmRsZWQpO1xyXG4gICAgICAgICRzY29wZS4kb24oJ193YXJuaW5nJywgb25FcnJvckhhbmRsZWQpO1xyXG4gICAgICAgIGZ1bmN0aW9uIG9uRXJyb3JIYW5kbGVkKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRzY29wZS50cmVlLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ3RyZWUtY2hhbmdlZCcsIHRyZWVDaGFuZ2VkKTtcclxuICAgICAgICBmdW5jdGlvbiB0cmVlQ2hhbmdlZChldmVudCwgdHJlZSkge1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnVHJlZUNvbnRyb2xsZXIgLT4gdHJlZUNoYW5nZWQnLCB7ZXZlbnQ6IGV2ZW50LCB0cmVlOiB0cmVlfSk7XHJcbiAgICAgICAgICAgICRzY29wZS50cmVlLml0ZW1zID0gdHJlZTtcclxuICAgICAgICAgICAgJHNjb3BlLnRyZWUubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignZm9sZGVyLWNyZWF0ZWQnLCBvbkZvbGRlckNyZWF0ZWQpO1xyXG4gICAgICAgIGZ1bmN0aW9uIG9uRm9sZGVyQ3JlYXRlZChldmVudCwgZm9sZGVyKSB7XHJcbiAgICAgICAgICAgICRsb2cubG9nKCdUcmVlQ29udHJvbGxlciAtPiBvbkZvbGRlckNyZWF0ZWQnLCB7ZXZlbnQ6IGV2ZW50LCBmb2xkZXI6IGZvbGRlcn0pO1xyXG4gICAgICAgICAgICBpZiAoZm9sZGVyLnBhdGguaW5kZXhPZignLycpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlZCBmb2xkZXIgaXMgaW4gcm9vdCwgc28gd2VlIG5lZWQgYWRkIGl0IHRvIHRyZWUgbWVudVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRyZWUuaXRlbXMudW5zaGlmdChmb2xkZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdmb2xkZXItcmVuYW1lZCcsIG9uRm9sZGVyUmVuYW1lZCk7XHJcbiAgICAgICAgZnVuY3Rpb24gb25Gb2xkZXJSZW5hbWVkKGV2ZW50LCBmb2xkZXJzKSB7XHJcbiAgICAgICAgICAgIHZhciBvbGRGb2xkZXIgPSBmb2xkZXJzLm9sZCxcclxuICAgICAgICAgICAgICAgIG5ld0ZvbGRlciA9IGZvbGRlcnMubmV3O1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnVHJlZUNvbnRyb2xsZXIgLT4gb25Gb2xkZXJSZW5hbWVkJywge2V2ZW50OiBldmVudCwgbmV3Rm9sZGVyOiBuZXdGb2xkZXIsIG9sZEZvbGRlcjogb2xkRm9sZGVyfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBUT0RPOiByZWN1cnNpdmVseSBjaGVjayBhbGwgY2hpbGQgZm9sZGVyc1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS50cmVlLml0ZW1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnRyZWUuaXRlbXNbaV0ucGF0aCA9PSBvbGRGb2xkZXIucGF0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IGNyZWF0ZSBpdGVtIGF1dG9tYXBwZXJcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudHJlZS5pdGVtc1tpXS5wYXRoID0gbmV3Rm9sZGVyLnBhdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRyZWUuaXRlbXNbaV0ubmFtZSA9IG5ld0ZvbGRlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50cmVlLml0ZW1zW2ldLnVybCA9IG5ld0ZvbGRlci51cmw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ2ZvbGRlci1kZWxldGVkJywgcmVtb3ZlQnlQYXRoKTtcclxuICAgICAgICBmdW5jdGlvbiByZW1vdmVCeVBhdGgoZXZlbnQsIGl0ZW0pIHtcclxuICAgICAgICAgICAgJGxvZy5sb2coJ1RyZWVDb250cm9sbGVyIC0+IHJlbW92ZUJ5UGF0aCcsIHtldmVudDogZXZlbnQsIGl0ZW06IGl0ZW0sIGl0ZW1zOiAkc2NvcGUudHJlZS5pdGVtc30pO1xyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogcmVjdXJzaXZlbHkgY2hlY2sgYWxsIGNoaWxkIGZvbGRlcnNcclxuICAgICAgICAgICAgJHNjb3BlLnRyZWUuaXRlbXMucmVtb3ZlSXRlbShpdGVtLnBhdGgsICdwYXRoJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDaGVjayBpcyBmb2xkZXIgb3BlbiBmb3IgdHJlZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGZvbGRlclxyXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGlzT3Blbihmb2xkZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZvbGRlciAmJiBhbmd1bGFyLmlzRGVmaW5lZChmb2xkZXIuZm9sZGVycyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDaGVjayBpcyBmb2xkZXIgaGFzIGFueSBvdGhlciBmb2xkZXJcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBmb2xkZXJcclxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBpc0VtcHR5KGZvbGRlcikge1xyXG4gICAgICAgICAgICBpZiAoaXNPcGVuKGZvbGRlcikpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9sZGVyLmZvbGRlcnMubGVuZ3RoID09IDA7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV4cGFuZChjdXJyRm9sZGVyKSB7XHJcbiAgICAgICAgICAgIC8vIGRvIG5vdGhpbmcgaWYgdHJlZSBzdGlsbCBsb2FkaW5nIG9yIGRvbmB0IGhhdmUgc3ViIGZvbGRlcnNcclxuICAgICAgICAgICAgaWYgKCRzY29wZS50cmVlLmxvYWRpbmcgfHwgaXNFbXB0eShjdXJyRm9sZGVyKSkge1xyXG4gICAgICAgICAgICAgICAgJGxvZy53YXJuKCdUcmVlQ29udHJvbGxlciAtPiBleHBhbmQnLCAnUHJldmlvdXMgaXRlbSBzdGlsbCBsb2FkaW5nJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRsb2cubG9nKCdUcmVlQ29udHJvbGxlciAtPiBleHBhbmQnLCB7Y3VycjogY3VyckZvbGRlcn0pO1xyXG5cclxuICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCBzdWIgZm9sZGVycyBpZiBpdCBpcyBhbHJlYWR5IG9wZW5lZFxyXG4gICAgICAgICAgICBpZiAoaXNPcGVuKGN1cnJGb2xkZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyRm9sZGVyLmZvbGRlcnMgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRzY29wZS50cmVlLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICBEaXIucXVlcnkoe3BhdGg6IGN1cnJGb2xkZXIucGF0aH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgRGlyU2VydmljZS5leHRlbmQocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRyZWUubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgY3VyckZvbGRlci5mb2xkZXJzID0gcmVzcG9uc2UuZGlycygpO1xyXG4gICAgICAgICAgICB9LCAkc2NvcGUuX2Vycm9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNoYW5nZUZvbGRlcihmb2xkZXIpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZpcmVCcm9hZGNhc3QoJ2NoYW5nZS1mb2xkZXInLCBmb2xkZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoYW5ndWxhciwgalF1ZXJ5KTsiLCIoZnVuY3Rpb24gKGFuZ3VsYXIsICQpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnZmlsZS5tYW5hZ2VyJylcclxuICAgICAgICAuY29udHJvbGxlcignVXBsb2FkQ29udHJvbGxlcicsIFVwbG9hZENvbnRyb2xsZXIpO1xyXG5cclxuICAgIFVwbG9hZENvbnRyb2xsZXIuJGluamVjdCA9IFtcclxuICAgICAgICAnJGxvZycsICckc2NvcGUnLCAnRmlsZVVwbG9hZGVyJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBVcGxvYWRDb250cm9sbGVyKCRsb2csICRzY29wZSwgRmlsZVVwbG9hZGVyKSB7XHJcbiAgICAgICAgJGxvZy5sb2coJ1VwbG9hZENvbnRyb2xsZXIgY29udHJvbGxlciA8LSBzdGFydGVkJyk7XHJcblxyXG4gICAgICAgIGFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUudXBsb2FkZXIgPSBuZXcgRmlsZVVwbG9hZGVyKHtcclxuICAgICAgICAgICAgICAgIHVybDogX2dldFVwbG9hZFBhdGhcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBfZ2V0VXBsb2FkUGF0aCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5iYXNlVXJsKCkgKyAnZmlsZS91cGxvYWQnICsgJHNjb3BlLm1hbmFnZXIucGF0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS51cGxvYWRlci5vbldoZW5BZGRpbmdGaWxlRmFpbGVkID0gZnVuY3Rpb24gKGl0ZW0gLyp7RmlsZXxGaWxlTGlrZU9iamVjdH0qLywgZmlsdGVyLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICRsb2cuaW5mbygnb25XaGVuQWRkaW5nRmlsZUZhaWxlZCcsIGl0ZW0sIGZpbHRlciwgb3B0aW9ucyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnVwbG9hZGVyLm9uQWZ0ZXJBZGRpbmdGaWxlID0gZnVuY3Rpb24gKGZpbGVJdGVtKSB7XHJcbiAgICAgICAgICAgIC8vIGZpeCB1cmwgdG8gdXBsb2FkIGFzIHdlIGNhbiBjaGFuZ2UgaXQgYXQgYW55IG1vbWVudFxyXG4gICAgICAgICAgICBmaWxlSXRlbS51cGxvYWRlci51cmwgPSBmaWxlSXRlbS51cmwgPSBfZ2V0VXBsb2FkUGF0aCgpO1xyXG4gICAgICAgICAgICAkbG9nLmluZm8oJ29uQWZ0ZXJBZGRpbmdGaWxlJywgZmlsZUl0ZW0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS51cGxvYWRlci5vbkVycm9ySXRlbSA9IGZ1bmN0aW9uIChmaWxlSXRlbSwgcmVzcG9uc2UsIHN0YXR1cywgaGVhZGVycykge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBhZGQgZXJyb3IgaGFuZGxpbmdcclxuICAgICAgICAgICAgJGxvZy5pbmZvKCdvbkVycm9ySXRlbScsIGZpbGVJdGVtLCAvKnJlc3BvbnNlLCovIHN0YXR1cywgaGVhZGVycyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnVwbG9hZGVyLm9uQ29tcGxldGVJdGVtID0gZnVuY3Rpb24gKGZpbGVJdGVtLCByZXNwb25zZSwgc3RhdHVzLCBoZWFkZXJzKSB7XHJcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgJGxvZy5pbmZvKCdVcGxvYWRDb250cm9sbGVyIC0+IHVwbG9hZGVyIC0+IG9uQ29tcGxldGVJdGVtJyxcclxuICAgICAgICAgICAgICAgICAgICB7ZmlsZUl0ZW06IGZpbGVJdGVtLCByZXNwb25zZTogcmVzcG9uc2UsIHN0YXR1czogc3RhdHVzLCBoZWFkZXJzOiBoZWFkZXJzfSk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlyZUJyb2FkY2FzdCgnZmlsZS11cGxvYWRlZCcsIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5fc3VjY2VzcyhyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUudXBsb2FkZXIub25Db21wbGV0ZUFsbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGxvZy5pbmZvKCdVcGxvYWRDb250cm9sbGVyIC0+IHVwbG9hZGVyIC0+IG9uQ29tcGxldGVBbGwnLCB7dXBsb2FkZXI6ICRzY29wZS51cGxvYWRlcn0pO1xyXG5cclxuICAgICAgICAgICAgdmFyIGhhc05vdFVwbG9hZGVkRmlsZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS51cGxvYWRlci5xdWV1ZSwgZnVuY3Rpb24gKGZpbGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghZmlsZS5pc1JlYWR5ICYmICFmaWxlLmlzVXBsb2FkaW5nICYmICFmaWxlLmlzU3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc05vdFVwbG9hZGVkRmlsZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghaGFzTm90VXBsb2FkZWRGaWxlcykge1xyXG4gICAgICAgICAgICAgICAgLy8gQ2xlYXIgbGlzIGZyb20gaXRlbXMgYW5kIGhpZGUgaXRcclxuICAgICAgICAgICAgICAgICRzY29wZS51cGxvYWRlci5jbGVhclF1ZXVlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59KShhbmd1bGFyLCBqUXVlcnkpOyIsIihmdW5jdGlvbiAoYW5ndWxhciwgY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuZmlsZU1cclxuICAgICAgICAuc2VydmljZSgnRGlyU2VydmljZScsIERpclNlcnZpY2UpO1xyXG5cclxuICAgIERpclNlcnZpY2UuJGluamVjdCA9IFtcclxuICAgICAgICAnJGxvZycsICckcm9vdFNjb3BlJywgJyRodHRwJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBEaXJTZXJ2aWNlKCRsb2csICRyb290U2NvcGUsICRodHRwKSB7XHJcbiAgICAgICAgLy8kbG9nLmxvZygnRGlyU2VydmljZSBzZXJ2aWNlIDwtIHN0YXJ0ZWQnKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgJ2V4dGVuZCc6IGV4dGVuZCxcclxuICAgICAgICAgICAgJ2V4dGVuZEl0ZW0nOiBleHRlbmRJdGVtLFxyXG4gICAgICAgICAgICAncmVuYW1lJzogcmVuYW1lLFxyXG4gICAgICAgICAgICAnY3JlYXRlJzogY3JlYXRlLFxyXG4gICAgICAgICAgICAnZGVsZXRlJzogZGVsZXRlRGlyLFxyXG4gICAgICAgICAgICAnaWRHZW4nOiBpZEdlblxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV4dGVuZChkYXRhKSB7XHJcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChkYXRhLkRpclNlcnZpY2VFeHRlbmRlZCkgJiYgZGF0YS5EaXJTZXJ2aWNlRXh0ZW5kZWQpXHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcblxyXG4gICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChkYXRhLCB7XHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIFVzZWQgZm9yIGZpbGUgdHJlZSB3aGVyZSBmb2xkZXIgdXAgaXMgbm90IHJlcXVpcmVkXHJcbiAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICogQHJldHVybnMge0FycmF5fVxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBkaXJzOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGZvbGRlcnMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHZhbHVlLm1pbWUgPT09ICdkaXInICYmIHZhbHVlLmZ1bGxfbmFtZSAhPSAnLi4nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRlbmRJdGVtKHZhbHVlLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wdXNoKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0sIGZvbGRlcnMpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9sZGVycztcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICAvKipcclxuICAgICAgICAgICAgICAgICAqIEFwcGVuZCBlYWNoIGl0ZW0gd2l0aCByZXF1aXJlZCBkYXRhXHJcbiAgICAgICAgICAgICAgICAgKlxyXG4gICAgICAgICAgICAgICAgICogQHJldHVybnMge0FycmF5fVxyXG4gICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgICAgICBpdGVtczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBpdGVtcyA9IFtdO1xyXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLCBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBleHRlbmRJdGVtKHZhbHVlLCBrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnB1c2godmFsdWUpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0sIGl0ZW1zKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW1zO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGRhdGEuRGlyU2VydmljZUV4dGVuZGVkID0gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFJlbmFtZXMgcGF0aCBsYXN0IHBhcnQgbnRvIG5ldyBuYW1lXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gZGlyIFwicGF0aCB0byByZW5hbWVcIlxyXG4gICAgICAgICAqIEBwYXJhbSBvbGROYW1lXHJcbiAgICAgICAgICogQHBhcmFtIG5ld05hbWUgXCJuZXcgbmFtZSBmb3IgcGF0aCBsYXN0IGVsZW1lbnRcIlxyXG4gICAgICAgICAqIEBwYXJhbSBvblN1Y2Nlc3MgXCJjYWxsYmFjayBmb3Igc3VjY2Vzc2Z1bCByZW5hbWVcIlxyXG4gICAgICAgICAqIEBwYXJhbSBvbkVycm9yIFwiY2FsbGJhY2sgZm9yIGVycm9yXCJcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiByZW5hbWUoZGlyLCBvbGROYW1lLCBuZXdOYW1lLCBvblN1Y2Nlc3MsIG9uRXJyb3IpIHtcclxuICAgICAgICAgICAgdmFyIHVybCA9ICRyb290U2NvcGUuYmFzZVVybCgpICsgJ2Rpci9yZW5hbWUvJyArIGRpcjtcclxuICAgICAgICAgICAgJGh0dHAucG9zdCh1cmwsIHtcclxuICAgICAgICAgICAgICAgICdvbGQnOiBvbGROYW1lLFxyXG4gICAgICAgICAgICAgICAgJ25ldyc6IG5ld05hbWVcclxuICAgICAgICAgICAgfSkudGhlbihvblN1Y2Nlc3MsIG9uRXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ3JlYXRlIG5ldyBkaXJlY3RvcnlcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBkaXJcclxuICAgICAgICAgKiBAcGFyYW0gbmFtZVxyXG4gICAgICAgICAqIEBwYXJhbSBvblN1Y2Nlc3NcclxuICAgICAgICAgKiBAcGFyYW0gb25FcnJvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZShkaXIsIG5hbWUsIG9uU3VjY2Vzcywgb25FcnJvcikge1xyXG4gICAgICAgICAgICB2YXIgdXJsID0gJHJvb3RTY29wZS5iYXNlVXJsKCkgKyAnZGlyL2NyZWF0ZS8nICsgZGlyO1xyXG4gICAgICAgICAgICAkaHR0cC5wb3N0KHVybCwge1xyXG4gICAgICAgICAgICAgICAgJ25hbWUnOiBuYW1lXHJcbiAgICAgICAgICAgIH0pLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIERlbGV0ZSBleGlzdGluZyBkaXJlY3RvcnlcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBkaXJcclxuICAgICAgICAgKiBAcGFyYW0gbmFtZVxyXG4gICAgICAgICAqIEBwYXJhbSBvblN1Y2Nlc3NcclxuICAgICAgICAgKiBAcGFyYW0gb25FcnJvclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGRlbGV0ZURpcihkaXIsIG5hbWUsIG9uU3VjY2Vzcywgb25FcnJvcikge1xyXG4gICAgICAgICAgICB2YXIgdXJsID0gJHJvb3RTY29wZS5iYXNlVXJsKCkgKyAnZGlyL2RlbGV0ZS8nICsgZGlyO1xyXG4gICAgICAgICAgICAkaHR0cC5wb3N0KHVybCwge1xyXG4gICAgICAgICAgICAgICAgJ25hbWUnOiBuYW1lXHJcbiAgICAgICAgICAgIH0pLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEdlbmVyYXRlIHVuaXF1ZSBpdGVtIGlkIHByb3BlcnR5XHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ga2V5IGFycmF5IGtleVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9IGl0ZW0gaWRcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBpZEdlbihrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICdsaXN0LWl0ZW0tJyArIGtleTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEFkZCBpZCBwYXJhbWV0ZXIgdG8gaXRlbVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGl0ZW1cclxuICAgICAgICAgKiBAcGFyYW0ga2V5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZXh0ZW5kSXRlbShpdGVtLCBrZXkpIHtcclxuICAgICAgICAgICAgaXRlbS5pZCA9IGlkR2VuKGtleSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KShhbmd1bGFyLCB3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSkpOyIsIihmdW5jdGlvbiAoYW5ndWxhciwgY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuZmlsZU1cclxuICAgICAgICAuc2VydmljZSgnRmlsZVNlcnZpY2UnLCBGaWxlU2VydmljZSk7XHJcblxyXG4gICAgRmlsZVNlcnZpY2UuJGluamVjdCA9IFtcclxuICAgICAgICAnJGxvZycsICckcm9vdFNjb3BlJywgJyRodHRwJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBGaWxlU2VydmljZSgkbG9nLCAkcm9vdFNjb3BlLCAkaHR0cCkge1xyXG4gICAgICAgIC8vJGxvZy5sb2coJ0ZpbGVTZXJ2aWNlIHNlcnZpY2UgPC0gc3RhcnRlZCcpO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZW5hbWU6IHJlbmFtZSxcclxuICAgICAgICAgICAgJ2RlbGV0ZSc6IGRlbGV0ZUZpbGVcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZW5hbWUgZmlsZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGRpclxyXG4gICAgICAgICAqIEBwYXJhbSBvbGROYW1lXHJcbiAgICAgICAgICogQHBhcmFtIG5ld05hbWVcclxuICAgICAgICAgKiBAcGFyYW0gb25TdWNjZXNzXHJcbiAgICAgICAgICogQHBhcmFtIG9uRXJyb3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiByZW5hbWUoZGlyLCBvbGROYW1lLCBuZXdOYW1lLCBvblN1Y2Nlc3MsIG9uRXJyb3IpIHtcclxuICAgICAgICAgICAgJGxvZy5sb2coJ0ZpbGVTZXJ2aWNlIC0+IHJlbmFtZScsIHtkaXI6IGRpciwgb2xkTmFtZTogb2xkTmFtZSwgbmV3TmFtZTogbmV3TmFtZX0pO1xyXG5cclxuICAgICAgICAgICAgdmFyIHVybCA9ICRyb290U2NvcGUuYmFzZVVybCgpICsgJ2ZpbGUvcmVuYW1lLycgKyBkaXI7XHJcbiAgICAgICAgICAgICRodHRwLnBvc3QodXJsLCB7XHJcbiAgICAgICAgICAgICAgICAnb2xkJzogb2xkTmFtZSxcclxuICAgICAgICAgICAgICAgICduZXcnOiBuZXdOYW1lXHJcbiAgICAgICAgICAgIH0pLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIERlbGV0ZSBmaWxlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gZGlyXHJcbiAgICAgICAgICogQHBhcmFtIG5hbWVcclxuICAgICAgICAgKiBAcGFyYW0gb25TdWNjZXNzXHJcbiAgICAgICAgICogQHBhcmFtIG9uRXJyb3JcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBkZWxldGVGaWxlKGRpciwgbmFtZSwgb25TdWNjZXNzLCBvbkVycm9yKSB7XHJcbiAgICAgICAgICAgICRsb2cubG9nKCdGaWxlU2VydmljZSAtPiBkZWxldGUnLCB7ZGlyOiBkaXIsIG5hbWU6IG5hbWV9KTtcclxuXHJcbiAgICAgICAgICAgIHZhciB1cmwgPSAkcm9vdFNjb3BlLmJhc2VVcmwoKSArICdmaWxlL2RlbGV0ZS8nICsgZGlyO1xyXG4gICAgICAgICAgICAkaHR0cC5wb3N0KHVybCwge1xyXG4gICAgICAgICAgICAgICAgJ25hbWUnOiBuYW1lXHJcbiAgICAgICAgICAgIH0pLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKGFuZ3VsYXIsIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7IiwiKGZ1bmN0aW9uIChuZywgJCwgY3JpcCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGNyaXAuZmlsZU1cbiAgICAgICAgLnNlcnZpY2UoJ1NldHRpbmdzJywgU2V0dGluZ3MpO1xuXG4gICAgZnVuY3Rpb24gU2V0dGluZ3MoKSB7XG4gICAgICAgIHZhciAkc2V0dGluZ3MgPSAkKCcjc2V0dGluZ3MnKSwgcGFyYW1zID0gZmFsc2U7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlzVGFyZ2V0OiBpc1RhcmdldCxcbiAgICAgICAgICAgIGdldFR5cGU6IGdldFR5cGUsXG4gICAgICAgICAgICBnZXRUaHVtYlNpemU6IGdldFRodW1iU2l6ZSxcbiAgICAgICAgICAgIGdldFBhcmFtczogZ2V0UGFyYW1zXG4gICAgICAgIH07XG5cbiAgICAgICAgZnVuY3Rpb24gaXNUYXJnZXQoY3Vycl90YXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRQYXJhbXMoKS50YXJnZXQudG9Mb3dlckNhc2UoKSA9PT0gY3Vycl90YXJnZXQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFR5cGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gKGdldFBhcmFtcygpLnR5cGUgPyBwYXJhbXMudHlwZS50b0xvd2VyQ2FzZSgpIDogZmFsc2UpIHx8ICdmaWxlJztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFRodW1iU2l6ZShzaXplS2V5KSB7XG4gICAgICAgICAgICB2YXIgc2l6ZXMgPSBuZy5mcm9tSnNvbigkc2V0dGluZ3MuZGF0YSgnc2l6ZXMnKS5yZXBsYWNlKC9cXCcvZywgJ1wiJykpO1xuXG4gICAgICAgICAgICByZXR1cm4gc2l6ZXNbc2l6ZUtleV07XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRQYXJhbXMoKSB7XG4gICAgICAgICAgICBpZiAoIXBhcmFtcykge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhUGFyYW1zID0gJHNldHRpbmdzLmRhdGEoJ3BhcmFtcycpO1xuICAgICAgICAgICAgICAgIC8vIGlmIHBhcmFtcyBpcyBlbXB0eSBhcnJheSwgaXQgYWxyZWFkeSBjb252ZXJ0ZWQgdG8gZW1wdHkgYXJyYXlcbiAgICAgICAgICAgICAgICBpZiAoZGF0YVBhcmFtcy5sZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7fTtcblxuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHN0ckZyb21Kc29uKGRhdGFQYXJhbXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpeFNlcmlhbGl6YWJsZVN0cihzdHIpIHtcbiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cXCcvZywgJ1wiJyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RyRnJvbUpzb24oc3RyKSB7XG4gICAgICAgIHJldHVybiBuZy5mcm9tSnNvbihmaXhTZXJpYWxpemFibGVTdHIoc3RyKSk7XG4gICAgfVxufSkoYW5ndWxhciwgalF1ZXJ5LCB3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSkpOyIsIihmdW5jdGlvbiAoY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuZmlsZU1cclxuICAgICAgICAuc2VydmljZSgnRGlyJywgRGlyKTtcclxuXHJcbiAgICBEaXIuJGluamVjdCA9IFtcclxuICAgICAgICAnJGxvZycsICckcmVzb3VyY2UnLCAnJHJvb3RTY29wZSdcclxuICAgIF07XHJcblxyXG4gICAgZnVuY3Rpb24gRGlyKCRsb2csICRyZXNvdXJjZSwgJHJvb3RTY29wZSkge1xyXG4gICAgICAgIC8vJGxvZy5sb2coJ0RpciByZXNvdXJjZSA8LSBzdGFydGVkJyk7XHJcblxyXG4gICAgICAgIHJldHVybiAkcmVzb3VyY2UoJHJvb3RTY29wZS5iYXNlVXJsKCkgKyAnZGlyLzpkaXIvOm5hbWUnLCB7XHJcbiAgICAgICAgICAgIGRpcjogJ0BkaXInLFxyXG4gICAgICAgICAgICBuYW1lOiAnQG5hbWUnXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0pKHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
