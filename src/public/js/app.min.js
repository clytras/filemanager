!function(e){"use strict";e.module("file.manager",["crip.core","angular-loading-bar","angularFileUpload","ngCookies","ngResource","ngSanitize","ui.bootstrap","ui-notification","io.dennis.contextmenu"])}(angular),function(){"use strict";angular.module("app",["file.manager"])}(),function(e,r){"use strict";function n(e){var n=r("#settings");e.fireBroadcast=function(r,n){e.$broadcast(r,n)},e.baseUrl=function(){return n.data("base-url")}}e.module("file.manager").run(n),n.$inject=["$rootScope"]}(angular,jQuery),function(e,r){"use strict";function n(r,n,t,o,i,a){function l(){n.isDir=d,n.isDirUp=s,n._error=u,n._warning=f,n._success=m,n.manager={path:"/"},a.query(g)}function d(r){return r&&e.isDefined(r.type)&&"dir"===r.type}function s(e){return d(e)&&".."==e.name}function c(n){var t=!1;return e.isDefined(n.notification)&&(t=n.notification),e.isDefined(n.data)&&e.isDefined(n.data.notification)&&(t=n.data.notification),t?{hasMessage:!0,message:t}:(r.error("Cant get user friendly message from response",{response:n}),{hasMessage:!1})}function u(e){n.fireBroadcast("_error");var r=c(e);r.hasMessage&&o.error({message:r.message})}function f(e){n.fireBroadcast("_warning");var r=c(e);r.hasMessage&&o.error({message:r.message})}function m(e){var r=c(e);r.hasMessage&&o.success({message:r.message})}function g(e){r.log("BaseController -> onInitialDirLoaded",{response:e}),i.extend(e),n.fireBroadcast("tree-changed",e.dirs()),n.fireBroadcast("folder-changed",e.items()),r.log("FolderCache",{path:t.get("path")}),"/"!==t.get("path")&&"undefined"!=typeof t.get("path")&&n.fireBroadcast("change-folder",{path:t.get("path")})}r.log("BaseController controller <- started"),l()}e.module("file.manager").controller("BaseController",n),n.$inject=["$log","$scope","$cookies","Notification","DirService","Dir"]}(angular,jQuery),function(e,r){"use strict";function n(r,n,t,o,i,a,l){function d(){n.folder={loading:!0,creating:!1,name:"",items:[],filters:{image:!0,media:!0,document:!0,file:!0},order:{func:h,change:v,by:"name",reverse:!1,name:!0,size:!1,date:!1},enableCreate:$,create:w,refresh:C,isFiltersEnabled:y},n.folderFilter=p}function s(){return n.folder.loading?(r.warn("FolderController -> loading","Previous item still loading"),!1):!0}function c(e){n.folder.loading=!1}function u(e,t){s()&&(r.log("FolderController -> changeFolder",{event:e,folder:t}),n.folder.loading=!0,i.query({path:t.path||"/"},function(e){n._success(e),F(e,t)},n._error))}function f(e,t){r.log("FolderController -> onFolderExternallyChanged",{event:e,items:t}),n.folder.loading=!1,n.folder.items=t}function m(e,t){r.log("FolderController -> addNewFile",{event:e,file:t}),a.extendItem(t,n.folder.items.length),n.folder.items.unshift(t)}function g(e,t){r.log("FolderController -> removeByPath",{event:e,item:t,items:n.folder.items}),n.folder.items.removeItem(t.path,"path")}function p(r,t,o){if(e.isDefined(r.type)){if("dir"==r.type)return!0;if(y())return n.folder.filters[r.type];if(l.getType()==r.type)return!0}return!1}function h(e){return"dir"===e.type?".."==e.name?-1:"0 "+e[n.folder.order.by]:"z"+e[n.folder.order.by]}function v(e){n.folder.order.by=e;var r=["name","size","date"];for(var t in r)r.hasOwnProperty(t)&&(n.folder.order[r[t]]=!1);return n.folder.order[e]=!0,!1}function y(){return"file"==l.getType()}function C(){s()&&(r.log("FolderController -> refresh",{manager:n.manager}),n.folder.loading=!0,n.manager.path=n.manager.path.replace(/^\/|\/$/g,""),i.query({path:n.manager.path||"/"},function(e){F(e,n.manager)},n._error))}function F(e,o){r.log("FolderController -> changeFolder -> onFolderChanged",{response:e,folder:o}),a.extend(e),n.folder.items=e.items(),n.folder.loading=!1,n.manager.path="/"+(o.path||""),t.put("path",o.path||"")}function $(){n.folder.creating=!0,o("#create-dir-input")}function w(){s()&&n.folder.name&&""!==n.folder.name&&a.create(n.manager.path,n.folder.name,b,n._error)}function b(e){r.log("FolderController -> create -> onFolderCreated",{response:e}),n._success(e),n.folder.creating=!1,n.folder.name="";var t=e.data;a.extendItem(t,n.folder.items.length),n.folder.items.unshift(t),n.fireBroadcast("folder-created",t)}r.log("FolderController controller <- started"),d(),n.$on("_error",c),n.$on("_warning",c),n.$on("change-folder",u),n.$on("folder-changed",f),n.$on("file-uploaded",m),n.$on("folder-deleted",g),n.$on("file-deleted",g)}e.module("file.manager").controller("FolderController",n),n.$inject=["$log","$scope","$cookies","focus","Dir","DirService","Settings"]}(angular,jQuery),function(e,r,n,t,o){"use strict";function i(r,i,a,l,d,s){function c(){i.click=u,i.canRename=f,i.enableRename=m,i.disableRename=h,i.rename=g,i.select=C,i.hasThumbs=b,i.thumbName=D,i["delete"]=F}function u(e){return i.folder.loading?void r.warn("FolderItemController -> click","Previous item still loading"):(r.log("FolderItemController -> click",{item:e}),i.isDir(e)?void i.fireBroadcast("change-folder",e):void C(e))}function f(e){return!i.isDirUp(e)}function m(e){if(e.rename=!0,i.isDir(e))e.newName=e.name;else{e.ext=e.name.split(".").pop();var r=0;e.ext.length&&(r=e.ext.length+1),e.newName=e.name.substring(0,e.name.length-r)}a("#"+e.id+" input")}function g(){return i.isDir(i.item)?void(".."!=i.item.name&&l.rename(i.manager.path,i.item.name,i.item.newName,v,i._error)):void d.rename(i.manager.path,i.item.name,p(i.item),y,i._error)}function p(r){return e.isDefined(r.ext)&&r.ext.length?r.newName+"."+r.ext:r.newName}function h(e){e.rename=!1}function v(n){r.log("FolderItemController -> onFolderRenamed",{response:n,item:i.item}),i._success(n);var t=e.copy(i.item);i.item.rename=!1,i.item.path=n.data.path,i.item.name=n.data.name,i.item.url=n.data.url,i.fireBroadcast("folder-renamed",{"new":n.data,old:t})}function y(e){r.log("FolderItemController -> onFileRenamed",{response:e}),i._success(e),i.item.rename=!1,i.item.name=e.data.name,i.item.url=e.data.url,i.item.thumbs=e.data.thumbs}function C(e,o){var i=e.url;if(o&&(i=e.thumbs[o]),s.isTarget("tinyMCE"))if(r.info("FolderItemController -> select -> tinymce",{tinymce:n.tinymce}),n.tinymce.majorVersion<4){n.tinymce.activeEditor.windowManager.params.setUrl(i);var a=n.tinymce.activeEditor.windowManager.params.mce_window_id;n.tinymce.activeEditor.windowManager.close(a)}else r.info("FolderItemController -> select -> tinymce4",{params:n.tinymce.activeEditor.windowManager.getParams()}),n.tinymce.activeEditor.windowManager.getParams().setUrl(i),n.tinymce.activeEditor.windowManager.close();if(s.isTarget("callback")){var l=t.filemanager||t.parent.filemanager||{};l&&l.onSelected&&l.onSelected(i,s.getParams())}}function F(e){return i.isDir(e)?void(".."!=e.name&&l["delete"](i.manager.path,e.name,$,i._error)):void d["delete"](i.manager.path,e.name,w,i._error)}function $(e){r.log("FolderItemController -> onFolderDeleted",{response:e}),i._success(e),i.fireBroadcast("folder-deleted",e.data)}function w(e){r.log("FolderItemController -> onFileDeleted",{response:e}),i._success(e),i.fireBroadcast("file-deleted",e.data)}function b(r){return!!r&&e.isDefined(r.thumbs)&&o.keys(r.thumbs).length>1}function D(e,r,n){if(e){var t=s.getThumbSize(e);r=t[0],n=t[1]}var o="({width} x {height})",i={width:r,height:n};return o.supplant(i)}r.log("FolderItemController controller <- started"),c()}e.module("file.manager").controller("FolderItemController",i),i.$inject=["$log","$scope","focus","DirService","FileService","Settings"]}(angular,jQuery,top,window,Object),function(e,r){"use strict";function n(r,n,t,o){function i(){n.isOpen=u,n.isEmpty=f,n.changeFolder=g,n.tree={loading:!0,items:[],root:{name:"/",url:n.baseUrl+"dir"},expand:m}}function a(e){n.tree.loading=!1}function l(e,t){r.log("TreeController -> treeChanged",{event:e,tree:t}),n.tree.items=t,n.tree.loading=!1}function d(e,t){r.log("TreeController -> onFolderCreated",{event:e,folder:t}),-1===t.path.indexOf("/")&&n.tree.items.unshift(t)}function s(e,t){var o=t.old,i=t["new"];r.log("TreeController -> onFolderRenamed",{event:e,newFolder:i,oldFolder:o});for(var a=0;a<n.tree.items.length;a++)n.tree.items[a].path==o.path&&(n.tree.items[a].path=i.path,n.tree.items[a].name=i.name,n.tree.items[a].url=i.url)}function c(e,t){r.log("TreeController -> removeByPath",{event:e,item:t,items:n.tree.items}),n.tree.items.removeItem(t.path,"path")}function u(r){return r&&e.isDefined(r.folders)}function f(e){return u(e)?0==e.folders.length:!1}function m(e){return n.tree.loading||f(e)?void r.warn("TreeController -> expand","Previous item still loading"):(r.log("TreeController -> expand",{curr:e}),u(e)?void(e.folders=void 0):(n.tree.loading=!0,void t.query({path:e.path},function(r){o.extend(r),n.tree.loading=!1,e.folders=r.dirs()},n._error)))}function g(e){n.fireBroadcast("change-folder",e)}r.log("TreeController controller <- started"),i(),n.$on("_error",a),n.$on("_warning",a),n.$on("tree-changed",l),n.$on("folder-created",d),n.$on("folder-renamed",s),n.$on("folder-deleted",c)}e.module("file.manager").controller("TreeController",n),n.$inject=["$log","$scope","Dir","DirService"]}(angular,jQuery),function(e,r){"use strict";function n(r,n,t){function o(){n.uploader=new t({url:i})}function i(){return n.baseUrl()+"file/upload"+n.manager.path}r.log("UploadController controller <- started"),o(),n.uploader.onWhenAddingFileFailed=function(e,n,t){r.info("onWhenAddingFileFailed",e,n,t)},n.uploader.onAfterAddingFile=function(e){e.uploader.url=e.url=i(),r.info("onAfterAddingFile",e)},n.uploader.onErrorItem=function(e,n,t,o){r.info("onErrorItem",e,t,o)},n.uploader.onCompleteItem=function(e,t,o,i){200===o&&(r.info("UploadController -> uploader -> onCompleteItem",{fileItem:e,response:t,status:o,headers:i}),n.fireBroadcast("file-uploaded",t),n._success(t))},n.uploader.onCompleteAll=function(){r.info("UploadController -> uploader -> onCompleteAll",{uploader:n.uploader});var t=!1;e.forEach(n.uploader.queue,function(e){e.isReady||e.isUploading||e.isSuccess||(t=!0)}),t||n.uploader.clearQueue()}}e.module("file.manager").controller("UploadController",n),n.$inject=["$log","$scope","FileUploader"]}(angular,jQuery),function(e,r){"use strict";function n(e,r,n){return e.log("Dir resource <- started"),r(n.baseUrl()+"dir/:path",{path:"@path"})}e.module("file.manager").service("Dir",n),n.$inject=["$log","$resource","$rootScope"]}(angular,jQuery),function(e,r){"use strict";function n(r,n,t){function o(r){e.isDefined(r.DirServiceExtended)&&r.DirServiceExtended||(e.extend(r,{dirs:function(){var n=[];return e.forEach(r,function(e,r){"dir"==e.type&&".."!=e.name&&(s(e,r),this.push(e))},n),n},items:function(){var n=[];return e.forEach(r,function(e,r){s(e,r),this.push(e)},n),n}}),r.DirServiceExtended=!0)}function i(e,r,o,i,a){var l=n.baseUrl()+"dir/rename/"+e;t.post(l,{old:r,"new":o}).then(i,a)}function a(e,r,o,i){var a=n.baseUrl()+"dir/create/"+e;t.post(a,{name:r}).then(o,i)}function l(e,r,o,i){var a=n.baseUrl()+"dir/delete/"+e;t.post(a,{name:r}).then(o,i)}function d(e){return"list-item-"+e}function s(e,r){e.id=d(r)}return r.log("DirService service <- started"),{extend:o,extendItem:s,rename:i,create:a,"delete":l,idGen:d}}e.module("file.manager").service("DirService",n),n.$inject=["$log","$rootScope","$http"]}(angular,jQuery),function(e,r){"use strict";function n(e,r,n){function t(t,o,i,a,l){e.log("FileService -> rename",{path:t,oldName:o,newName:i});var d=r.baseUrl()+"file/rename/"+t;n.post(d,{old:o,"new":i}).then(a,l)}function o(t,o,i,a){e.log("FileService -> delete",{path:t,name:o});var l=r.baseUrl()+"file/delete/"+t;n.post(l,{name:o}).then(i,a)}return e.log("FileService service <- started"),{rename:t,"delete":o}}e.module("file.manager").service("FileService",n),n.$inject=["$log","$rootScope","$http"]}(angular,jQuery),function(e,r){"use strict";function n(){function n(e){return a().target.toLowerCase()===e.toLowerCase()}function t(){return(a().type?d.type.toLowerCase():!1)||"file"}function i(r){var n=e.fromJson(l.data("sizes").replace(/\'/g,'"'));return n[r]}function a(){if(!d){var e=l.data("params");if(0===e.length)return{};d=o(e)}return d}var l=r("#settings"),d=!1;return{isTarget:n,getType:t,getThumbSize:i,getParams:a}}function t(e){return e.replace(/\'/g,'"')}function o(r){return e.fromJson(t(r))}e.module("file.manager").service("Settings",n),n.$inject=[]}(angular,jQuery);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zb3VyY2UvZmlsZW1hbmFnZXIvbW9kdWxlLmpzIiwiL3NvdXJjZS9hcHAuanMiLCIvc291cmNlL2ZpbGVtYW5hZ2VyL3J1bi5qcyIsIi9zb3VyY2UvZmlsZW1hbmFnZXIvY29udHJvbGxlcnMvQmFzZUNvbnRyb2xsZXIuanMiLCIvc291cmNlL2ZpbGVtYW5hZ2VyL2NvbnRyb2xsZXJzL0ZvbGRlckNvbnRyb2xsZXIuanMiLCIvc291cmNlL2ZpbGVtYW5hZ2VyL2NvbnRyb2xsZXJzL0ZvbGRlckl0ZW1Db250cm9sbGVyLmpzIiwiL3NvdXJjZS9maWxlbWFuYWdlci9jb250cm9sbGVycy9UcmVlQ29udHJvbGxlci5qcyIsIi9zb3VyY2UvZmlsZW1hbmFnZXIvY29udHJvbGxlcnMvVXBsb2FkQ29udHJvbGxlci5qcyIsIi9zb3VyY2UvZmlsZW1hbmFnZXIvcmVzb3VyY2VzL0Rpci5qcyIsIi9zb3VyY2UvZmlsZW1hbmFnZXIvc2VydmljZXMvRGlyU2VydmljZS5qcyIsIi9zb3VyY2UvZmlsZW1hbmFnZXIvc2VydmljZXMvRmlsZVNlcnZpY2UuanMiLCIvc291cmNlL2ZpbGVtYW5hZ2VyL3NlcnZpY2VzL1NldHRpbmdzLmpzIl0sIm5hbWVzIjpbIm5nIiwibW9kdWxlIiwiYW5ndWxhciIsIiQiLCJSdW4iLCIkcm9vdFNjb3BlIiwiJHNldHRpbmdzIiwiZmlyZUJyb2FkY2FzdCIsImV2ZW50TmFtZSIsImFyZ3MiLCIkYnJvYWRjYXN0IiwiYmFzZVVybCIsImRhdGEiLCJydW4iLCIkaW5qZWN0IiwialF1ZXJ5IiwiQmFzZUNvbnRyb2xsZXIiLCIkbG9nIiwiJHNjb3BlIiwiJGNvb2tpZXMiLCJOb3RpZmljYXRpb24iLCJEaXJTZXJ2aWNlIiwiRGlyIiwiYWN0aXZhdGUiLCJpc0RpciIsImlzRGlyVXAiLCJfZXJyb3IiLCJfd2FybmluZyIsIl9zdWNjZXNzIiwibWFuYWdlciIsInBhdGgiLCJxdWVyeSIsIm9uSW5pdGlhbERpckxvYWRlZCIsIml0ZW0iLCJpc0RlZmluZWQiLCJ0eXBlIiwibmFtZSIsIl9fcmVzb2x2ZU1lc3NhZ2UiLCJyZXNwb25zZSIsIm5vdGlmaWNhdGlvbiIsImhhc01lc3NhZ2UiLCJtZXNzYWdlIiwiZXJyb3IiLCJoYW5kbGVyIiwic3VjY2VzcyIsImxvZyIsImV4dGVuZCIsImRpcnMiLCJpdGVtcyIsImdldCIsImNvbnRyb2xsZXIiLCJGb2xkZXJDb250cm9sbGVyIiwiZm9jdXMiLCJTZXR0aW5ncyIsImZvbGRlciIsImxvYWRpbmciLCJjcmVhdGluZyIsImZpbHRlcnMiLCJpbWFnZSIsIm1lZGlhIiwiZG9jdW1lbnQiLCJmaWxlIiwib3JkZXIiLCJmdW5jIiwiY2hhbmdlIiwiY2hhbmdlT3JkZXIiLCJieSIsInJldmVyc2UiLCJzaXplIiwiZGF0ZSIsImVuYWJsZUNyZWF0ZSIsImNyZWF0ZSIsInJlZnJlc2giLCJpc0ZpbHRlcnNFbmFibGVkIiwiZm9sZGVyRmlsdGVyIiwiX19jYW5Mb2FkIiwid2FybiIsIm9uRXJyb3JIYW5kbGVkIiwiZXZlbnQiLCJjaGFuZ2VGb2xkZXIiLCJyIiwib25Gb2xkZXJDaGFuZ2VkIiwib25Gb2xkZXJFeHRlcm5hbGx5Q2hhbmdlZCIsImFkZE5ld0ZpbGUiLCJleHRlbmRJdGVtIiwibGVuZ3RoIiwidW5zaGlmdCIsInJlbW92ZUJ5UGF0aCIsInJlbW92ZUl0ZW0iLCJ2YWx1ZSIsImluZGV4IiwiYXJyYXkiLCJnZXRUeXBlIiwibmV3TmFtZSIsIm9wdGlvbnMiLCJpIiwiaGFzT3duUHJvcGVydHkiLCJyZXBsYWNlIiwicHV0Iiwib25Gb2xkZXJDcmVhdGVkIiwiJG9uIiwidG9wIiwidyIsIk8iLCJGb2xkZXJJdGVtQ29udHJvbGxlciIsIkZpbGVTZXJ2aWNlIiwiY2xpY2siLCJjYW5SZW5hbWUiLCJlbmFibGVSZW5hbWUiLCJkaXNhYmxlUmVuYW1lIiwicmVuYW1lIiwic2VsZWN0IiwiaGFzVGh1bWJzIiwidGh1bWJOYW1lIiwiZGVsZXRlSXRlbSIsImV4dCIsInNwbGl0IiwicG9wIiwiY3V0Iiwic3Vic3RyaW5nIiwiaWQiLCJvbkZvbGRlclJlbmFtZWQiLCJnZXRJdGVtTmV3TmFtZSIsIm9uRmlsZVJlbmFtZWQiLCJjb3B5IiwidXJsIiwibmV3Iiwib2xkIiwidGh1bWJzIiwidGh1bWJJbmRleCIsImZpbGVfdXJsIiwiaXNUYXJnZXQiLCJpbmZvIiwidGlueW1jZSIsIm1ham9yVmVyc2lvbiIsImFjdGl2ZUVkaXRvciIsIndpbmRvd01hbmFnZXIiLCJwYXJhbXMiLCJzZXRVcmwiLCJlZGl0b3JfaWQiLCJtY2Vfd2luZG93X2lkIiwiY2xvc2UiLCJnZXRQYXJhbXMiLCJmaWxlbWFuYWdlciIsInBhcmVudCIsIm9uU2VsZWN0ZWQiLCJvbkZvbGRlckRlbGV0ZWQiLCJvbkZpbGVEZWxldGVkIiwia2V5cyIsIndpZHRoIiwiaGVpZ2h0IiwiZ2V0VGh1bWJTaXplIiwidGVtcGxhdGUiLCJzdXBwbGFudCIsIndpbmRvdyIsIk9iamVjdCIsIlRyZWVDb250cm9sbGVyIiwiaXNPcGVuIiwiaXNFbXB0eSIsInRyZWUiLCJyb290IiwiZXhwYW5kIiwidHJlZUNoYW5nZWQiLCJpbmRleE9mIiwiZm9sZGVycyIsIm9sZEZvbGRlciIsIm5ld0ZvbGRlciIsImN1cnJGb2xkZXIiLCJjdXJyIiwidW5kZWZpbmVkIiwiVXBsb2FkQ29udHJvbGxlciIsIkZpbGVVcGxvYWRlciIsInVwbG9hZGVyIiwiX2dldFVwbG9hZFBhdGgiLCJvbldoZW5BZGRpbmdGaWxlRmFpbGVkIiwiZmlsdGVyIiwib25BZnRlckFkZGluZ0ZpbGUiLCJmaWxlSXRlbSIsIm9uRXJyb3JJdGVtIiwic3RhdHVzIiwiaGVhZGVycyIsIm9uQ29tcGxldGVJdGVtIiwib25Db21wbGV0ZUFsbCIsImhhc05vdFVwbG9hZGVkRmlsZXMiLCJmb3JFYWNoIiwicXVldWUiLCJpc1JlYWR5IiwiaXNVcGxvYWRpbmciLCJpc1N1Y2Nlc3MiLCJjbGVhclF1ZXVlIiwiJHJlc291cmNlIiwic2VydmljZSIsIiRodHRwIiwiRGlyU2VydmljZUV4dGVuZGVkIiwia2V5IiwidGhpcyIsInB1c2giLCJvbGROYW1lIiwib25TdWNjZXNzIiwib25FcnJvciIsInBvc3QiLCJ0aGVuIiwiZGVsZXRlRGlyIiwiaWRHZW4iLCJkZWxldGUiLCJkZWxldGVGaWxlIiwiY3Vycl90YXJnZXQiLCJ0YXJnZXQiLCJ0b0xvd2VyQ2FzZSIsInNpemVLZXkiLCJzaXplcyIsImZyb21Kc29uIiwiZGF0YVBhcmFtcyIsInN0ckZyb21Kc29uIiwiZml4U2VyaWFsaXphYmxlU3RyIiwic3RyIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFBQSxHQUNBLFlBRUFBLEdBQUFDLE9BQUEsZ0JBQ0EsWUFDQSxzQkFDQSxvQkFDQSxZQUNBLGFBQ0EsYUFDQSxlQUNBLGtCQUNBLDJCQUdBQyxTQ2RBLFdBQ0EsWUFFQUEsU0FBQUQsT0FBQSxPQUNBLG9CQ0xBLFNBQUFDLEVBQUFDLEdBQ0EsWUFTQSxTQUFBQyxHQUFBQyxHQUNBLEdBQUFDLEdBQUFILEVBQUEsWUFFQUUsR0FBQUUsY0FBQSxTQUFBQyxFQUFBQyxHQUNBSixFQUFBSyxXQUFBRixFQUFBQyxJQUdBSixFQUFBTSxRQUFBLFdBQ0EsTUFBQUwsR0FBQU0sS0FBQSxhQWZBVixFQUNBRCxPQUFBLGdCQUNBWSxJQUFBVCxHQUNBQSxFQUFBVSxTQUNBLGVBY0FaLFFBQUFhLFFDckJBLFNBQUFiLEVBQUFDLEdBQ0EsWUFVQSxTQUFBYSxHQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBQyxHQUtBLFFBQUFDLEtBQ0FMLEVBQUFNLE1BQUFBLEVBQ0FOLEVBQUFPLFFBQUFBLEVBR0FQLEVBQUFRLE9BQUFBLEVBQ0FSLEVBQUFTLFNBQUFBLEVBQ0FULEVBQUFVLFNBQUFBLEVBRUFWLEVBQUFXLFNBQ0FDLEtBQUEsS0FJQVIsRUFBQVMsTUFBQUMsR0FTQSxRQUFBUixHQUFBUyxHQUNBLE1BQUFBLElBQUEvQixFQUFBZ0MsVUFBQUQsRUFBQUUsT0FBQSxRQUFBRixFQUFBRSxLQVFBLFFBQUFWLEdBQUFRLEdBQ0EsTUFBQVQsR0FBQVMsSUFBQSxNQUFBQSxFQUFBRyxLQUdBLFFBQUFDLEdBQUFDLEdBQ0EsR0FBQUMsSUFBQSxDQVFBLE9BTkFyQyxHQUFBZ0MsVUFBQUksRUFBQUMsZ0JBQ0FBLEVBQUFELEVBQUFDLGNBRUFyQyxFQUFBZ0MsVUFBQUksRUFBQTFCLE9BQUFWLEVBQUFnQyxVQUFBSSxFQUFBMUIsS0FBQTJCLGdCQUNBQSxFQUFBRCxFQUFBMUIsS0FBQTJCLGNBRUFBLEdBQ0FDLFlBQUEsRUFBQUMsUUFBQUYsSUFFQXRCLEVBQUF5QixNQUFBLGdEQUFBSixTQUFBQSxLQUNBRSxZQUFBLElBR0EsUUFBQWQsR0FBQVksR0FDQXBCLEVBQUFYLGNBQUEsU0FDQSxJQUFBb0MsR0FBQU4sRUFBQUMsRUFDQUssR0FBQUgsWUFDQXBCLEVBQUFzQixPQUFBRCxRQUFBRSxFQUFBRixVQUdBLFFBQUFkLEdBQUFXLEdBQ0FwQixFQUFBWCxjQUFBLFdBQ0EsSUFBQW9DLEdBQUFOLEVBQUFDLEVBQ0FLLEdBQUFILFlBQ0FwQixFQUFBc0IsT0FBQUQsUUFBQUUsRUFBQUYsVUFHQSxRQUFBYixHQUFBVSxHQUNBLEdBQUFLLEdBQUFOLEVBQUFDLEVBQ0FLLEdBQUFILFlBQ0FwQixFQUFBd0IsU0FBQUgsUUFBQUUsRUFBQUYsVUFRQSxRQUFBVCxHQUFBTSxHQUNBckIsRUFBQTRCLElBQUEsd0NBQUFQLFNBQUFBLElBRUFqQixFQUFBeUIsT0FBQVIsR0FFQXBCLEVBQUFYLGNBQUEsZUFBQStCLEVBQUFTLFFBQ0E3QixFQUFBWCxjQUFBLGlCQUFBK0IsRUFBQVUsU0FFQS9CLEVBQUE0QixJQUFBLGVBQUFmLEtBQUFYLEVBQUE4QixJQUFBLFVBQ0EsTUFBQTlCLEVBQUE4QixJQUFBLFNBQUEsbUJBQUE5QixHQUFBOEIsSUFBQSxTQUNBL0IsRUFBQVgsY0FBQSxpQkFBQXVCLEtBQUFYLEVBQUE4QixJQUFBLFVBM0ZBaEMsRUFBQTRCLElBQUEsd0NBRUF0QixJQVhBckIsRUFDQUQsT0FBQSxnQkFDQWlELFdBQUEsaUJBQUFsQyxHQUVBQSxFQUFBRixTQUNBLE9BQUEsU0FBQSxXQUFBLGVBQUEsYUFBQSxRQW1HQVosUUFBQWEsUUMzR0EsU0FBQWIsRUFBQUMsR0FDQSxZQVVBLFNBQUFnRCxHQUFBbEMsRUFBQUMsRUFBQUMsRUFBQWlDLEVBQUE5QixFQUFBRCxFQUFBZ0MsR0FLQSxRQUFBOUIsS0FDQUwsRUFBQW9DLFFBQ0FDLFNBQUEsRUFDQUMsVUFBQSxFQUNBcEIsS0FBQSxHQUNBWSxTQUNBUyxTQUNBQyxPQUFBLEVBQ0FDLE9BQUEsRUFDQUMsVUFBQSxFQUNBQyxNQUFBLEdBRUFDLE9BQ0FDLEtBQUFELEVBQ0FFLE9BQUFDLEVBQ0FDLEdBQUEsT0FDQUMsU0FBQSxFQUNBL0IsTUFBQSxFQUNBZ0MsTUFBQSxFQUNBQyxNQUFBLEdBRUFDLGFBQUFBLEVBQ0FDLE9BQUFBLEVBQ0FDLFFBQUFBLEVBQ0FDLGlCQUFBQSxHQUVBdkQsRUFBQXdELGFBQUFBLEVBR0EsUUFBQUMsS0FFQSxNQUFBekQsR0FBQW9DLE9BQUFDLFNBQ0F0QyxFQUFBMkQsS0FBQSw4QkFBQSxnQ0FDQSxJQUVBLEVBS0EsUUFBQUMsR0FBQUMsR0FDQTVELEVBQUFvQyxPQUFBQyxTQUFBLEVBSUEsUUFBQXdCLEdBQUFELEVBQUF4QixHQUNBcUIsTUFHQTFELEVBQUE0QixJQUFBLG9DQUFBaUMsTUFBQUEsRUFBQXhCLE9BQUFBLElBQ0FwQyxFQUFBb0MsT0FBQUMsU0FBQSxFQUNBakMsRUFBQVMsT0FBQUQsS0FBQXdCLEVBQUF4QixNQUFBLEtBQUEsU0FBQWtELEdBQ0E5RCxFQUFBVSxTQUFBb0QsR0FDQUMsRUFBQUQsRUFBQTFCLElBQ0FwQyxFQUFBUSxTQUlBLFFBQUF3RCxHQUFBSixFQUFBOUIsR0FDQS9CLEVBQUE0QixJQUFBLGlEQUFBaUMsTUFBQUEsRUFBQTlCLE1BQUFBLElBQ0E5QixFQUFBb0MsT0FBQUMsU0FBQSxFQUNBckMsRUFBQW9DLE9BQUFOLE1BQUFBLEVBSUEsUUFBQW1DLEdBQUFMLEVBQUFqQixHQUNBNUMsRUFBQTRCLElBQUEsa0NBQUFpQyxNQUFBQSxFQUFBakIsS0FBQUEsSUFDQXhDLEVBQUErRCxXQUFBdkIsRUFBQTNDLEVBQUFvQyxPQUFBTixNQUFBcUMsUUFDQW5FLEVBQUFvQyxPQUFBTixNQUFBc0MsUUFBQXpCLEdBS0EsUUFBQTBCLEdBQUFULEVBQUE3QyxHQUNBaEIsRUFBQTRCLElBQUEsb0NBQUFpQyxNQUFBQSxFQUFBN0MsS0FBQUEsRUFBQWUsTUFBQTlCLEVBQUFvQyxPQUFBTixRQUNBOUIsRUFBQW9DLE9BQUFOLE1BQUF3QyxXQUFBdkQsRUFBQUgsS0FBQSxRQVdBLFFBQUE0QyxHQUFBZSxFQUFBQyxFQUFBQyxHQUNBLEdBQUF6RixFQUFBZ0MsVUFBQXVELEVBQUF0RCxNQUFBLENBQ0EsR0FBQSxPQUFBc0QsRUFBQXRELEtBQ0EsT0FBQSxDQUVBLElBQUFzQyxJQUNBLE1BQUF2RCxHQUFBb0MsT0FBQUcsUUFBQWdDLEVBQUF0RCxLQUVBLElBQUFrQixFQUFBdUMsV0FBQUgsRUFBQXRELEtBQ0EsT0FBQSxFQUdBLE9BQUEsRUFHQSxRQUFBMkIsR0FBQTdCLEdBQ0EsTUFBQSxRQUFBQSxFQUFBRSxLQUNBLE1BQUFGLEVBQUFHLEtBQ0EsR0FDQSxLQUFBSCxFQUFBZixFQUFBb0MsT0FBQVEsTUFBQUksSUFHQSxJQUFBakMsRUFBQWYsRUFBQW9DLE9BQUFRLE1BQUFJLElBR0EsUUFBQUQsR0FBQTRCLEdBQ0EzRSxFQUFBb0MsT0FBQVEsTUFBQUksR0FBQTJCLENBQ0EsSUFBQUMsSUFBQSxPQUFBLE9BQUEsT0FDQSxLQUFBLEdBQUFDLEtBQUFELEdBQ0FBLEVBQUFFLGVBQUFELEtBQ0E3RSxFQUFBb0MsT0FBQVEsTUFBQWdDLEVBQUFDLEtBQUEsRUFJQSxPQUZBN0UsR0FBQW9DLE9BQUFRLE1BQUErQixJQUFBLEdBRUEsRUFHQSxRQUFBcEIsS0FDQSxNQUFBLFFBQUFwQixFQUFBdUMsVUFHQSxRQUFBcEIsS0FDQUcsTUFFQTFELEVBQUE0QixJQUFBLCtCQUFBaEIsUUFBQVgsRUFBQVcsVUFDQVgsRUFBQW9DLE9BQUFDLFNBQUEsRUFDQXJDLEVBQUFXLFFBQUFDLEtBQUFaLEVBQUFXLFFBQUFDLEtBQUFtRSxRQUFBLFdBQUEsSUFDQTNFLEVBQUFTLE9BQUFELEtBQUFaLEVBQUFXLFFBQUFDLE1BQUEsS0FBQSxTQUFBa0QsR0FDQUMsRUFBQUQsRUFBQTlELEVBQUFXLFVBQ0FYLEVBQUFRLFNBU0EsUUFBQXVELEdBQUEzQyxFQUFBZ0IsR0FDQXJDLEVBQUE0QixJQUFBLHVEQUNBUCxTQUFBQSxFQUFBZ0IsT0FBQUEsSUFDQWpDLEVBQUF5QixPQUFBUixHQUNBcEIsRUFBQW9DLE9BQUFOLE1BQUFWLEVBQUFVLFFBQ0E5QixFQUFBb0MsT0FBQUMsU0FBQSxFQUNBckMsRUFBQVcsUUFBQUMsS0FBQSxLQUFBd0IsRUFBQXhCLE1BQUEsSUFDQVgsRUFBQStFLElBQUEsT0FBQTVDLEVBQUF4QixNQUFBLElBR0EsUUFBQXdDLEtBQ0FwRCxFQUFBb0MsT0FBQUUsVUFBQSxFQUNBSixFQUFBLHFCQUdBLFFBQUFtQixLQUNBSSxLQUVBekQsRUFBQW9DLE9BQUFsQixNQUFBLEtBQUFsQixFQUFBb0MsT0FBQWxCLE1BQ0FmLEVBQUFrRCxPQUFBckQsRUFBQVcsUUFBQUMsS0FBQVosRUFBQW9DLE9BQUFsQixLQUNBK0QsRUFBQWpGLEVBQUFRLFFBR0EsUUFBQXlFLEdBQUE3RCxHQUNBckIsRUFBQTRCLElBQUEsaURBQUFQLFNBQUFBLElBRUFwQixFQUFBVSxTQUFBVSxHQUNBcEIsRUFBQW9DLE9BQUFFLFVBQUEsRUFDQXRDLEVBQUFvQyxPQUFBbEIsS0FBQSxFQUNBLElBQUFrQixHQUFBaEIsRUFBQTFCLElBQ0FTLEdBQUErRCxXQUFBOUIsRUFBQXBDLEVBQUFvQyxPQUFBTixNQUFBcUMsUUFDQW5FLEVBQUFvQyxPQUFBTixNQUFBc0MsUUFBQWhDLEdBQ0FwQyxFQUFBWCxjQUFBLGlCQUFBK0MsR0FwTEFyQyxFQUFBNEIsSUFBQSwwQ0FFQXRCLElBd0NBTCxFQUFBa0YsSUFBQSxTQUFBdkIsR0FDQTNELEVBQUFrRixJQUFBLFdBQUF2QixHQUtBM0QsRUFBQWtGLElBQUEsZ0JBQUFyQixHQWFBN0QsRUFBQWtGLElBQUEsaUJBQUFsQixHQU9BaEUsRUFBQWtGLElBQUEsZ0JBQUFqQixHQU9BakUsRUFBQWtGLElBQUEsaUJBQUFiLEdBQ0FyRSxFQUFBa0YsSUFBQSxlQUFBYixHQXJGQXJGLEVBQ0FELE9BQUEsZ0JBQ0FpRCxXQUFBLG1CQUFBQyxHQUVBQSxFQUFBckMsU0FDQSxPQUFBLFNBQUEsV0FBQSxRQUFBLE1BQUEsYUFBQSxhQTJMQVosUUFBQWEsUUNuTUEsU0FBQWIsRUFBQUMsRUFBQWtHLEVBQUFDLEVBQUFDLEdBQ0EsWUFVQSxTQUFBQyxHQUFBdkYsRUFBQUMsRUFBQWtDLEVBQUEvQixFQUFBb0YsRUFBQXBELEdBS0EsUUFBQTlCLEtBQ0FMLEVBQUF3RixNQUFBQSxFQUNBeEYsRUFBQXlGLFVBQUFBLEVBQ0F6RixFQUFBMEYsYUFBQUEsRUFDQTFGLEVBQUEyRixjQUFBQSxFQUNBM0YsRUFBQTRGLE9BQUFBLEVBQ0E1RixFQUFBNkYsT0FBQUEsRUFDQTdGLEVBQUE4RixVQUFBQSxFQUNBOUYsRUFBQStGLFVBQUFBLEVBQ0EvRixFQUFBLFVBQUFnRyxFQU1BLFFBQUFSLEdBQUF6RSxHQUNBLE1BQUFmLEdBQUFvQyxPQUFBQyxZQUVBdEMsR0FBQTJELEtBQUEsZ0NBQUEsZ0NBSUEzRCxFQUFBNEIsSUFBQSxpQ0FBQVosS0FBQUEsSUFFQWYsRUFBQU0sTUFBQVMsT0FDQWYsR0FBQVgsY0FBQSxnQkFBQTBCLE9BSUE4RSxHQUFBOUUsSUFHQSxRQUFBMEUsR0FBQTFFLEdBQ0EsT0FBQWYsRUFBQU8sUUFBQVEsR0FNQSxRQUFBMkUsR0FBQTNFLEdBRUEsR0FEQUEsRUFBQTZFLFFBQUEsRUFDQTVGLEVBQUFNLE1BQUFTLEdBQ0FBLEVBQUE0RCxRQUFBNUQsRUFBQUcsU0FDQSxDQUNBSCxFQUFBa0YsSUFBQWxGLEVBQUFHLEtBQUFnRixNQUFBLEtBQUFDLEtBQ0EsSUFBQUMsR0FBQSxDQUNBckYsR0FBQWtGLElBQUE5QixTQUNBaUMsRUFBQXJGLEVBQUFrRixJQUFBOUIsT0FBQSxHQUVBcEQsRUFBQTRELFFBQUE1RCxFQUFBRyxLQUFBbUYsVUFBQSxFQUFBdEYsRUFBQUcsS0FBQWlELE9BQUFpQyxHQUVBbEUsRUFBQSxJQUFBbkIsRUFBQXVGLEdBQUEsVUFHQSxRQUFBVixLQUNBLE1BQUE1RixHQUFBTSxNQUFBTixFQUFBZSxXQUNBLE1BQUFmLEVBQUFlLEtBQUFHLE1BQ0FmLEVBQUF5RixPQUFBNUYsRUFBQVcsUUFBQUMsS0FDQVosRUFBQWUsS0FBQUcsS0FBQWxCLEVBQUFlLEtBQUE0RCxRQUFBNEIsRUFBQXZHLEVBQUFRLGFBSUErRSxHQUFBSyxPQUFBNUYsRUFBQVcsUUFBQUMsS0FDQVosRUFBQWUsS0FBQUcsS0FBQXNGLEVBQUF4RyxFQUFBZSxNQUFBMEYsRUFBQXpHLEVBQUFRLFFBR0EsUUFBQWdHLEdBQUF6RixHQUNBLE1BQUEvQixHQUFBZ0MsVUFBQUQsRUFBQWtGLE1BQUFsRixFQUFBa0YsSUFBQTlCLE9BQ0FwRCxFQUFBNEQsUUFBQSxJQUFBNUQsRUFBQWtGLElBQ0FsRixFQUFBNEQsUUFHQSxRQUFBZ0IsR0FBQTVFLEdBQ0FBLEVBQUE2RSxRQUFBLEVBR0EsUUFBQVcsR0FBQW5GLEdBQ0FyQixFQUFBNEIsSUFBQSwyQ0FBQVAsU0FBQUEsRUFBQUwsS0FBQWYsRUFBQWUsT0FDQWYsRUFBQVUsU0FBQVUsRUFDQSxJQUFBc0YsR0FBQTFILEVBQUEwSCxLQUFBMUcsRUFBQWUsS0FDQWYsR0FBQWUsS0FBQTZFLFFBQUEsRUFFQTVGLEVBQUFlLEtBQUFILEtBQUFRLEVBQUExQixLQUFBa0IsS0FDQVosRUFBQWUsS0FBQUcsS0FBQUUsRUFBQTFCLEtBQUF3QixLQUNBbEIsRUFBQWUsS0FBQTRGLElBQUF2RixFQUFBMUIsS0FBQWlILElBRUEzRyxFQUFBWCxjQUFBLGtCQUFBdUgsTUFBQXhGLEVBQUExQixLQUFBbUgsSUFBQUgsSUFHQSxRQUFBRCxHQUFBckYsR0FDQXJCLEVBQUE0QixJQUFBLHlDQUFBUCxTQUFBQSxJQUNBcEIsRUFBQVUsU0FBQVUsR0FDQXBCLEVBQUFlLEtBQUE2RSxRQUFBLEVBQ0E1RixFQUFBZSxLQUFBRyxLQUFBRSxFQUFBMUIsS0FBQXdCLEtBQ0FsQixFQUFBZSxLQUFBNEYsSUFBQXZGLEVBQUExQixLQUFBaUgsSUFDQTNHLEVBQUFlLEtBQUErRixPQUFBMUYsRUFBQTFCLEtBQUFvSCxPQUdBLFFBQUFqQixHQUFBOUUsRUFBQWdHLEdBQ0EsR0FBQUMsR0FBQWpHLEVBQUE0RixHQU1BLElBTEFJLElBQ0FDLEVBQUFqRyxFQUFBK0YsT0FBQUMsSUFJQTVFLEVBQUE4RSxTQUFBLFdBRUEsR0FEQWxILEVBQUFtSCxLQUFBLDZDQUFBQyxRQUFBaEMsRUFBQWdDLFVBQ0FoQyxFQUFBZ0MsUUFBQUMsYUFBQSxFQUFBLENBQ0FqQyxFQUFBZ0MsUUFBQUUsYUFBQUMsY0FBQUMsT0FBQUMsT0FBQVIsRUFDQSxJQUFBUyxHQUFBdEMsRUFBQWdDLFFBQUFFLGFBQUFDLGNBQUFDLE9BQUFHLGFBQ0F2QyxHQUFBZ0MsUUFBQUUsYUFBQUMsY0FBQUssTUFBQUYsT0FHQTFILEdBQUFtSCxLQUFBLDhDQUNBSyxPQUFBcEMsRUFBQWdDLFFBQUFFLGFBQUFDLGNBQUFNLGNBQ0F6QyxFQUFBZ0MsUUFBQUUsYUFBQUMsY0FBQU0sWUFBQUosT0FBQVIsR0FDQTdCLEVBQUFnQyxRQUFBRSxhQUFBQyxjQUFBSyxPQUlBLElBQUF4RixFQUFBOEUsU0FBQSxZQUFBLENBQ0EsR0FBQVksR0FBQXpDLEVBQUF5QyxhQUFBekMsRUFBQTBDLE9BQUFELGVBRUFBLElBQUFBLEVBQUFFLFlBQ0FGLEVBQUFFLFdBQUFmLEVBQUE3RSxFQUFBeUYsY0FLQSxRQUFBNUIsR0FBQWpGLEdBQ0EsTUFBQWYsR0FBQU0sTUFBQVMsUUFDQSxNQUFBQSxFQUFBRyxNQUNBZixFQUFBQSxVQUFBSCxFQUFBVyxRQUFBQyxLQUFBRyxFQUFBRyxLQUFBOEcsRUFBQWhJLEVBQUFRLGFBR0ErRSxHQUFBQSxVQUFBdkYsRUFBQVcsUUFBQUMsS0FBQUcsRUFBQUcsS0FBQStHLEVBQUFqSSxFQUFBUSxRQUdBLFFBQUF3SCxHQUFBNUcsR0FDQXJCLEVBQUE0QixJQUFBLDJDQUFBUCxTQUFBQSxJQUNBcEIsRUFBQVUsU0FBQVUsR0FDQXBCLEVBQUFYLGNBQUEsaUJBQUErQixFQUFBMUIsTUFHQSxRQUFBdUksR0FBQTdHLEdBQ0FyQixFQUFBNEIsSUFBQSx5Q0FBQVAsU0FBQUEsSUFDQXBCLEVBQUFVLFNBQUFVLEdBQ0FwQixFQUFBWCxjQUFBLGVBQUErQixFQUFBMUIsTUFHQSxRQUFBb0csR0FBQS9FLEdBQ0EsUUFBQUEsR0FBQS9CLEVBQUFnQyxVQUFBRCxFQUFBK0YsU0FBQXpCLEVBQUE2QyxLQUFBbkgsRUFBQStGLFFBQUEzQyxPQUFBLEVBR0EsUUFBQTRCLEdBQUFnQixFQUFBb0IsRUFBQUMsR0FDQSxHQUFBckIsRUFBQSxDQUNBLEdBQUE3RCxHQUFBZixFQUFBa0csYUFBQXRCLEVBQ0FvQixHQUFBakYsRUFBQSxHQUNBa0YsRUFBQWxGLEVBQUEsR0FFQSxHQUFBb0YsR0FBQSx1QkFDQWYsR0FBQVksTUFBQUEsRUFBQUMsT0FBQUEsRUFFQSxPQUFBRSxHQUFBQyxTQUFBaEIsR0F2S0F4SCxFQUFBNEIsSUFBQSw4Q0FFQXRCLElBWEFyQixFQUNBRCxPQUFBLGdCQUNBaUQsV0FBQSx1QkFBQXNELEdBRUFBLEVBQUExRixTQUNBLE9BQUEsU0FBQSxRQUFBLGFBQUEsY0FBQSxhQThLQVosUUFBQWEsT0FBQXNGLElBQUFxRCxPQUFBQyxRQ3RMQSxTQUFBekosRUFBQUMsR0FDQSxZQVVBLFNBQUF5SixHQUFBM0ksRUFBQUMsRUFBQUksRUFBQUQsR0FLQSxRQUFBRSxLQUNBTCxFQUFBMkksT0FBQUEsRUFDQTNJLEVBQUE0SSxRQUFBQSxFQUNBNUksRUFBQTZELGFBQUFBLEVBRUE3RCxFQUFBNkksTUFDQXhHLFNBQUEsRUFDQVAsU0FDQWdILE1BQ0E1SCxLQUFBLElBQ0F5RixJQUFBM0csRUFBQVAsUUFBQSxPQUVBc0osT0FBQUEsR0FRQSxRQUFBcEYsR0FBQUMsR0FDQTVELEVBQUE2SSxLQUFBeEcsU0FBQSxFQUlBLFFBQUEyRyxHQUFBcEYsRUFBQWlGLEdBQ0E5SSxFQUFBNEIsSUFBQSxpQ0FBQWlDLE1BQUFBLEVBQUFpRixLQUFBQSxJQUNBN0ksRUFBQTZJLEtBQUEvRyxNQUFBK0csRUFDQTdJLEVBQUE2SSxLQUFBeEcsU0FBQSxFQUlBLFFBQUE0QyxHQUFBckIsRUFBQXhCLEdBQ0FyQyxFQUFBNEIsSUFBQSxxQ0FBQWlDLE1BQUFBLEVBQUF4QixPQUFBQSxJQUNBLEtBQUFBLEVBQUF4QixLQUFBcUksUUFBQSxNQUVBakosRUFBQTZJLEtBQUEvRyxNQUFBc0MsUUFBQWhDLEdBS0EsUUFBQW1FLEdBQUEzQyxFQUFBc0YsR0FDQSxHQUFBQyxHQUFBRCxFQUFBckMsSUFDQXVDLEVBQUFGLEVBQUFBLE1BQ0FuSixHQUFBNEIsSUFBQSxxQ0FBQWlDLE1BQUFBLEVBQUF3RixVQUFBQSxFQUFBRCxVQUFBQSxHQUdBLEtBQUEsR0FBQXRFLEdBQUEsRUFBQUEsRUFBQTdFLEVBQUE2SSxLQUFBL0csTUFBQXFDLE9BQUFVLElBQ0E3RSxFQUFBNkksS0FBQS9HLE1BQUErQyxHQUFBakUsTUFBQXVJLEVBQUF2SSxPQUVBWixFQUFBNkksS0FBQS9HLE1BQUErQyxHQUFBakUsS0FBQXdJLEVBQUF4SSxLQUNBWixFQUFBNkksS0FBQS9HLE1BQUErQyxHQUFBM0QsS0FBQWtJLEVBQUFsSSxLQUNBbEIsRUFBQTZJLEtBQUEvRyxNQUFBK0MsR0FBQThCLElBQUF5QyxFQUFBekMsS0FNQSxRQUFBdEMsR0FBQVQsRUFBQTdDLEdBQ0FoQixFQUFBNEIsSUFBQSxrQ0FBQWlDLE1BQUFBLEVBQUE3QyxLQUFBQSxFQUFBZSxNQUFBOUIsRUFBQTZJLEtBQUEvRyxRQUdBOUIsRUFBQTZJLEtBQUEvRyxNQUFBd0MsV0FBQXZELEVBQUFILEtBQUEsUUFTQSxRQUFBK0gsR0FBQXZHLEdBQ0EsTUFBQUEsSUFBQXBELEVBQUFnQyxVQUFBb0IsRUFBQThHLFNBU0EsUUFBQU4sR0FBQXhHLEdBQ0EsTUFBQXVHLEdBQUF2RyxHQUNBLEdBQUFBLEVBQUE4RyxRQUFBL0UsUUFDQSxFQUdBLFFBQUE0RSxHQUFBTSxHQUVBLE1BQUFySixHQUFBNkksS0FBQXhHLFNBQUF1RyxFQUFBUyxPQUNBdEosR0FBQTJELEtBQUEsMkJBQUEsZ0NBSUEzRCxFQUFBNEIsSUFBQSw0QkFBQTJILEtBQUFELElBR0FWLEVBQUFVLFFBQ0FBLEVBQUFILFFBQUFLLFNBSUF2SixFQUFBNkksS0FBQXhHLFNBQUEsTUFDQWpDLEdBQUFTLE9BQUFELEtBQUF5SSxFQUFBekksTUFBQSxTQUFBUSxHQUNBakIsRUFBQXlCLE9BQUFSLEdBQ0FwQixFQUFBNkksS0FBQXhHLFNBQUEsRUFDQWdILEVBQUFILFFBQUE5SCxFQUFBUyxRQUNBN0IsRUFBQVEsVUFHQSxRQUFBcUQsR0FBQXpCLEdBQ0FwQyxFQUFBWCxjQUFBLGdCQUFBK0MsR0FuSEFyQyxFQUFBNEIsSUFBQSx3Q0FFQXRCLElBb0JBTCxFQUFBa0YsSUFBQSxTQUFBdkIsR0FDQTNELEVBQUFrRixJQUFBLFdBQUF2QixHQUtBM0QsRUFBQWtGLElBQUEsZUFBQThELEdBT0FoSixFQUFBa0YsSUFBQSxpQkFBQUQsR0FTQWpGLEVBQUFrRixJQUFBLGlCQUFBcUIsR0FpQkF2RyxFQUFBa0YsSUFBQSxpQkFBQWIsR0F0RUFyRixFQUNBRCxPQUFBLGdCQUNBaUQsV0FBQSxpQkFBQTBHLEdBRUFBLEVBQUE5SSxTQUNBLE9BQUEsU0FBQSxNQUFBLGVBMEhBWixRQUFBYSxRQ2xJQSxTQUFBYixFQUFBQyxHQUNBLFlBVUEsU0FBQXVLLEdBQUF6SixFQUFBQyxFQUFBeUosR0FLQSxRQUFBcEosS0FDQUwsRUFBQTBKLFNBQUEsR0FBQUQsSUFDQTlDLElBQUFnRCxJQUlBLFFBQUFBLEtBQ0EsTUFBQTNKLEdBQUFQLFVBQUEsY0FBQU8sRUFBQVcsUUFBQUMsS0FYQWIsRUFBQTRCLElBQUEsMENBRUF0QixJQVlBTCxFQUFBMEosU0FBQUUsdUJBQUEsU0FBQTdJLEVBQUE4SSxFQUFBakYsR0FDQTdFLEVBQUFtSCxLQUFBLHlCQUFBbkcsRUFBQThJLEVBQUFqRixJQUdBNUUsRUFBQTBKLFNBQUFJLGtCQUFBLFNBQUFDLEdBRUFBLEVBQUFMLFNBQUEvQyxJQUFBb0QsRUFBQXBELElBQUFnRCxJQUNBNUosRUFBQW1ILEtBQUEsb0JBQUE2QyxJQUdBL0osRUFBQTBKLFNBQUFNLFlBQUEsU0FBQUQsRUFBQTNJLEVBQUE2SSxFQUFBQyxHQUVBbkssRUFBQW1ILEtBQUEsY0FBQTZDLEVBQUFFLEVBQUFDLElBR0FsSyxFQUFBMEosU0FBQVMsZUFBQSxTQUFBSixFQUFBM0ksRUFBQTZJLEVBQUFDLEdBQ0EsTUFBQUQsSUFDQWxLLEVBQUFtSCxLQUFBLGtEQUNBNkMsU0FBQUEsRUFBQTNJLFNBQUFBLEVBQUE2SSxPQUFBQSxFQUFBQyxRQUFBQSxJQUNBbEssRUFBQVgsY0FBQSxnQkFBQStCLEdBQ0FwQixFQUFBVSxTQUFBVSxLQUlBcEIsRUFBQTBKLFNBQUFVLGNBQUEsV0FDQXJLLEVBQUFtSCxLQUFBLGlEQUFBd0MsU0FBQTFKLEVBQUEwSixVQUVBLElBQUFXLElBQUEsQ0FDQXJMLEdBQUFzTCxRQUFBdEssRUFBQTBKLFNBQUFhLE1BQUEsU0FBQTVILEdBQ0FBLEVBQUE2SCxTQUFBN0gsRUFBQThILGFBQUE5SCxFQUFBK0gsWUFDQUwsR0FBQSxLQUlBQSxHQUVBckssRUFBQTBKLFNBQUFpQixjQTNEQTNMLEVBQ0FELE9BQUEsZ0JBQ0FpRCxXQUFBLG1CQUFBd0gsR0FFQUEsRUFBQTVKLFNBQ0EsT0FBQSxTQUFBLGlCQTBEQVosUUFBQWEsUUNsRUEsU0FBQWIsRUFBQUMsR0FDQSxZQVVBLFNBQUFtQixHQUFBTCxFQUFBNkssRUFBQXpMLEdBR0EsTUFGQVksR0FBQTRCLElBQUEsMkJBRUFpSixFQUFBekwsRUFBQU0sVUFBQSxhQUNBbUIsS0FBQSxVQVpBNUIsRUFDQUQsT0FBQSxnQkFDQThMLFFBQUEsTUFBQXpLLEdBRUFBLEVBQUFSLFNBQ0EsT0FBQSxZQUFBLGVBVUFaLFFBQUFhLFFDbEJBLFNBQUFiLEVBQUFDLEdBQ0EsWUFVQSxTQUFBa0IsR0FBQUosRUFBQVosRUFBQTJMLEdBWUEsUUFBQWxKLEdBQUFsQyxHQUNBVixFQUFBZ0MsVUFBQXRCLEVBQUFxTCxxQkFBQXJMLEVBQUFxTCxxQkFHQS9MLEVBQUE0QyxPQUFBbEMsR0FDQW1DLEtBQUEsV0FDQSxHQUFBcUgsS0FRQSxPQVBBbEssR0FBQXNMLFFBQUE1SyxFQUFBLFNBQUE2RSxFQUFBeUcsR0FDQSxPQUFBekcsRUFBQXRELE1BQUEsTUFBQXNELEVBQUFyRCxPQUNBZ0QsRUFBQUssRUFBQXlHLEdBQ0FDLEtBQUFDLEtBQUEzRyxLQUVBMkUsR0FFQUEsR0FFQXBILE1BQUEsV0FDQSxHQUFBQSxLQU1BLE9BTEE5QyxHQUFBc0wsUUFBQTVLLEVBQUEsU0FBQTZFLEVBQUF5RyxHQUNBOUcsRUFBQUssRUFBQXlHLEdBQ0FDLEtBQUFDLEtBQUEzRyxJQUNBekMsR0FFQUEsS0FJQXBDLEVBQUFxTCxvQkFBQSxHQVlBLFFBQUFuRixHQUFBaEYsRUFBQXVLLEVBQUF4RyxFQUFBeUcsRUFBQUMsR0FDQSxHQUFBMUUsR0FBQXhILEVBQUFNLFVBQUEsY0FBQW1CLENBQ0FrSyxHQUFBUSxLQUFBM0UsR0FDQUUsSUFBQXNFLEVBQ0F2RSxNQUFBakMsSUFDQTRHLEtBQUFILEVBQUFDLEdBR0EsUUFBQWhJLEdBQUF6QyxFQUFBTSxFQUFBa0ssRUFBQUMsR0FDQSxHQUFBMUUsR0FBQXhILEVBQUFNLFVBQUEsY0FBQW1CLENBQ0FrSyxHQUFBUSxLQUFBM0UsR0FDQXpGLEtBQUFBLElBQ0FxSyxLQUFBSCxFQUFBQyxHQUdBLFFBQUFHLEdBQUE1SyxFQUFBTSxFQUFBa0ssRUFBQUMsR0FDQSxHQUFBMUUsR0FBQXhILEVBQUFNLFVBQUEsY0FBQW1CLENBQ0FrSyxHQUFBUSxLQUFBM0UsR0FDQXpGLEtBQUFBLElBQ0FxSyxLQUFBSCxFQUFBQyxHQUdBLFFBQUFJLEdBQUFULEdBQ0EsTUFBQSxhQUFBQSxFQUdBLFFBQUE5RyxHQUFBbkQsRUFBQWlLLEdBQ0FqSyxFQUFBdUYsR0FBQW1GLEVBQUFULEdBM0VBLE1BRkFqTCxHQUFBNEIsSUFBQSxrQ0FHQUMsT0FBQUEsRUFDQXNDLFdBQUFBLEVBQ0EwQixPQUFBQSxFQUNBdkMsT0FBQUEsRUFDQXFJLFNBQUFGLEVBQ0FDLE1BQUFBLEdBakJBek0sRUFDQUQsT0FBQSxnQkFDQThMLFFBQUEsYUFBQTFLLEdBRUFBLEVBQUFQLFNBQ0EsT0FBQSxhQUFBLFVBb0ZBWixRQUFBYSxRQzVGQSxTQUFBYixFQUFBQyxHQUNBLFlBVUEsU0FBQXNHLEdBQUF4RixFQUFBWixFQUFBMkwsR0FRQSxRQUFBbEYsR0FBQWhGLEVBQUF1SyxFQUFBeEcsRUFBQXlHLEVBQUFDLEdBQ0F0TCxFQUFBNEIsSUFBQSx5QkFBQWYsS0FBQUEsRUFBQXVLLFFBQUFBLEVBQUF4RyxRQUFBQSxHQUVBLElBQUFnQyxHQUFBeEgsRUFBQU0sVUFBQSxlQUFBbUIsQ0FDQWtLLEdBQUFRLEtBQUEzRSxHQUNBRSxJQUFBc0UsRUFDQXZFLE1BQUFqQyxJQUNBNEcsS0FBQUgsRUFBQUMsR0FHQSxRQUFBTSxHQUFBL0ssRUFBQU0sRUFBQWtLLEVBQUFDLEdBQ0F0TCxFQUFBNEIsSUFBQSx5QkFBQWYsS0FBQUEsRUFBQU0sS0FBQUEsR0FFQSxJQUFBeUYsR0FBQXhILEVBQUFNLFVBQUEsZUFBQW1CLENBQ0FrSyxHQUFBUSxLQUFBM0UsR0FDQXpGLEtBQUFBLElBQ0FxSyxLQUFBSCxFQUFBQyxHQXJCQSxNQUZBdEwsR0FBQTRCLElBQUEsbUNBR0FpRSxPQUFBQSxFQUNBOEYsU0FBQUMsR0FiQTNNLEVBQ0FELE9BQUEsZ0JBQ0E4TCxRQUFBLGNBQUF0RixHQUVBQSxFQUFBM0YsU0FDQSxPQUFBLGFBQUEsVUE4QkFaLFFBQUFhLFFDdENBLFNBQUFmLEVBQUFHLEdBQ0EsWUFRQSxTQUFBa0QsS0FVQSxRQUFBOEUsR0FBQTJFLEdBQ0EsTUFBQWhFLEtBQUFpRSxPQUFBQyxnQkFBQUYsRUFBQUUsY0FHQSxRQUFBcEgsS0FDQSxPQUFBa0QsSUFBQTNHLEtBQUFzRyxFQUFBdEcsS0FBQTZLLGVBQUEsSUFBQSxPQUdBLFFBQUF6RCxHQUFBMEQsR0FDQSxHQUFBQyxHQUFBbE4sRUFBQW1OLFNBQUE3TSxFQUFBTSxLQUFBLFNBQUFxRixRQUFBLE1BQUEsS0FFQSxPQUFBaUgsR0FBQUQsR0FHQSxRQUFBbkUsS0FDQSxJQUFBTCxFQUFBLENBQ0EsR0FBQTJFLEdBQUE5TSxFQUFBTSxLQUFBLFNBRUEsSUFBQSxJQUFBd00sRUFBQS9ILE9BQ0EsUUFFQW9ELEdBQUE0RSxFQUFBRCxHQUVBLE1BQUEzRSxHQWhDQSxHQUFBbkksR0FBQUgsRUFBQSxhQUFBc0ksR0FBQSxDQUVBLFFBQ0FOLFNBQUFBLEVBQ0F2QyxRQUFBQSxFQUNBMkQsYUFBQUEsRUFDQVQsVUFBQUEsR0E4QkEsUUFBQXdFLEdBQUFDLEdBQ0EsTUFBQUEsR0FBQXRILFFBQUEsTUFBQSxLQUdBLFFBQUFvSCxHQUFBRSxHQUNBLE1BQUF2TixHQUFBbU4sU0FBQUcsRUFBQUMsSUFoREF2TixFQUNBQyxPQUFBLGdCQUNBOEwsUUFBQSxXQUFBMUksR0FFQUEsRUFBQXZDLFlBOENBWixRQUFBYSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKG5nKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBuZy5tb2R1bGUoJ2ZpbGUubWFuYWdlcicsIFtcbiAgICAgICAgJ2NyaXAuY29yZScsXG4gICAgICAgICdhbmd1bGFyLWxvYWRpbmctYmFyJyxcbiAgICAgICAgJ2FuZ3VsYXJGaWxlVXBsb2FkJyxcbiAgICAgICAgJ25nQ29va2llcycsXG4gICAgICAgICduZ1Jlc291cmNlJyxcbiAgICAgICAgJ25nU2FuaXRpemUnLFxuICAgICAgICAndWkuYm9vdHN0cmFwJyxcbiAgICAgICAgJ3VpLW5vdGlmaWNhdGlvbicsXG4gICAgICAgICdpby5kZW5uaXMuY29udGV4dG1lbnUnXG4gICAgXSk7XG5cbn0pKGFuZ3VsYXIpOyIsIi8vIGhlbGxvIGZyb20ganNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xyXG4gICAgICAgICdmaWxlLm1hbmFnZXInXHJcbiAgICBdKTtcclxuXHJcbn0pKCk7IiwiKGZ1bmN0aW9uIChhbmd1bGFyLCAkKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2ZpbGUubWFuYWdlcicpXHJcbiAgICAgICAgLnJ1bihSdW4pO1xyXG4gICAgUnVuLiRpbmplY3QgPSBbXHJcbiAgICAgICAgJyRyb290U2NvcGUnXHJcbiAgICBdO1xyXG5cclxuICAgIGZ1bmN0aW9uIFJ1bigkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgdmFyICRzZXR0aW5ncyA9ICQoJyNzZXR0aW5ncycpO1xyXG5cclxuICAgICAgICAkcm9vdFNjb3BlLmZpcmVCcm9hZGNhc3QgPSBmdW5jdGlvbiAoZXZlbnROYW1lLCBhcmdzKSB7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuJGJyb2FkY2FzdChldmVudE5hbWUsIGFyZ3MpO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRyb290U2NvcGUuYmFzZVVybCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzZXR0aW5ncy5kYXRhKCdiYXNlLXVybCcpO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcbn0pKGFuZ3VsYXIsIGpRdWVyeSk7IiwiKGZ1bmN0aW9uIChhbmd1bGFyLCAkKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2ZpbGUubWFuYWdlcicpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0Jhc2VDb250cm9sbGVyJywgQmFzZUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIEJhc2VDb250cm9sbGVyLiRpbmplY3QgPSBbXHJcbiAgICAgICAgJyRsb2cnLCAnJHNjb3BlJywgJyRjb29raWVzJywgJ05vdGlmaWNhdGlvbicsICdEaXJTZXJ2aWNlJywgJ0RpcidcclxuICAgIF07XHJcblxyXG4gICAgZnVuY3Rpb24gQmFzZUNvbnRyb2xsZXIoJGxvZywgJHNjb3BlLCAkY29va2llcywgTm90aWZpY2F0aW9uLCBEaXJTZXJ2aWNlLCBEaXIpIHtcclxuICAgICAgICAkbG9nLmxvZygnQmFzZUNvbnRyb2xsZXIgY29udHJvbGxlciA8LSBzdGFydGVkJyk7XHJcblxyXG4gICAgICAgIGFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuaXNEaXIgPSBpc0RpcjtcclxuICAgICAgICAgICAgJHNjb3BlLmlzRGlyVXAgPSBpc0RpclVwO1xyXG5cclxuICAgICAgICAgICAgLy8gb25seSBmb3Igc3ViY29udHJvbGxlciB1c2FnZVxyXG4gICAgICAgICAgICAkc2NvcGUuX2Vycm9yID0gX2Vycm9yO1xyXG4gICAgICAgICAgICAkc2NvcGUuX3dhcm5pbmcgPSBfd2FybmluZztcclxuICAgICAgICAgICAgJHNjb3BlLl9zdWNjZXNzID0gX3N1Y2Nlc3M7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUubWFuYWdlciA9IHtcclxuICAgICAgICAgICAgICAgIHBhdGg6ICcvJ1xyXG4gICAgICAgICAgICB9O1xyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogYWRkIGNhY2hpbmcgYW5kIGxvYWQgbGFzdCBvcGVuZWQgZGlyIGZvciAkc2NvcGUuZm9sZGVyLml0ZW1zXHJcbiAgICAgICAgICAgIERpci5xdWVyeShvbkluaXRpYWxEaXJMb2FkZWQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2hlY2sgaXMgcGFzc2VkIGl0ZW0gaXMgZm9sZGVyXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gaXRlbVxyXG4gICAgICAgICAqIEByZXR1cm5zIHsqfGJvb2xlYW59XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gaXNEaXIoaXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbSAmJiBhbmd1bGFyLmlzRGVmaW5lZChpdGVtLnR5cGUpICYmIGl0ZW0udHlwZSA9PT0gJ2Rpcic7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDaGVjayBpcyBwYXNzZWQgaXRlbSBpcyBkaXIgdG8gZ28gdXBcclxuICAgICAgICAgKiBAcGFyYW0gaXRlbVxyXG4gICAgICAgICAqIEByZXR1cm5zIHsqfGJvb2xlYW58Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBpc0RpclVwKGl0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlzRGlyKGl0ZW0pICYmIGl0ZW0ubmFtZSA9PSAnLi4nO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gX19yZXNvbHZlTWVzc2FnZShyZXNwb25zZSkge1xyXG4gICAgICAgICAgICB2YXIgbm90aWZpY2F0aW9uID0gZmFsc2U7XHJcblxyXG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQocmVzcG9uc2Uubm90aWZpY2F0aW9uKSlcclxuICAgICAgICAgICAgICAgIG5vdGlmaWNhdGlvbiA9IHJlc3BvbnNlLm5vdGlmaWNhdGlvbjtcclxuXHJcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChyZXNwb25zZS5kYXRhKSAmJiBhbmd1bGFyLmlzRGVmaW5lZChyZXNwb25zZS5kYXRhLm5vdGlmaWNhdGlvbikpXHJcbiAgICAgICAgICAgICAgICBub3RpZmljYXRpb24gPSByZXNwb25zZS5kYXRhLm5vdGlmaWNhdGlvbjtcclxuXHJcbiAgICAgICAgICAgIGlmIChub3RpZmljYXRpb24pXHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge2hhc01lc3NhZ2U6IHRydWUsIG1lc3NhZ2U6IG5vdGlmaWNhdGlvbn07XHJcblxyXG4gICAgICAgICAgICAkbG9nLmVycm9yKCdDYW50IGdldCB1c2VyIGZyaWVuZGx5IG1lc3NhZ2UgZnJvbSByZXNwb25zZScsIHtyZXNwb25zZTogcmVzcG9uc2V9KTtcclxuICAgICAgICAgICAgcmV0dXJuIHtoYXNNZXNzYWdlOiBmYWxzZX07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBfZXJyb3IocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZpcmVCcm9hZGNhc3QoJ19lcnJvcicpO1xyXG4gICAgICAgICAgICB2YXIgaGFuZGxlciA9IF9fcmVzb2x2ZU1lc3NhZ2UocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICBpZiAoaGFuZGxlci5oYXNNZXNzYWdlKVxyXG4gICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uLmVycm9yKHttZXNzYWdlOiBoYW5kbGVyLm1lc3NhZ2V9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIF93YXJuaW5nKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5maXJlQnJvYWRjYXN0KCdfd2FybmluZycpO1xyXG4gICAgICAgICAgICB2YXIgaGFuZGxlciA9IF9fcmVzb2x2ZU1lc3NhZ2UocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICBpZiAoaGFuZGxlci5oYXNNZXNzYWdlKVxyXG4gICAgICAgICAgICAgICAgTm90aWZpY2F0aW9uLmVycm9yKHttZXNzYWdlOiBoYW5kbGVyLm1lc3NhZ2V9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIF9zdWNjZXNzKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIHZhciBoYW5kbGVyID0gX19yZXNvbHZlTWVzc2FnZShyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIGlmIChoYW5kbGVyLmhhc01lc3NhZ2UpXHJcbiAgICAgICAgICAgICAgICBOb3RpZmljYXRpb24uc3VjY2Vzcyh7bWVzc2FnZTogaGFuZGxlci5tZXNzYWdlfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBJbml0aWFsIGRpciBsb2FkIGZvciBmb2xkZXIgYW5kIHRyZWVcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSByZXNwb25zZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIG9uSW5pdGlhbERpckxvYWRlZChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnQmFzZUNvbnRyb2xsZXIgLT4gb25Jbml0aWFsRGlyTG9hZGVkJywge3Jlc3BvbnNlOiByZXNwb25zZX0pO1xyXG5cclxuICAgICAgICAgICAgRGlyU2VydmljZS5leHRlbmQocmVzcG9uc2UpO1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLmZpcmVCcm9hZGNhc3QoJ3RyZWUtY2hhbmdlZCcsIHJlc3BvbnNlLmRpcnMoKSk7XHJcbiAgICAgICAgICAgICRzY29wZS5maXJlQnJvYWRjYXN0KCdmb2xkZXItY2hhbmdlZCcsIHJlc3BvbnNlLml0ZW1zKCkpO1xyXG5cclxuICAgICAgICAgICAgJGxvZy5sb2coJ0ZvbGRlckNhY2hlJywge3BhdGg6ICRjb29raWVzLmdldCgncGF0aCcpfSk7XHJcbiAgICAgICAgICAgIGlmICghKCRjb29raWVzLmdldCgncGF0aCcpID09PSAnLycgfHwgdHlwZW9mICRjb29raWVzLmdldCgncGF0aCcpID09PSAndW5kZWZpbmVkJykpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5maXJlQnJvYWRjYXN0KCdjaGFuZ2UtZm9sZGVyJywge3BhdGg6ICRjb29raWVzLmdldCgncGF0aCcpfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKGFuZ3VsYXIsIGpRdWVyeSk7IiwiKGZ1bmN0aW9uIChhbmd1bGFyLCAkKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2ZpbGUubWFuYWdlcicpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0ZvbGRlckNvbnRyb2xsZXInLCBGb2xkZXJDb250cm9sbGVyKTtcclxuXHJcbiAgICBGb2xkZXJDb250cm9sbGVyLiRpbmplY3QgPSBbXHJcbiAgICAgICAgJyRsb2cnLCAnJHNjb3BlJywgJyRjb29raWVzJywgJ2ZvY3VzJywgJ0RpcicsICdEaXJTZXJ2aWNlJywgJ1NldHRpbmdzJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBGb2xkZXJDb250cm9sbGVyKCRsb2csICRzY29wZSwgJGNvb2tpZXMsIGZvY3VzLCBEaXIsIERpclNlcnZpY2UsIFNldHRpbmdzKSB7XHJcbiAgICAgICAgJGxvZy5sb2coJ0ZvbGRlckNvbnRyb2xsZXIgY29udHJvbGxlciA8LSBzdGFydGVkJyk7XHJcblxyXG4gICAgICAgIGFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyID0ge1xyXG4gICAgICAgICAgICAgICAgbG9hZGluZzogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGNyZWF0aW5nOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgIG5hbWU6ICcnLFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IFtdLFxyXG4gICAgICAgICAgICAgICAgZmlsdGVyczoge1xyXG4gICAgICAgICAgICAgICAgICAgIGltYWdlOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIG1lZGlhOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGRvY3VtZW50OiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpbGU6IHRydWVcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBvcmRlcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmM6IG9yZGVyLFxyXG4gICAgICAgICAgICAgICAgICAgIGNoYW5nZTogY2hhbmdlT3JkZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgYnk6ICduYW1lJyxcclxuICAgICAgICAgICAgICAgICAgICByZXZlcnNlOiBmYWxzZSxcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgICAgIHNpemU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGRhdGU6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZW5hYmxlQ3JlYXRlOiBlbmFibGVDcmVhdGUsXHJcbiAgICAgICAgICAgICAgICBjcmVhdGU6IGNyZWF0ZSxcclxuICAgICAgICAgICAgICAgIHJlZnJlc2g6IHJlZnJlc2gsXHJcbiAgICAgICAgICAgICAgICBpc0ZpbHRlcnNFbmFibGVkOiBpc0ZpbHRlcnNFbmFibGVkXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICRzY29wZS5mb2xkZXJGaWx0ZXIgPSBmb2xkZXJGaWx0ZXI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBfX2NhbkxvYWQoKSB7XHJcbiAgICAgICAgICAgIC8vIGRvIG5vdGhpbmcgaWYgZm9sZGVyIHN0aWxsIGxvYWRpbmdcclxuICAgICAgICAgICAgaWYgKCRzY29wZS5mb2xkZXIubG9hZGluZykge1xyXG4gICAgICAgICAgICAgICAgJGxvZy53YXJuKCdGb2xkZXJDb250cm9sbGVyIC0+IGxvYWRpbmcnLCAnUHJldmlvdXMgaXRlbSBzdGlsbCBsb2FkaW5nJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdfZXJyb3InLCBvbkVycm9ySGFuZGxlZCk7XHJcbiAgICAgICAgJHNjb3BlLiRvbignX3dhcm5pbmcnLCBvbkVycm9ySGFuZGxlZCk7XHJcbiAgICAgICAgZnVuY3Rpb24gb25FcnJvckhhbmRsZWQoZXZlbnQpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdjaGFuZ2UtZm9sZGVyJywgY2hhbmdlRm9sZGVyKTtcclxuICAgICAgICBmdW5jdGlvbiBjaGFuZ2VGb2xkZXIoZXZlbnQsIGZvbGRlcikge1xyXG4gICAgICAgICAgICBpZiAoIV9fY2FuTG9hZCgpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgJGxvZy5sb2coJ0ZvbGRlckNvbnRyb2xsZXIgLT4gY2hhbmdlRm9sZGVyJywge2V2ZW50OiBldmVudCwgZm9sZGVyOiBmb2xkZXJ9KTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5sb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgRGlyLnF1ZXJ5KHtwYXRoOiBmb2xkZXIucGF0aCB8fCAnLyd9LCBmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLl9zdWNjZXNzKHIpO1xyXG4gICAgICAgICAgICAgICAgb25Gb2xkZXJDaGFuZ2VkKHIsIGZvbGRlcik7XHJcbiAgICAgICAgICAgIH0sICRzY29wZS5fZXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignZm9sZGVyLWNoYW5nZWQnLCBvbkZvbGRlckV4dGVybmFsbHlDaGFuZ2VkKTtcclxuICAgICAgICBmdW5jdGlvbiBvbkZvbGRlckV4dGVybmFsbHlDaGFuZ2VkKGV2ZW50LCBpdGVtcykge1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnRm9sZGVyQ29udHJvbGxlciAtPiBvbkZvbGRlckV4dGVybmFsbHlDaGFuZ2VkJywge2V2ZW50OiBldmVudCwgaXRlbXM6IGl0ZW1zfSk7XHJcbiAgICAgICAgICAgICRzY29wZS5mb2xkZXIubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLml0ZW1zID0gaXRlbXM7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdmaWxlLXVwbG9hZGVkJywgYWRkTmV3RmlsZSk7XHJcbiAgICAgICAgZnVuY3Rpb24gYWRkTmV3RmlsZShldmVudCwgZmlsZSkge1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnRm9sZGVyQ29udHJvbGxlciAtPiBhZGROZXdGaWxlJywge2V2ZW50OiBldmVudCwgZmlsZTogZmlsZX0pO1xyXG4gICAgICAgICAgICBEaXJTZXJ2aWNlLmV4dGVuZEl0ZW0oZmlsZSwgJHNjb3BlLmZvbGRlci5pdGVtcy5sZW5ndGgpO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLml0ZW1zLnVuc2hpZnQoZmlsZSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdmb2xkZXItZGVsZXRlZCcsIHJlbW92ZUJ5UGF0aCk7XHJcbiAgICAgICAgJHNjb3BlLiRvbignZmlsZS1kZWxldGVkJywgcmVtb3ZlQnlQYXRoKTtcclxuICAgICAgICBmdW5jdGlvbiByZW1vdmVCeVBhdGgoZXZlbnQsIGl0ZW0pIHtcclxuICAgICAgICAgICAgJGxvZy5sb2coJ0ZvbGRlckNvbnRyb2xsZXIgLT4gcmVtb3ZlQnlQYXRoJywge2V2ZW50OiBldmVudCwgaXRlbTogaXRlbSwgaXRlbXM6ICRzY29wZS5mb2xkZXIuaXRlbXN9KTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5pdGVtcy5yZW1vdmVJdGVtKGl0ZW0ucGF0aCwgJ3BhdGgnKTtcclxuICAgICAgICAgICAgLy9yZW1vdmVGcm9tQXJyKCRzY29wZS5mb2xkZXIuaXRlbXMsICk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBGaWx0ZXJzIGZvbGRlciBpdGVtc1xyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHZhbHVlXHJcbiAgICAgICAgICogQHBhcmFtIGluZGV4XHJcbiAgICAgICAgICogQHBhcmFtIGFycmF5XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZm9sZGVyRmlsdGVyKHZhbHVlLCBpbmRleCwgYXJyYXkpIHtcclxuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuaXNEZWZpbmVkKHZhbHVlLnR5cGUpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodmFsdWUudHlwZSA9PSAnZGlyJylcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAoaXNGaWx0ZXJzRW5hYmxlZCgpKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2NvcGUuZm9sZGVyLmZpbHRlcnNbdmFsdWUudHlwZV07XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKFNldHRpbmdzLmdldFR5cGUoKSA9PSB2YWx1ZS50eXBlKVxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvcmRlcihpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmIChpdGVtLnR5cGUgPT09ICdkaXInKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5uYW1lID09ICcuLicpXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDAgKyAnICcgKyBpdGVtWyRzY29wZS5mb2xkZXIub3JkZXIuYnldO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gJ3onICsgaXRlbVskc2NvcGUuZm9sZGVyLm9yZGVyLmJ5XTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNoYW5nZU9yZGVyKG5ld05hbWUpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5vcmRlci5ieSA9IG5ld05hbWU7XHJcbiAgICAgICAgICAgIHZhciBvcHRpb25zID0gWyduYW1lJywgJ3NpemUnLCAnZGF0ZSddO1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpIGluIG9wdGlvbnMpIHtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmhhc093blByb3BlcnR5KGkpKVxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5mb2xkZXIub3JkZXJbb3B0aW9uc1tpXV0gPSBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLm9yZGVyW25ld05hbWVdID0gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGlzRmlsdGVyc0VuYWJsZWQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBTZXR0aW5ncy5nZXRUeXBlKCkgPT0gJ2ZpbGUnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVmcmVzaCgpIHtcclxuICAgICAgICAgICAgaWYgKCFfX2NhbkxvYWQoKSlcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgJGxvZy5sb2coJ0ZvbGRlckNvbnRyb2xsZXIgLT4gcmVmcmVzaCcsIHttYW5hZ2VyOiAkc2NvcGUubWFuYWdlcn0pO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAkc2NvcGUubWFuYWdlci5wYXRoID0gJHNjb3BlLm1hbmFnZXIucGF0aC5yZXBsYWNlKC9eXFwvfFxcLyQvZywgJycpO1xyXG4gICAgICAgICAgICBEaXIucXVlcnkoe3BhdGg6ICRzY29wZS5tYW5hZ2VyLnBhdGggfHwgJy8nfSwgZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIG9uRm9sZGVyQ2hhbmdlZChyLCAkc2NvcGUubWFuYWdlcik7XHJcbiAgICAgICAgICAgIH0sICRzY29wZS5fZXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2FsbGJhY2sgZm9yIGZvbGRlciBkYXRhIGxvYWQgY29tcGxldGlvblxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHJlc3BvbnNlXHJcbiAgICAgICAgICogQHBhcmFtIGZvbGRlclxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIG9uRm9sZGVyQ2hhbmdlZChyZXNwb25zZSwgZm9sZGVyKSB7XHJcbiAgICAgICAgICAgICRsb2cubG9nKCdGb2xkZXJDb250cm9sbGVyIC0+IGNoYW5nZUZvbGRlciAtPiBvbkZvbGRlckNoYW5nZWQnLFxyXG4gICAgICAgICAgICAgICAge3Jlc3BvbnNlOiByZXNwb25zZSwgZm9sZGVyOiBmb2xkZXJ9KTtcclxuICAgICAgICAgICAgRGlyU2VydmljZS5leHRlbmQocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLml0ZW1zID0gcmVzcG9uc2UuaXRlbXMoKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5tYW5hZ2VyLnBhdGggPSAnLycgKyAoZm9sZGVyLnBhdGggfHwgJycpO1xyXG4gICAgICAgICAgICAkY29va2llcy5wdXQoJ3BhdGgnLCAoZm9sZGVyLnBhdGggfHwgJycpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGVuYWJsZUNyZWF0ZSgpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5jcmVhdGluZyA9IHRydWU7XHJcbiAgICAgICAgICAgIGZvY3VzKCcjY3JlYXRlLWRpci1pbnB1dCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlKCkge1xyXG4gICAgICAgICAgICBpZiAoIV9fY2FuTG9hZCgpKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmZvbGRlci5uYW1lICYmICRzY29wZS5mb2xkZXIubmFtZSAhPT0gJycpXHJcbiAgICAgICAgICAgICAgICBEaXJTZXJ2aWNlLmNyZWF0ZSgkc2NvcGUubWFuYWdlci5wYXRoLCAkc2NvcGUuZm9sZGVyLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgb25Gb2xkZXJDcmVhdGVkLCAkc2NvcGUuX2Vycm9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIG9uRm9sZGVyQ3JlYXRlZChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnRm9sZGVyQ29udHJvbGxlciAtPiBjcmVhdGUgLT4gb25Gb2xkZXJDcmVhdGVkJywge3Jlc3BvbnNlOiByZXNwb25zZX0pO1xyXG5cclxuICAgICAgICAgICAgJHNjb3BlLl9zdWNjZXNzKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5jcmVhdGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLm5hbWUgPSAnJztcclxuICAgICAgICAgICAgdmFyIGZvbGRlciA9IHJlc3BvbnNlLmRhdGE7XHJcbiAgICAgICAgICAgIERpclNlcnZpY2UuZXh0ZW5kSXRlbShmb2xkZXIsICRzY29wZS5mb2xkZXIuaXRlbXMubGVuZ3RoKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5pdGVtcy51bnNoaWZ0KGZvbGRlcik7XHJcbiAgICAgICAgICAgICRzY29wZS5maXJlQnJvYWRjYXN0KCdmb2xkZXItY3JlYXRlZCcsIGZvbGRlcik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KShhbmd1bGFyLCBqUXVlcnkpOyIsIihmdW5jdGlvbiAoYW5ndWxhciwgJCwgdG9wLCB3LCBPKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2ZpbGUubWFuYWdlcicpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0ZvbGRlckl0ZW1Db250cm9sbGVyJywgRm9sZGVySXRlbUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIEZvbGRlckl0ZW1Db250cm9sbGVyLiRpbmplY3QgPSBbXHJcbiAgICAgICAgJyRsb2cnLCAnJHNjb3BlJywgJ2ZvY3VzJywgJ0RpclNlcnZpY2UnLCAnRmlsZVNlcnZpY2UnLCAnU2V0dGluZ3MnXHJcbiAgICBdO1xyXG5cclxuICAgIGZ1bmN0aW9uIEZvbGRlckl0ZW1Db250cm9sbGVyKCRsb2csICRzY29wZSwgZm9jdXMsIERpclNlcnZpY2UsIEZpbGVTZXJ2aWNlLCBTZXR0aW5ncykge1xyXG4gICAgICAgICRsb2cubG9nKCdGb2xkZXJJdGVtQ29udHJvbGxlciBjb250cm9sbGVyIDwtIHN0YXJ0ZWQnKTtcclxuXHJcbiAgICAgICAgYWN0aXZhdGUoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jbGljayA9IGNsaWNrO1xyXG4gICAgICAgICAgICAkc2NvcGUuY2FuUmVuYW1lID0gY2FuUmVuYW1lO1xyXG4gICAgICAgICAgICAkc2NvcGUuZW5hYmxlUmVuYW1lID0gZW5hYmxlUmVuYW1lO1xyXG4gICAgICAgICAgICAkc2NvcGUuZGlzYWJsZVJlbmFtZSA9IGRpc2FibGVSZW5hbWU7XHJcbiAgICAgICAgICAgICRzY29wZS5yZW5hbWUgPSByZW5hbWU7XHJcbiAgICAgICAgICAgICRzY29wZS5zZWxlY3QgPSBzZWxlY3Q7XHJcbiAgICAgICAgICAgICRzY29wZS5oYXNUaHVtYnMgPSBoYXNUaHVtYnM7XHJcbiAgICAgICAgICAgICRzY29wZS50aHVtYk5hbWUgPSB0aHVtYk5hbWU7XHJcbiAgICAgICAgICAgICRzY29wZVsnZGVsZXRlJ10gPSBkZWxldGVJdGVtO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRGV0ZXJtaW5lcyBpdGVtIHR5cGUgYW5kIGRvZXMgYWN0aW9uIGZvciB0aGF0XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gY2xpY2soaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmZvbGRlci5sb2FkaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBUT0RPOiBhZGQgd2FybmluZyBhYm91dCBsb2FkaW5nXHJcbiAgICAgICAgICAgICAgICAkbG9nLndhcm4oJ0ZvbGRlckl0ZW1Db250cm9sbGVyIC0+IGNsaWNrJywgJ1ByZXZpb3VzIGl0ZW0gc3RpbGwgbG9hZGluZycpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkbG9nLmxvZygnRm9sZGVySXRlbUNvbnRyb2xsZXIgLT4gY2xpY2snLCB7aXRlbTogaXRlbX0pO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRzY29wZS5pc0RpcihpdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZpcmVCcm9hZGNhc3QoJ2NoYW5nZS1mb2xkZXInLCBpdGVtKTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgc2VsZWN0KGl0ZW0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2FuUmVuYW1lKGl0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuICEkc2NvcGUuaXNEaXJVcChpdGVtKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIE9uIHJlbmFtZSBpdGVtXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZW5hYmxlUmVuYW1lKGl0ZW0pIHtcclxuICAgICAgICAgICAgaXRlbS5yZW5hbWUgPSB0cnVlO1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmlzRGlyKGl0ZW0pKSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLm5ld05hbWUgPSBpdGVtLm5hbWU7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmV4dCA9IGl0ZW0ubmFtZS5zcGxpdCgnLicpLnBvcCgpO1xyXG4gICAgICAgICAgICAgICAgdmFyIGN1dCA9IDA7XHJcbiAgICAgICAgICAgICAgICBpZiAoaXRlbS5leHQubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgIGN1dCA9IGl0ZW0uZXh0Lmxlbmd0aCArIDE7XHJcblxyXG4gICAgICAgICAgICAgICAgaXRlbS5uZXdOYW1lID0gaXRlbS5uYW1lLnN1YnN0cmluZygwLCBpdGVtLm5hbWUubGVuZ3RoIC0gY3V0KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBmb2N1cygnIycgKyBpdGVtLmlkICsgJyBpbnB1dCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVuYW1lKCkge1xyXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmlzRGlyKCRzY29wZS5pdGVtKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCRzY29wZS5pdGVtLm5hbWUgIT0gJy4uJylcclxuICAgICAgICAgICAgICAgICAgICBEaXJTZXJ2aWNlLnJlbmFtZSgkc2NvcGUubWFuYWdlci5wYXRoLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuaXRlbS5uYW1lLCAkc2NvcGUuaXRlbS5uZXdOYW1lLCBvbkZvbGRlclJlbmFtZWQsICRzY29wZS5fZXJyb3IpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBGaWxlU2VydmljZS5yZW5hbWUoJHNjb3BlLm1hbmFnZXIucGF0aCxcclxuICAgICAgICAgICAgICAgICRzY29wZS5pdGVtLm5hbWUsIGdldEl0ZW1OZXdOYW1lKCRzY29wZS5pdGVtKSwgb25GaWxlUmVuYW1lZCwgJHNjb3BlLl9lcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRJdGVtTmV3TmFtZShpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmIChhbmd1bGFyLmlzRGVmaW5lZChpdGVtLmV4dCkgJiYgaXRlbS5leHQubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ubmV3TmFtZSArICcuJyArIGl0ZW0uZXh0O1xyXG4gICAgICAgICAgICByZXR1cm4gaXRlbS5uZXdOYW1lO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZGlzYWJsZVJlbmFtZShpdGVtKSB7XHJcbiAgICAgICAgICAgIGl0ZW0ucmVuYW1lID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvbkZvbGRlclJlbmFtZWQocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJGxvZy5sb2coJ0ZvbGRlckl0ZW1Db250cm9sbGVyIC0+IG9uRm9sZGVyUmVuYW1lZCcsIHtyZXNwb25zZTogcmVzcG9uc2UsIGl0ZW06ICRzY29wZS5pdGVtfSk7XHJcbiAgICAgICAgICAgICRzY29wZS5fc3VjY2VzcyhyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIHZhciBjb3B5ID0gYW5ndWxhci5jb3B5KCRzY29wZS5pdGVtKTtcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW0ucmVuYW1lID0gZmFsc2U7XHJcbiAgICAgICAgICAgIC8vIFRPRE86IGNyZWF0ZSBpdGVtIGF1dG9tYXBwZXJcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW0ucGF0aCA9IHJlc3BvbnNlLmRhdGEucGF0aDtcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW0ubmFtZSA9IHJlc3BvbnNlLmRhdGEubmFtZTtcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW0udXJsID0gcmVzcG9uc2UuZGF0YS51cmw7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuZmlyZUJyb2FkY2FzdCgnZm9sZGVyLXJlbmFtZWQnLCB7J25ldyc6IHJlc3BvbnNlLmRhdGEsIG9sZDogY29weX0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gb25GaWxlUmVuYW1lZChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnRm9sZGVySXRlbUNvbnRyb2xsZXIgLT4gb25GaWxlUmVuYW1lZCcsIHtyZXNwb25zZTogcmVzcG9uc2V9KTtcclxuICAgICAgICAgICAgJHNjb3BlLl9zdWNjZXNzKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgJHNjb3BlLml0ZW0ucmVuYW1lID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRzY29wZS5pdGVtLm5hbWUgPSByZXNwb25zZS5kYXRhLm5hbWU7XHJcbiAgICAgICAgICAgICRzY29wZS5pdGVtLnVybCA9IHJlc3BvbnNlLmRhdGEudXJsO1xyXG4gICAgICAgICAgICAkc2NvcGUuaXRlbS50aHVtYnMgPSByZXNwb25zZS5kYXRhLnRodW1icztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNlbGVjdChpdGVtLCB0aHVtYkluZGV4KSB7XHJcbiAgICAgICAgICAgIHZhciBmaWxlX3VybCA9IGl0ZW0udXJsO1xyXG4gICAgICAgICAgICBpZiAoISF0aHVtYkluZGV4KSB7XHJcbiAgICAgICAgICAgICAgICBmaWxlX3VybCA9IGl0ZW0udGh1bWJzW3RodW1iSW5kZXhdO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyBpZiBzZWxlY3QgZm9yIHRpbnlNQ0VcclxuICAgICAgICAgICAgaWYgKFNldHRpbmdzLmlzVGFyZ2V0KCd0aW55TUNFJykpIHtcclxuICAgICAgICAgICAgICAgICRsb2cuaW5mbygnRm9sZGVySXRlbUNvbnRyb2xsZXIgLT4gc2VsZWN0IC0+IHRpbnltY2UnLCB7dGlueW1jZTogdG9wLnRpbnltY2V9KTtcclxuICAgICAgICAgICAgICAgIGlmICh0b3AudGlueW1jZS5tYWpvclZlcnNpb24gPCA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wLnRpbnltY2UuYWN0aXZlRWRpdG9yLndpbmRvd01hbmFnZXIucGFyYW1zLnNldFVybChmaWxlX3VybCk7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGVkaXRvcl9pZCA9IHRvcC50aW55bWNlLmFjdGl2ZUVkaXRvci53aW5kb3dNYW5hZ2VyLnBhcmFtcy5tY2Vfd2luZG93X2lkO1xyXG4gICAgICAgICAgICAgICAgICAgIHRvcC50aW55bWNlLmFjdGl2ZUVkaXRvci53aW5kb3dNYW5hZ2VyLmNsb3NlKGVkaXRvcl9pZCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAkbG9nLmluZm8oJ0ZvbGRlckl0ZW1Db250cm9sbGVyIC0+IHNlbGVjdCAtPiB0aW55bWNlNCcsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtwYXJhbXM6IHRvcC50aW55bWNlLmFjdGl2ZUVkaXRvci53aW5kb3dNYW5hZ2VyLmdldFBhcmFtcygpfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgdG9wLnRpbnltY2UuYWN0aXZlRWRpdG9yLndpbmRvd01hbmFnZXIuZ2V0UGFyYW1zKCkuc2V0VXJsKGZpbGVfdXJsKTtcclxuICAgICAgICAgICAgICAgICAgICB0b3AudGlueW1jZS5hY3RpdmVFZGl0b3Iud2luZG93TWFuYWdlci5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoU2V0dGluZ3MuaXNUYXJnZXQoJ2NhbGxiYWNrJykpIHtcclxuICAgICAgICAgICAgICAgIHZhciBmaWxlbWFuYWdlciA9IHcuZmlsZW1hbmFnZXIgfHwgdy5wYXJlbnQuZmlsZW1hbmFnZXIgfHwge307XHJcblxyXG4gICAgICAgICAgICAgICAgaWYoZmlsZW1hbmFnZXIgJiYgZmlsZW1hbmFnZXIub25TZWxlY3RlZCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGZpbGVtYW5hZ2VyLm9uU2VsZWN0ZWQoZmlsZV91cmwsIFNldHRpbmdzLmdldFBhcmFtcygpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlSXRlbShpdGVtKSB7XHJcbiAgICAgICAgICAgIGlmICgkc2NvcGUuaXNEaXIoaXRlbSkpIHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLm5hbWUgIT0gJy4uJylcclxuICAgICAgICAgICAgICAgICAgICBEaXJTZXJ2aWNlLmRlbGV0ZSgkc2NvcGUubWFuYWdlci5wYXRoLCBpdGVtLm5hbWUsIG9uRm9sZGVyRGVsZXRlZCwgJHNjb3BlLl9lcnJvcik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgRmlsZVNlcnZpY2UuZGVsZXRlKCRzY29wZS5tYW5hZ2VyLnBhdGgsIGl0ZW0ubmFtZSwgb25GaWxlRGVsZXRlZCwgJHNjb3BlLl9lcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvbkZvbGRlckRlbGV0ZWQocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgJGxvZy5sb2coJ0ZvbGRlckl0ZW1Db250cm9sbGVyIC0+IG9uRm9sZGVyRGVsZXRlZCcsIHtyZXNwb25zZTogcmVzcG9uc2V9KTtcclxuICAgICAgICAgICAgJHNjb3BlLl9zdWNjZXNzKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZpcmVCcm9hZGNhc3QoJ2ZvbGRlci1kZWxldGVkJywgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvbkZpbGVEZWxldGVkKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICRsb2cubG9nKCdGb2xkZXJJdGVtQ29udHJvbGxlciAtPiBvbkZpbGVEZWxldGVkJywge3Jlc3BvbnNlOiByZXNwb25zZX0pO1xyXG4gICAgICAgICAgICAkc2NvcGUuX3N1Y2Nlc3MocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAkc2NvcGUuZmlyZUJyb2FkY2FzdCgnZmlsZS1kZWxldGVkJywgcmVzcG9uc2UuZGF0YSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBoYXNUaHVtYnMoaXRlbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gISFpdGVtICYmIGFuZ3VsYXIuaXNEZWZpbmVkKGl0ZW0udGh1bWJzKSAmJiBPLmtleXMoaXRlbS50aHVtYnMpLmxlbmd0aCA+IDE7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiB0aHVtYk5hbWUodGh1bWJJbmRleCwgd2lkdGgsIGhlaWdodCkge1xyXG4gICAgICAgICAgICBpZiAodGh1bWJJbmRleCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHNpemUgPSBTZXR0aW5ncy5nZXRUaHVtYlNpemUodGh1bWJJbmRleCk7XHJcbiAgICAgICAgICAgICAgICB3aWR0aCA9IHNpemVbMF07XHJcbiAgICAgICAgICAgICAgICBoZWlnaHQgPSBzaXplWzFdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHZhciB0ZW1wbGF0ZSA9ICcoe3dpZHRofSB4IHtoZWlnaHR9KScsXHJcbiAgICAgICAgICAgICAgICBwYXJhbXMgPSB7d2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodH07XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGVtcGxhdGUuc3VwcGxhbnQocGFyYW1zKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKGFuZ3VsYXIsIGpRdWVyeSwgdG9wLCB3aW5kb3csIE9iamVjdCk7IiwiKGZ1bmN0aW9uIChhbmd1bGFyLCAkKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2ZpbGUubWFuYWdlcicpXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1RyZWVDb250cm9sbGVyJywgVHJlZUNvbnRyb2xsZXIpO1xyXG5cclxuICAgIFRyZWVDb250cm9sbGVyLiRpbmplY3QgPSBbXHJcbiAgICAgICAgJyRsb2cnLCAnJHNjb3BlJywgJ0RpcicsICdEaXJTZXJ2aWNlJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBUcmVlQ29udHJvbGxlcigkbG9nLCAkc2NvcGUsIERpciwgRGlyU2VydmljZSkge1xyXG4gICAgICAgICRsb2cubG9nKCdUcmVlQ29udHJvbGxlciBjb250cm9sbGVyIDwtIHN0YXJ0ZWQnKTtcclxuXHJcbiAgICAgICAgYWN0aXZhdGUoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5pc09wZW4gPSBpc09wZW47XHJcbiAgICAgICAgICAgICRzY29wZS5pc0VtcHR5ID0gaXNFbXB0eTtcclxuICAgICAgICAgICAgJHNjb3BlLmNoYW5nZUZvbGRlciA9IGNoYW5nZUZvbGRlcjtcclxuXHJcbiAgICAgICAgICAgICRzY29wZS50cmVlID0ge1xyXG4gICAgICAgICAgICAgICAgbG9hZGluZzogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBbXSxcclxuICAgICAgICAgICAgICAgIHJvb3Q6IHtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lOiAnLycsIC8vIFRPRE86IGdldCB0cmFuc2xhdGlvbiBmb3IgdGhpcyB0ZXh0XHJcbiAgICAgICAgICAgICAgICAgICAgdXJsOiAkc2NvcGUuYmFzZVVybCArICdkaXInXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZXhwYW5kOiBleHBhbmRcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIFRPRE86IGFkZCB0cmVlIHJlZnJlc2hcclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignX2Vycm9yJywgb25FcnJvckhhbmRsZWQpO1xyXG4gICAgICAgICRzY29wZS4kb24oJ193YXJuaW5nJywgb25FcnJvckhhbmRsZWQpO1xyXG4gICAgICAgIGZ1bmN0aW9uIG9uRXJyb3JIYW5kbGVkKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICRzY29wZS50cmVlLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ3RyZWUtY2hhbmdlZCcsIHRyZWVDaGFuZ2VkKTtcclxuICAgICAgICBmdW5jdGlvbiB0cmVlQ2hhbmdlZChldmVudCwgdHJlZSkge1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnVHJlZUNvbnRyb2xsZXIgLT4gdHJlZUNoYW5nZWQnLCB7ZXZlbnQ6IGV2ZW50LCB0cmVlOiB0cmVlfSk7XHJcbiAgICAgICAgICAgICRzY29wZS50cmVlLml0ZW1zID0gdHJlZTtcclxuICAgICAgICAgICAgJHNjb3BlLnRyZWUubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJHNjb3BlLiRvbignZm9sZGVyLWNyZWF0ZWQnLCBvbkZvbGRlckNyZWF0ZWQpO1xyXG4gICAgICAgIGZ1bmN0aW9uIG9uRm9sZGVyQ3JlYXRlZChldmVudCwgZm9sZGVyKSB7XHJcbiAgICAgICAgICAgICRsb2cubG9nKCdUcmVlQ29udHJvbGxlciAtPiBvbkZvbGRlckNyZWF0ZWQnLCB7ZXZlbnQ6IGV2ZW50LCBmb2xkZXI6IGZvbGRlcn0pO1xyXG4gICAgICAgICAgICBpZiAoZm9sZGVyLnBhdGguaW5kZXhPZignLycpID09PSAtMSkge1xyXG4gICAgICAgICAgICAgICAgLy8gY3JlYXRlZCBmb2xkZXIgaXMgaW4gcm9vdCwgc28gd2VlIG5lZWQgYWRkIGl0IHRvIHRyZWUgbWVudVxyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRyZWUuaXRlbXMudW5zaGlmdChmb2xkZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkc2NvcGUuJG9uKCdmb2xkZXItcmVuYW1lZCcsIG9uRm9sZGVyUmVuYW1lZCk7XHJcbiAgICAgICAgZnVuY3Rpb24gb25Gb2xkZXJSZW5hbWVkKGV2ZW50LCBmb2xkZXJzKSB7XHJcbiAgICAgICAgICAgIHZhciBvbGRGb2xkZXIgPSBmb2xkZXJzLm9sZCxcclxuICAgICAgICAgICAgICAgIG5ld0ZvbGRlciA9IGZvbGRlcnMubmV3O1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnVHJlZUNvbnRyb2xsZXIgLT4gb25Gb2xkZXJSZW5hbWVkJywge2V2ZW50OiBldmVudCwgbmV3Rm9sZGVyOiBuZXdGb2xkZXIsIG9sZEZvbGRlcjogb2xkRm9sZGVyfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBUT0RPOiByZWN1cnNpdmVseSBjaGVjayBhbGwgY2hpbGQgZm9sZGVyc1xyXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8ICRzY29wZS50cmVlLml0ZW1zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoJHNjb3BlLnRyZWUuaXRlbXNbaV0ucGF0aCA9PSBvbGRGb2xkZXIucGF0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIFRPRE86IGNyZWF0ZSBpdGVtIGF1dG9tYXBwZXJcclxuICAgICAgICAgICAgICAgICAgICAkc2NvcGUudHJlZS5pdGVtc1tpXS5wYXRoID0gbmV3Rm9sZGVyLnBhdGg7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLnRyZWUuaXRlbXNbaV0ubmFtZSA9IG5ld0ZvbGRlci5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS50cmVlLml0ZW1zW2ldLnVybCA9IG5ld0ZvbGRlci51cmw7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS4kb24oJ2ZvbGRlci1kZWxldGVkJywgcmVtb3ZlQnlQYXRoKTtcclxuICAgICAgICBmdW5jdGlvbiByZW1vdmVCeVBhdGgoZXZlbnQsIGl0ZW0pIHtcclxuICAgICAgICAgICAgJGxvZy5sb2coJ1RyZWVDb250cm9sbGVyIC0+IHJlbW92ZUJ5UGF0aCcsIHtldmVudDogZXZlbnQsIGl0ZW06IGl0ZW0sIGl0ZW1zOiAkc2NvcGUudHJlZS5pdGVtc30pO1xyXG5cclxuICAgICAgICAgICAgLy8gVE9ETzogcmVjdXJzaXZlbHkgY2hlY2sgYWxsIGNoaWxkIGZvbGRlcnNcclxuICAgICAgICAgICAgJHNjb3BlLnRyZWUuaXRlbXMucmVtb3ZlSXRlbShpdGVtLnBhdGgsICdwYXRoJyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDaGVjayBpcyBmb2xkZXIgb3BlbiBmb3IgdHJlZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGZvbGRlclxyXG4gICAgICAgICAqIEByZXR1cm5zIHtib29sZWFufVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGlzT3Blbihmb2xkZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZvbGRlciAmJiBhbmd1bGFyLmlzRGVmaW5lZChmb2xkZXIuZm9sZGVycyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBDaGVjayBpcyBmb2xkZXIgaGFzIGFueSBvdGhlciBmb2xkZXJcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSBmb2xkZXJcclxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBpc0VtcHR5KGZvbGRlcikge1xyXG4gICAgICAgICAgICBpZiAoaXNPcGVuKGZvbGRlcikpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZm9sZGVyLmZvbGRlcnMubGVuZ3RoID09IDA7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV4cGFuZChjdXJyRm9sZGVyKSB7XHJcbiAgICAgICAgICAgIC8vIGRvIG5vdGhpbmcgaWYgdHJlZSBzdGlsbCBsb2FkaW5nIG9yIGRvbmB0IGhhdmUgc3ViIGZvbGRlcnNcclxuICAgICAgICAgICAgaWYgKCRzY29wZS50cmVlLmxvYWRpbmcgfHwgaXNFbXB0eShjdXJyRm9sZGVyKSkge1xyXG4gICAgICAgICAgICAgICAgJGxvZy53YXJuKCdUcmVlQ29udHJvbGxlciAtPiBleHBhbmQnLCAnUHJldmlvdXMgaXRlbSBzdGlsbCBsb2FkaW5nJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRsb2cubG9nKCdUcmVlQ29udHJvbGxlciAtPiBleHBhbmQnLCB7Y3VycjogY3VyckZvbGRlcn0pO1xyXG5cclxuICAgICAgICAgICAgLy8gcmVtb3ZlIGFsbCBzdWIgZm9sZGVycyBpZiBpdCBpcyBhbHJlYWR5IG9wZW5lZFxyXG4gICAgICAgICAgICBpZiAoaXNPcGVuKGN1cnJGb2xkZXIpKSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyRm9sZGVyLmZvbGRlcnMgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRzY29wZS50cmVlLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICBEaXIucXVlcnkoe3BhdGg6IGN1cnJGb2xkZXIucGF0aH0sIGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgRGlyU2VydmljZS5leHRlbmQocmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLnRyZWUubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgY3VyckZvbGRlci5mb2xkZXJzID0gcmVzcG9uc2UuZGlycygpO1xyXG4gICAgICAgICAgICB9LCAkc2NvcGUuX2Vycm9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNoYW5nZUZvbGRlcihmb2xkZXIpIHtcclxuICAgICAgICAgICAgJHNjb3BlLmZpcmVCcm9hZGNhc3QoJ2NoYW5nZS1mb2xkZXInLCBmb2xkZXIpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoYW5ndWxhciwgalF1ZXJ5KTsiLCIoZnVuY3Rpb24gKGFuZ3VsYXIsICQpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnZmlsZS5tYW5hZ2VyJylcclxuICAgICAgICAuY29udHJvbGxlcignVXBsb2FkQ29udHJvbGxlcicsIFVwbG9hZENvbnRyb2xsZXIpO1xyXG5cclxuICAgIFVwbG9hZENvbnRyb2xsZXIuJGluamVjdCA9IFtcclxuICAgICAgICAnJGxvZycsICckc2NvcGUnLCAnRmlsZVVwbG9hZGVyJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBVcGxvYWRDb250cm9sbGVyKCRsb2csICRzY29wZSwgRmlsZVVwbG9hZGVyKSB7XHJcbiAgICAgICAgJGxvZy5sb2coJ1VwbG9hZENvbnRyb2xsZXIgY29udHJvbGxlciA8LSBzdGFydGVkJyk7XHJcblxyXG4gICAgICAgIGFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUudXBsb2FkZXIgPSBuZXcgRmlsZVVwbG9hZGVyKHtcclxuICAgICAgICAgICAgICAgIHVybDogX2dldFVwbG9hZFBhdGhcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBfZ2V0VXBsb2FkUGF0aCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzY29wZS5iYXNlVXJsKCkgKyAnZmlsZS91cGxvYWQnICsgJHNjb3BlLm1hbmFnZXIucGF0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRzY29wZS51cGxvYWRlci5vbldoZW5BZGRpbmdGaWxlRmFpbGVkID0gZnVuY3Rpb24gKGl0ZW0gLyp7RmlsZXxGaWxlTGlrZU9iamVjdH0qLywgZmlsdGVyLCBvcHRpb25zKSB7XHJcbiAgICAgICAgICAgICRsb2cuaW5mbygnb25XaGVuQWRkaW5nRmlsZUZhaWxlZCcsIGl0ZW0sIGZpbHRlciwgb3B0aW9ucyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnVwbG9hZGVyLm9uQWZ0ZXJBZGRpbmdGaWxlID0gZnVuY3Rpb24gKGZpbGVJdGVtKSB7XHJcbiAgICAgICAgICAgIC8vIGZpeCB1cmwgdG8gdXBsb2FkIGFzIHdlIGNhbiBjaGFuZ2UgaXQgYXQgYW55IG1vbWVudFxyXG4gICAgICAgICAgICBmaWxlSXRlbS51cGxvYWRlci51cmwgPSBmaWxlSXRlbS51cmwgPSBfZ2V0VXBsb2FkUGF0aCgpO1xyXG4gICAgICAgICAgICAkbG9nLmluZm8oJ29uQWZ0ZXJBZGRpbmdGaWxlJywgZmlsZUl0ZW0pO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRzY29wZS51cGxvYWRlci5vbkVycm9ySXRlbSA9IGZ1bmN0aW9uIChmaWxlSXRlbSwgcmVzcG9uc2UsIHN0YXR1cywgaGVhZGVycykge1xyXG4gICAgICAgICAgICAvLyBUT0RPOiBhZGQgZXJyb3IgaGFuZGxpbmdcclxuICAgICAgICAgICAgJGxvZy5pbmZvKCdvbkVycm9ySXRlbScsIGZpbGVJdGVtLCAvKnJlc3BvbnNlLCovIHN0YXR1cywgaGVhZGVycyk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJHNjb3BlLnVwbG9hZGVyLm9uQ29tcGxldGVJdGVtID0gZnVuY3Rpb24gKGZpbGVJdGVtLCByZXNwb25zZSwgc3RhdHVzLCBoZWFkZXJzKSB7XHJcbiAgICAgICAgICAgIGlmIChzdGF0dXMgPT09IDIwMCkge1xyXG4gICAgICAgICAgICAgICAgJGxvZy5pbmZvKCdVcGxvYWRDb250cm9sbGVyIC0+IHVwbG9hZGVyIC0+IG9uQ29tcGxldGVJdGVtJyxcclxuICAgICAgICAgICAgICAgICAgICB7ZmlsZUl0ZW06IGZpbGVJdGVtLCByZXNwb25zZTogcmVzcG9uc2UsIHN0YXR1czogc3RhdHVzLCBoZWFkZXJzOiBoZWFkZXJzfSk7XHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuZmlyZUJyb2FkY2FzdCgnZmlsZS11cGxvYWRlZCcsIHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgICAgICRzY29wZS5fc3VjY2VzcyhyZXNwb25zZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkc2NvcGUudXBsb2FkZXIub25Db21wbGV0ZUFsbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGxvZy5pbmZvKCdVcGxvYWRDb250cm9sbGVyIC0+IHVwbG9hZGVyIC0+IG9uQ29tcGxldGVBbGwnLCB7dXBsb2FkZXI6ICRzY29wZS51cGxvYWRlcn0pO1xyXG5cclxuICAgICAgICAgICAgdmFyIGhhc05vdFVwbG9hZGVkRmlsZXMgPSBmYWxzZTtcclxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKCRzY29wZS51cGxvYWRlci5xdWV1ZSwgZnVuY3Rpb24gKGZpbGUpIHtcclxuICAgICAgICAgICAgICAgIGlmICghZmlsZS5pc1JlYWR5ICYmICFmaWxlLmlzVXBsb2FkaW5nICYmICFmaWxlLmlzU3VjY2Vzcykge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhc05vdFVwbG9hZGVkRmlsZXMgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIGlmICghaGFzTm90VXBsb2FkZWRGaWxlcykge1xyXG4gICAgICAgICAgICAgICAgLy8gQ2xlYXIgbGlzIGZyb20gaXRlbXMgYW5kIGhpZGUgaXRcclxuICAgICAgICAgICAgICAgICRzY29wZS51cGxvYWRlci5jbGVhclF1ZXVlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG59KShhbmd1bGFyLCBqUXVlcnkpOyIsIihmdW5jdGlvbiAoYW5ndWxhciwgJCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGFuZ3VsYXJcclxuICAgICAgICAubW9kdWxlKCdmaWxlLm1hbmFnZXInKVxyXG4gICAgICAgIC5zZXJ2aWNlKCdEaXInLCBEaXIpO1xyXG5cclxuICAgIERpci4kaW5qZWN0ID0gW1xyXG4gICAgICAgICckbG9nJywgJyRyZXNvdXJjZScsICckcm9vdFNjb3BlJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBEaXIoJGxvZywgJHJlc291cmNlLCAkcm9vdFNjb3BlKSB7XHJcbiAgICAgICAgJGxvZy5sb2coJ0RpciByZXNvdXJjZSA8LSBzdGFydGVkJyk7XHJcblxyXG4gICAgICAgIHJldHVybiAkcmVzb3VyY2UoJHJvb3RTY29wZS5iYXNlVXJsKCkgKyAnZGlyLzpwYXRoJywge1xyXG4gICAgICAgICAgICBwYXRoOiAnQHBhdGgnXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn0pKGFuZ3VsYXIsIGpRdWVyeSk7IiwiKGZ1bmN0aW9uIChhbmd1bGFyLCAkKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgYW5ndWxhclxyXG4gICAgICAgIC5tb2R1bGUoJ2ZpbGUubWFuYWdlcicpXHJcbiAgICAgICAgLnNlcnZpY2UoJ0RpclNlcnZpY2UnLCBEaXJTZXJ2aWNlKTtcclxuXHJcbiAgICBEaXJTZXJ2aWNlLiRpbmplY3QgPSBbXHJcbiAgICAgICAgJyRsb2cnLCAnJHJvb3RTY29wZScsICckaHR0cCdcclxuICAgIF07XHJcblxyXG4gICAgZnVuY3Rpb24gRGlyU2VydmljZSgkbG9nLCAkcm9vdFNjb3BlLCAkaHR0cCkge1xyXG4gICAgICAgICRsb2cubG9nKCdEaXJTZXJ2aWNlIHNlcnZpY2UgPC0gc3RhcnRlZCcpO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBleHRlbmQ6IGV4dGVuZCxcclxuICAgICAgICAgICAgZXh0ZW5kSXRlbTogZXh0ZW5kSXRlbSxcclxuICAgICAgICAgICAgcmVuYW1lOiByZW5hbWUsXHJcbiAgICAgICAgICAgIGNyZWF0ZTogY3JlYXRlLFxyXG4gICAgICAgICAgICAnZGVsZXRlJzogZGVsZXRlRGlyLFxyXG4gICAgICAgICAgICBpZEdlbjogaWRHZW5cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBleHRlbmQoZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoYW5ndWxhci5pc0RlZmluZWQoZGF0YS5EaXJTZXJ2aWNlRXh0ZW5kZWQpICYmIGRhdGEuRGlyU2VydmljZUV4dGVuZGVkKVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoZGF0YSwge1xyXG4gICAgICAgICAgICAgICAgZGlyczogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBmb2xkZXJzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKGRhdGEsIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZS50eXBlID09ICdkaXInICYmIHZhbHVlLm5hbWUgIT0gJy4uJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZW5kSXRlbSh2YWx1ZSwga2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHVzaCh2YWx1ZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9LCBmb2xkZXJzKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZvbGRlcnM7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgaXRlbXM6IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbXMgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goZGF0YSwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZXh0ZW5kSXRlbSh2YWx1ZSwga2V5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wdXNoKHZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBpdGVtcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtcztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICBkYXRhLkRpclNlcnZpY2VFeHRlbmRlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBSZW5hbWVzIHBhdGggbGFzdCBwYXJ0IG50byBuZXcgbmFtZVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHBhdGggXCJwYXRoIHRvIHJlbmFtZVwiXHJcbiAgICAgICAgICogQHBhcmFtIG9sZE5hbWVcclxuICAgICAgICAgKiBAcGFyYW0gbmV3TmFtZSBcIm5ldyBuYW1lIGZvciBwYXRoIGxhc3QgZWxlbWVudFwiXHJcbiAgICAgICAgICogQHBhcmFtIG9uU3VjY2VzcyBcImNhbGxiYWNrIGZvciBzdWNjZXNzZnVsIHJlbmFtZVwiXHJcbiAgICAgICAgICogQHBhcmFtIG9uRXJyb3IgXCJjYWxsYmFjayBmb3IgZXJyb3JcIlxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIHJlbmFtZShwYXRoLCBvbGROYW1lLCBuZXdOYW1lLCBvblN1Y2Nlc3MsIG9uRXJyb3IpIHtcclxuICAgICAgICAgICAgdmFyIHVybCA9ICRyb290U2NvcGUuYmFzZVVybCgpICsgJ2Rpci9yZW5hbWUvJyArIHBhdGg7XHJcbiAgICAgICAgICAgICRodHRwLnBvc3QodXJsLCB7XHJcbiAgICAgICAgICAgICAgICAnb2xkJzogb2xkTmFtZSxcclxuICAgICAgICAgICAgICAgICduZXcnOiBuZXdOYW1lXHJcbiAgICAgICAgICAgIH0pLnRoZW4ob25TdWNjZXNzLCBvbkVycm9yKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZShwYXRoLCBuYW1lLCBvblN1Y2Nlc3MsIG9uRXJyb3IpIHtcclxuICAgICAgICAgICAgdmFyIHVybCA9ICRyb290U2NvcGUuYmFzZVVybCgpICsgJ2Rpci9jcmVhdGUvJyArIHBhdGg7XHJcbiAgICAgICAgICAgICRodHRwLnBvc3QodXJsLCB7XHJcbiAgICAgICAgICAgICAgICAnbmFtZSc6IG5hbWVcclxuICAgICAgICAgICAgfSkudGhlbihvblN1Y2Nlc3MsIG9uRXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlRGlyKHBhdGgsIG5hbWUsIG9uU3VjY2Vzcywgb25FcnJvcikge1xyXG4gICAgICAgICAgICB2YXIgdXJsID0gJHJvb3RTY29wZS5iYXNlVXJsKCkgKyAnZGlyL2RlbGV0ZS8nICsgcGF0aDtcclxuICAgICAgICAgICAgJGh0dHAucG9zdCh1cmwsIHtcclxuICAgICAgICAgICAgICAgICduYW1lJzogbmFtZVxyXG4gICAgICAgICAgICB9KS50aGVuKG9uU3VjY2Vzcywgb25FcnJvcik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBpZEdlbihrZXkpIHtcclxuICAgICAgICAgICAgcmV0dXJuICdsaXN0LWl0ZW0tJyArIGtleTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGV4dGVuZEl0ZW0oaXRlbSwga2V5KSB7XHJcbiAgICAgICAgICAgIGl0ZW0uaWQgPSBpZEdlbihrZXkpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoYW5ndWxhciwgalF1ZXJ5KTsiLCIoZnVuY3Rpb24gKGFuZ3VsYXIsICQpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBhbmd1bGFyXHJcbiAgICAgICAgLm1vZHVsZSgnZmlsZS5tYW5hZ2VyJylcclxuICAgICAgICAuc2VydmljZSgnRmlsZVNlcnZpY2UnLCBGaWxlU2VydmljZSk7XHJcblxyXG4gICAgRmlsZVNlcnZpY2UuJGluamVjdCA9IFtcclxuICAgICAgICAnJGxvZycsICckcm9vdFNjb3BlJywgJyRodHRwJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBGaWxlU2VydmljZSgkbG9nLCAkcm9vdFNjb3BlLCAkaHR0cCkge1xyXG4gICAgICAgICRsb2cubG9nKCdGaWxlU2VydmljZSBzZXJ2aWNlIDwtIHN0YXJ0ZWQnKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVuYW1lOiByZW5hbWUsXHJcbiAgICAgICAgICAgICdkZWxldGUnOiBkZWxldGVGaWxlXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcmVuYW1lKHBhdGgsIG9sZE5hbWUsIG5ld05hbWUsIG9uU3VjY2Vzcywgb25FcnJvcikge1xyXG4gICAgICAgICAgICAkbG9nLmxvZygnRmlsZVNlcnZpY2UgLT4gcmVuYW1lJywge3BhdGg6IHBhdGgsIG9sZE5hbWU6IG9sZE5hbWUsIG5ld05hbWU6IG5ld05hbWV9KTtcclxuXHJcbiAgICAgICAgICAgIHZhciB1cmwgPSAkcm9vdFNjb3BlLmJhc2VVcmwoKSArICdmaWxlL3JlbmFtZS8nICsgcGF0aDtcclxuICAgICAgICAgICAgJGh0dHAucG9zdCh1cmwsIHtcclxuICAgICAgICAgICAgICAgICdvbGQnOiBvbGROYW1lLFxyXG4gICAgICAgICAgICAgICAgJ25ldyc6IG5ld05hbWVcclxuICAgICAgICAgICAgfSkudGhlbihvblN1Y2Nlc3MsIG9uRXJyb3IpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZGVsZXRlRmlsZShwYXRoLCBuYW1lLCBvblN1Y2Nlc3MsIG9uRXJyb3IpIHtcclxuICAgICAgICAgICAgJGxvZy5sb2coJ0ZpbGVTZXJ2aWNlIC0+IGRlbGV0ZScsIHtwYXRoOiBwYXRoLCBuYW1lOiBuYW1lfSk7XHJcblxyXG4gICAgICAgICAgICB2YXIgdXJsID0gJHJvb3RTY29wZS5iYXNlVXJsKCkgKyAnZmlsZS9kZWxldGUvJyArIHBhdGg7XHJcbiAgICAgICAgICAgICRodHRwLnBvc3QodXJsLCB7XHJcbiAgICAgICAgICAgICAgICAnbmFtZSc6IG5hbWVcclxuICAgICAgICAgICAgfSkudGhlbihvblN1Y2Nlc3MsIG9uRXJyb3IpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxufSkoYW5ndWxhciwgalF1ZXJ5KTsiLCIoZnVuY3Rpb24gKG5nLCAkKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgbmdcbiAgICAgICAgLm1vZHVsZSgnZmlsZS5tYW5hZ2VyJylcbiAgICAgICAgLnNlcnZpY2UoJ1NldHRpbmdzJywgU2V0dGluZ3MpO1xuXG4gICAgU2V0dGluZ3MuJGluamVjdCA9IFtdO1xuXG4gICAgZnVuY3Rpb24gU2V0dGluZ3MoKSB7XG4gICAgICAgIHZhciAkc2V0dGluZ3MgPSAkKCcjc2V0dGluZ3MnKSwgcGFyYW1zID0gZmFsc2U7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlzVGFyZ2V0OiBpc1RhcmdldCxcbiAgICAgICAgICAgIGdldFR5cGU6IGdldFR5cGUsXG4gICAgICAgICAgICBnZXRUaHVtYlNpemU6IGdldFRodW1iU2l6ZSxcbiAgICAgICAgICAgIGdldFBhcmFtczogZ2V0UGFyYW1zXG4gICAgICAgIH07XG5cbiAgICAgICAgZnVuY3Rpb24gaXNUYXJnZXQoY3Vycl90YXJnZXQpIHtcbiAgICAgICAgICAgIHJldHVybiBnZXRQYXJhbXMoKS50YXJnZXQudG9Mb3dlckNhc2UoKSA9PT0gY3Vycl90YXJnZXQudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFR5cGUoKSB7XG4gICAgICAgICAgICByZXR1cm4gKGdldFBhcmFtcygpLnR5cGUgPyBwYXJhbXMudHlwZS50b0xvd2VyQ2FzZSgpIDogZmFsc2UpIHx8ICdmaWxlJztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFRodW1iU2l6ZShzaXplS2V5KSB7XG4gICAgICAgICAgICB2YXIgc2l6ZXMgPSBuZy5mcm9tSnNvbigkc2V0dGluZ3MuZGF0YSgnc2l6ZXMnKS5yZXBsYWNlKC9cXCcvZywgJ1wiJykpO1xuXG4gICAgICAgICAgICByZXR1cm4gc2l6ZXNbc2l6ZUtleV07XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRQYXJhbXMoKSB7XG4gICAgICAgICAgICBpZiAoIXBhcmFtcykge1xuICAgICAgICAgICAgICAgIHZhciBkYXRhUGFyYW1zID0gJHNldHRpbmdzLmRhdGEoJ3BhcmFtcycpO1xuICAgICAgICAgICAgICAgIC8vIGlmIHBhcmFtcyBpcyBlbXB0eSBhcnJheSwgaXQgYWxyZWFkeSBjb252ZXJ0ZWQgdG8gZW1wdHkgYXJyYXlcbiAgICAgICAgICAgICAgICBpZiAoZGF0YVBhcmFtcy5sZW5ndGggPT09IDApXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiB7fTtcblxuICAgICAgICAgICAgICAgIHBhcmFtcyA9IHN0ckZyb21Kc29uKGRhdGFQYXJhbXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHBhcmFtcztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGZpeFNlcmlhbGl6YWJsZVN0cihzdHIpIHtcbiAgICAgICAgcmV0dXJuIHN0ci5yZXBsYWNlKC9cXCcvZywgJ1wiJyk7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gc3RyRnJvbUpzb24oc3RyKSB7XG4gICAgICAgIHJldHVybiBuZy5mcm9tSnNvbihmaXhTZXJpYWxpemFibGVTdHIoc3RyKSk7XG4gICAgfVxufSkoYW5ndWxhciwgalF1ZXJ5KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
