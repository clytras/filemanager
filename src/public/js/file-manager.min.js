!function(i,n){"use strict";n.filemanager=i.module("crip.file-manager",["crip.core","angular-loading-bar","angularFileUpload","ngCookies","ngResource","ngSanitize","ui.bootstrap","ui-notification","io.dennis.contextmenu"])}(angular,window.crip||(window.crip={})),function(i,n,e){"use strict";function r(e){function r(i,n){e.$broadcast(i,n)}function o(i){return t.data("base-url")+i}var t=n("#settings");e.fireBroadcast=r,e.baseUrl=o,e.dirUrl=function(n,e){var r="dir/";return i.isDefined(e)&&(r+=e+"/"),r+=n,o(r)}}e.filemanager.run(r),r.$inject=["$rootScope"]}(angular,jQuery,window.crip||(window.crip={})),function(i,n){"use strict";function e(i,n,e){function r(){i.folderFilter=t,i.order={by:o,field:"name",isReverse:!1,name:!0,size:!1,date:!1},i.filters={image:!0,media:!0,document:!0,file:!0}}function o(n){var e="z {field}";if(n.isDir){if(n.isDirUp)return-1;e="0 {field}"}return e.supplant({field:n[i.order.field]})}function t(n,e,r){return n.isDir?!0:i.filters[n.type]}r()}n.filemanager.controller("DirContentController",e),e.$inject=["$scope","focus","Dir"]}(angular,window.crip||(window.crip={})),function(i,n){"use strict";function e(i){function n(){i.click=e}function e(n){n.isDir&&i.folder.goTo(n)}n()}n.filemanager.controller("DirItemController",e),e.$inject=["$scope"]}(angular,window.crip||(window.crip={})),function(i,n){"use strict";function e(n,e,r,o,t,a){function c(){e.folder={loading:!0,items:[],manager:f(),goTo:u},u(e.folder.manager)}function u(n,e){t.query(n,function(r){if(a.extend(r),l(r),i.isDefined(e))if(i.isArray(e))i.forEach(e,function(n){if(!i.isFunction(n))throw new Error("To change folder, you should pass an array of callbacks!");n(r)});else{if(!i.isFunction(e))throw new Error("To change folder, you should pass an array of callbacks or single callback!");e(r)}s(n)})}function f(e){e=i.isDefined(e)?e:{dir:"",name:""};var o=r.get("manager-dir"),t=r.get("manager-dir-name");return i.isDefined(o)&&""!=o&&(e.dir=o,t&&"null"!==t||(t=""),e.name=t),n.debug({getManagerCookieOrDefault:e}),e}function l(i){e.folder.items=i.getItems(),e.folder.loading=!1}function s(i){r.put("manager-dir",i.dir||""),r.put("manager-dir-name",i.name||""),e.folder.manager=i}c()}n.filemanager.controller("RootController",e),e.$inject=["$log","$scope","$cookies","Notification","Dir","DirResponseService"]}(angular,window.crip||(window.crip={})),function(i){"use strict";function n(i,n){return i(n.dirUrl(":dir/:name"),{dir:"@dir",name:"@name"})}i.filemanager.service("Dir",n),n.$inject=["$resource","$rootScope"]}(window.crip||(window.crip={})),function(i,n){"use strict";function e(n){function e(n){i.extend(n,{getItems:function(){var e=[];return i.forEach(n,function(i,n){a(i,n),this.push(i)},e),e}})}function r(i){return"list-item-"+i}function o(n){return n&&i.isDefined(n.type)&&"dir"===n.type}function t(i){return o(i)&&""==i.name}function a(i,n){i.identifier=r(n),i.isDir=o(i),i.isDirUp=t(i)}return{extend:e,extendItem:a}}n.filemanager.service("DirResponseService",e),e.$inject=["$rootScope"]}(angular,window.crip||(window.crip={}));
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9zb3VyY2UvbW9kdWxlLmpzIiwiL3NvdXJjZS9ydW4uanMiLCIvc291cmNlL2NvbnRyb2xsZXJzL0RpckNvbnRlbnRDb250cm9sbGVyLmpzIiwiL3NvdXJjZS9jb250cm9sbGVycy9EaXJJdGVtQ29udHJvbGxlci5qcyIsIi9zb3VyY2UvY29udHJvbGxlcnMvUm9vdENvbnRyb2xsZXIuanMiLCIvc291cmNlL3Jlc291cmNlcy9EaXIuanMiLCIvc291cmNlL3NlcnZpY2VzL0RpclJlc3BvbnNlU2VydmljZS5qcyJdLCJuYW1lcyI6WyJuZyIsImNyaXAiLCJmaWxlbWFuYWdlciIsIm1vZHVsZSIsImFuZ3VsYXIiLCJ3aW5kb3ciLCIkIiwiUnVuIiwiJHJvb3RTY29wZSIsImJyb2FkY2FzdCIsImV2ZW50TmFtZSIsImFyZ3MiLCIkYnJvYWRjYXN0IiwiYmFzZVVybCIsInBhdGgiLCIkc2V0dGluZ3MiLCJkYXRhIiwiZmlyZUJyb2FkY2FzdCIsImRpclVybCIsImRpciIsImFjdGlvbiIsImlzRGVmaW5lZCIsInJ1biIsIiRpbmplY3QiLCJqUXVlcnkiLCJEaXJDb250ZW50Q29udHJvbGxlciIsIiRzY29wZSIsImZvY3VzIiwiRGlyIiwiYWN0aXZhdGUiLCJmb2xkZXJGaWx0ZXIiLCJvcmRlciIsImJ5Iiwib3JkZXJCeSIsImZpZWxkIiwiaXNSZXZlcnNlIiwibmFtZSIsInNpemUiLCJkYXRlIiwiZmlsdGVycyIsImltYWdlIiwibWVkaWEiLCJkb2N1bWVudCIsImZpbGUiLCJpdGVtIiwidGV4dCIsImlzRGlyIiwiaXNEaXJVcCIsInN1cHBsYW50IiwidmFsdWUiLCJpbmRleCIsImFycmF5IiwidHlwZSIsImNvbnRyb2xsZXIiLCJEaXJJdGVtQ29udHJvbGxlciIsImNsaWNrIiwiZm9sZGVyIiwiZ29UbyIsIlJvb3RDb250cm9sbGVyIiwiJGxvZyIsIiRjb29raWVzIiwiTm90aWZpY2F0aW9uIiwiRGlyUmVzcG9uc2VTZXJ2aWNlIiwibG9hZGluZyIsIml0ZW1zIiwibWFuYWdlciIsImdldE1hbmFnZXJDb29raWVPckRlZmF1bHQiLCJkb0ZvbGRlckNoYW5nZSIsIm9uU3VjY2VzcyIsInF1ZXJ5IiwiciIsImV4dGVuZCIsIm9uTG9hZENvbXBsZXRlZCIsImlzQXJyYXkiLCJmb3JFYWNoIiwiYXJyYXlDYWxsYmFjayIsImlzRnVuY3Rpb24iLCJFcnJvciIsInVwZGF0ZUNvb2tpZSIsImNvb2tpZURpciIsImdldCIsImRlYnVnIiwicmVzcG9uc2UiLCJnZXRJdGVtcyIsInB1dCIsIiRyZXNvdXJjZSIsInNlcnZpY2UiLCJyZXNvdXJjZURhdGEiLCJ2IiwiayIsImV4dGVuZEl0ZW0iLCJ0aGlzIiwicHVzaCIsImlkR2VuIiwia2V5IiwiaWRlbnRpZmllciJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBQUEsRUFBQUMsR0FDQSxZQUVBQSxHQUFBQyxZQUFBRixFQUFBRyxPQUFBLHFCQUNBLFlBQ0Esc0JBQ0Esb0JBQ0EsWUFDQSxhQUNBLGFBQ0EsZUFDQSxrQkFDQSwyQkFFQUMsUUFBQUMsT0FBQUosT0FBQUksT0FBQUosVUNkQSxTQUFBRCxFQUFBTSxFQUFBTCxHQUNBLFlBU0EsU0FBQU0sR0FBQUMsR0E2QkEsUUFBQUMsR0FBQUMsRUFBQUMsR0FDQUgsRUFBQUksV0FBQUYsRUFBQUMsR0FTQSxRQUFBRSxHQUFBQyxHQUNBLE1BQUFDLEdBQUFDLEtBQUEsWUFBQUYsRUF2Q0EsR0FBQUMsR0FBQVQsRUFBQSxZQUVBRSxHQUFBUyxjQUFBUixFQUNBRCxFQUFBSyxRQUFBQSxFQVNBTCxFQUFBVSxPQUFBLFNBQUFDLEVBQUFDLEdBQ0EsR0FBQU4sR0FBQSxNQU1BLE9BTEFkLEdBQUFxQixVQUFBRCxLQUNBTixHQUFBTSxFQUFBLEtBRUFOLEdBQUFLLEVBRUFOLEVBQUFDLElBM0JBYixFQUFBQyxZQUNBb0IsSUFBQWYsR0FFQUEsRUFBQWdCLFNBQ0EsZUErQ0FuQixRQUFBb0IsT0FBQW5CLE9BQUFKLE9BQUFJLE9BQUFKLFVDdERBLFNBQUFELEVBQUFDLEdBQ0EsWUFTQSxTQUFB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eUQsRUFBQTdFLEdBQ0EsTUFBQTZFLEdBQUE3RSxFQUFBVSxPQUFBLGVBQ0FDLElBQUEsT0FDQWlCLEtBQUEsVUFWQW5DLEVBQUFDLFlBQ0FvRixRQUFBLE1BQUExRCxHQUVBQSxFQUFBTCxTQUNBLFlBQUEsZUFTQWxCLE9BQUFKLE9BQUFJLE9BQUFKLFVDaEJBLFNBQUFELEVBQUFDLEdBQ0EsWUFTQSxTQUFBNkQsR0FBQXRELEdBV0EsUUFBQStELEdBQUFnQixHQUNBdkYsRUFBQXVFLE9BQUFnQixHQUNBSixTQUFBLFdBQ0EsR0FBQW5CLEtBTUEsT0FMQWhFLEdBQUEwRSxRQUFBYSxFQUFBLFNBQUFDLEVBQUFDLEdBQ0FDLEVBQUFGLEVBQUFDLEdBQ0FFLEtBQUFDLEtBQUFKLElBQ0F4QixHQUVBQSxLQVdBLFFBQUE2QixHQUFBQyxHQUNBLE1BQUEsYUFBQUEsRUFTQSxRQUFBaEQsR0FBQUYsR0FDQSxNQUFBQSxJQUFBNUMsRUFBQXFCLFVBQUF1QixFQUFBUSxPQUFBLFFBQUFSLEVBQUFRLEtBU0EsUUFBQUwsR0FBQUgsR0FDQSxNQUFBRSxHQUFBRixJQUFBLElBQUFBLEVBQUFSLEtBU0EsUUFBQXNELEdBQUE5QyxFQUFBa0QsR0FDQWxELEVBQUFtRCxXQUFBRixFQUFBQyxHQUNBbEQsRUFBQUUsTUFBQUEsRUFBQUYsR0FDQUEsRUFBQUcsUUFBQUEsRUFBQUgsR0EvREEsT0FDQTJCLE9BQUFBLEVBQ0FtQixXQUFBQSxHQVZBekYsRUFBQUMsWUFDQW9GLFFBQUEscUJBQUF4QixHQUVBQSxFQUFBdkMsU0FDQSxlQXNFQW5CLFFBQUFDLE9BQUFKLE9BQUFJLE9BQUFKIiwiZmlsZSI6ImZpbGUtbWFuYWdlci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gKG5nLCBjcmlwKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgY3JpcC5maWxlbWFuYWdlciA9IG5nLm1vZHVsZSgnY3JpcC5maWxlLW1hbmFnZXInLCBbXHJcbiAgICAgICAgJ2NyaXAuY29yZScsXHJcbiAgICAgICAgJ2FuZ3VsYXItbG9hZGluZy1iYXInLFxyXG4gICAgICAgICdhbmd1bGFyRmlsZVVwbG9hZCcsXHJcbiAgICAgICAgJ25nQ29va2llcycsXHJcbiAgICAgICAgJ25nUmVzb3VyY2UnLFxyXG4gICAgICAgICduZ1Nhbml0aXplJyxcclxuICAgICAgICAndWkuYm9vdHN0cmFwJyxcclxuICAgICAgICAndWktbm90aWZpY2F0aW9uJyxcclxuICAgICAgICAnaW8uZGVubmlzLmNvbnRleHRtZW51J1xyXG4gICAgXSlcclxufSkoYW5ndWxhciwgd2luZG93LmNyaXAgfHwgKHdpbmRvdy5jcmlwID0ge30pKTsiLCIoZnVuY3Rpb24gKG5nLCAkLCBjcmlwKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgY3JpcC5maWxlbWFuYWdlclxyXG4gICAgICAgIC5ydW4oUnVuKTtcclxuXHJcbiAgICBSdW4uJGluamVjdCA9IFtcclxuICAgICAgICAnJHJvb3RTY29wZSdcclxuICAgIF07XHJcblxyXG4gICAgZnVuY3Rpb24gUnVuKCRyb290U2NvcGUpIHtcclxuICAgICAgICB2YXIgJHNldHRpbmdzID0gJCgnI3NldHRpbmdzJyk7XHJcblxyXG4gICAgICAgICRyb290U2NvcGUuZmlyZUJyb2FkY2FzdCA9IGJyb2FkY2FzdDtcclxuICAgICAgICAkcm9vdFNjb3BlLmJhc2VVcmwgPSBiYXNlVXJsO1xyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBHZXQgcGx1Z2luIGRpciBhY3Rpb24gdXJsXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gZGlyXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IFthY3Rpb25dXHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAgICAgKi9cclxuICAgICAgICAkcm9vdFNjb3BlLmRpclVybCA9IGZ1bmN0aW9uIChkaXIsIGFjdGlvbikge1xyXG4gICAgICAgICAgICB2YXIgcGF0aCA9ICdkaXIvJztcclxuICAgICAgICAgICAgaWYgKG5nLmlzRGVmaW5lZChhY3Rpb24pKSB7XHJcbiAgICAgICAgICAgICAgICBwYXRoICs9IGFjdGlvbiArICcvJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBhdGggKz0gZGlyO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGJhc2VVcmwocGF0aCk7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogRmlyZSBldmVudCBvbiByb290IHNjb3BlIGZvciBhbGwgY29udHJvbGxlcnNcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBldmVudE5hbWVcclxuICAgICAgICAgKiBAcGFyYW0ge0FycmF5fSBhcmdzXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gYnJvYWRjYXN0KGV2ZW50TmFtZSwgYXJncykge1xyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRicm9hZGNhc3QoZXZlbnROYW1lLCBhcmdzKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEdldCBwbHVnaW4gYmFzZSB1cmxcclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoXHJcbiAgICAgICAgICogQHJldHVybnMge3N0cmluZ31cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBiYXNlVXJsKHBhdGgpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRzZXR0aW5ncy5kYXRhKCdiYXNlLXVybCcpICsgcGF0aDtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG59KShhbmd1bGFyLCBqUXVlcnksIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7IiwiKGZ1bmN0aW9uIChuZywgY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuZmlsZW1hbmFnZXJcclxuICAgICAgICAuY29udHJvbGxlcignRGlyQ29udGVudENvbnRyb2xsZXInLCBEaXJDb250ZW50Q29udHJvbGxlcik7XHJcblxyXG4gICAgRGlyQ29udGVudENvbnRyb2xsZXIuJGluamVjdCA9IFtcclxuICAgICAgICAnJHNjb3BlJywgJ2ZvY3VzJywgJ0RpcidcclxuICAgIF07XHJcblxyXG4gICAgZnVuY3Rpb24gRGlyQ29udGVudENvbnRyb2xsZXIoJHNjb3BlLCBmb2N1cywgRGlyKSB7XHJcbiAgICAgICAgYWN0aXZhdGUoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5mb2xkZXJGaWx0ZXIgPSBmb2xkZXJGaWx0ZXI7XHJcbiAgICAgICAgICAgICRzY29wZS5vcmRlciA9IHtcclxuICAgICAgICAgICAgICAgIGJ5OiBvcmRlckJ5LFxyXG4gICAgICAgICAgICAgICAgZmllbGQ6ICduYW1lJyxcclxuICAgICAgICAgICAgICAgIGlzUmV2ZXJzZTogZmFsc2UsXHJcblxyXG4gICAgICAgICAgICAgICAgbmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIHNpemU6IGZhbHNlLFxyXG4gICAgICAgICAgICAgICAgZGF0ZTogZmFsc2VcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgJHNjb3BlLmZpbHRlcnMgPSB7XHJcbiAgICAgICAgICAgICAgICBpbWFnZTogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIG1lZGlhOiB0cnVlLFxyXG4gICAgICAgICAgICAgICAgZG9jdW1lbnQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgICBmaWxlOiB0cnVlXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBvcmRlckJ5KGl0ZW0pIHtcclxuICAgICAgICAgICAgdmFyIHRleHQgPSAneiB7ZmllbGR9JztcclxuICAgICAgICAgICAgaWYgKGl0ZW0uaXNEaXIpIHtcclxuICAgICAgICAgICAgICAgIC8vIGRpciB1cCBzaG91bGQgYmUgb24gZmlyc3QgcGxhY2VcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLmlzRGlyVXApXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgICAgICAgICAgICAgdGV4dCA9ICcwIHtmaWVsZH0nO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gdGV4dC5zdXBwbGFudCh7ZmllbGQ6IGl0ZW1bJHNjb3BlLm9yZGVyLmZpZWxkXX0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZm9sZGVyRmlsdGVyKHZhbHVlLCBpbmRleCwgYXJyYXkpIHtcclxuICAgICAgICAgICAgLy8gSWYgaXRlbSBpcyBkaXIsIGl0IHdpbGwgYmUgdmlzaWJsZVxyXG4gICAgICAgICAgICBpZiAodmFsdWUuaXNEaXIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIC8vIFRPRE86IGFkZCBmaWx0ZXIgZW5hYmxlIHByb3BlcnR5IGFuZCBjaGVjayBpdCBoZXJlXHJcbiAgICAgICAgICAgIGlmKHRydWUpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjb3BlLmZpbHRlcnNbdmFsdWUudHlwZV07XHJcblxyXG4gICAgICAgICAgICAvLyBpZiBmaWx0ZXIgZW5hYmxlIHByb3BlcnR5IGlzIGRpc2FibGVkLCBjb21wYXJlIHdpdGggYWxsb3dlZCB0eXBlXHJcbiAgICAgICAgICAgIC8vaWYgKFNldHRpbmdzLmdldFR5cGUoKSA9PSB2YWx1ZS50eXBlKVxyXG4gICAgICAgICAgICAvLyAgICByZXR1cm4gdHJ1ZTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn0pKGFuZ3VsYXIsIHdpbmRvdy5jcmlwIHx8ICh3aW5kb3cuY3JpcCA9IHt9KSk7IiwiKGZ1bmN0aW9uIChuZywgY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuZmlsZW1hbmFnZXJcclxuICAgICAgICAuY29udHJvbGxlcignRGlySXRlbUNvbnRyb2xsZXInLCBEaXJJdGVtQ29udHJvbGxlcik7XHJcblxyXG4gICAgRGlySXRlbUNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XHJcblxyXG4gICAgZnVuY3Rpb24gRGlySXRlbUNvbnRyb2xsZXIoJHNjb3BlKSB7XHJcbiAgICAgICAgYWN0aXZhdGUoKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XHJcbiAgICAgICAgICAgICRzY29wZS5jbGljayA9IGNsaWNrO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2xpY2soaXRlbSkge1xyXG4gICAgICAgICAgICBpZiAoaXRlbS5pc0Rpcikge1xyXG4gICAgICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5nb1RvKGl0ZW0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KShhbmd1bGFyLCB3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSkpOyIsIihmdW5jdGlvbiAobmcsIGNyaXApIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICBjcmlwLmZpbGVtYW5hZ2VyXHJcbiAgICAgICAgLmNvbnRyb2xsZXIoJ1Jvb3RDb250cm9sbGVyJywgUm9vdENvbnRyb2xsZXIpO1xyXG5cclxuICAgIFJvb3RDb250cm9sbGVyLiRpbmplY3QgPSBbXHJcbiAgICAgICAgJyRsb2cnLCAnJHNjb3BlJywgJyRjb29raWVzJywgJ05vdGlmaWNhdGlvbicsICdEaXInLCAnRGlyUmVzcG9uc2VTZXJ2aWNlJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBSb290Q29udHJvbGxlcigkbG9nLCAkc2NvcGUsICRjb29raWVzLCBOb3RpZmljYXRpb24sIERpciwgRGlyUmVzcG9uc2VTZXJ2aWNlKSB7XHJcblxyXG4gICAgICAgIGFjdGl2YXRlKCk7XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyID0ge1xyXG4gICAgICAgICAgICAgICAgbG9hZGluZzogdHJ1ZSxcclxuICAgICAgICAgICAgICAgIGl0ZW1zOiBbXSxcclxuICAgICAgICAgICAgICAgIG1hbmFnZXI6IGdldE1hbmFnZXJDb29raWVPckRlZmF1bHQoKSxcclxuICAgICAgICAgICAgICAgIGdvVG86IGRvRm9sZGVyQ2hhbmdlXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICBkb0ZvbGRlckNoYW5nZSgkc2NvcGUuZm9sZGVyLm1hbmFnZXIpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogQ2FsbCBwYWdlIGNvbnRlbnQgY2hhbmdlXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0ge29iamVjdH0gZm9sZGVyXHJcbiAgICAgICAgICogQHBhcmFtIHtzdHJpbmd9IGZvbGRlci5kaXJcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gZm9sZGVyLm5hbWVcclxuICAgICAgICAgKiBAcGFyYW0ge2NhbGxhYmxlfEFycmF5fSBbb25TdWNjZXNzXVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIGRvRm9sZGVyQ2hhbmdlKGZvbGRlciwgb25TdWNjZXNzKSB7XHJcbiAgICAgICAgICAgIERpci5xdWVyeShmb2xkZXIsIGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBBcHBlbmQgcmVzcG9uc2Ugd2l0aCByZXF1aXJlZCBpbmZvcm1hdGlvblxyXG4gICAgICAgICAgICAgICAgRGlyUmVzcG9uc2VTZXJ2aWNlLmV4dGVuZChyKTtcclxuICAgICAgICAgICAgICAgIG9uTG9hZENvbXBsZXRlZChyKTtcclxuXHJcbiAgICAgICAgICAgICAgICBpZiAobmcuaXNEZWZpbmVkKG9uU3VjY2VzcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJZiBwYXNzZWQgcGFyYW1ldGVyIGlzIGFycmF5LCBpdGVyYXRlIHRob3VnaCBpdCBhbmQgYW5kIGNhbGwgZWFjaCBjYWxsYmFja1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuZy5pc0FycmF5KG9uU3VjY2VzcykpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgbmcuZm9yRWFjaChvblN1Y2Nlc3MsIGZ1bmN0aW9uIChhcnJheUNhbGxiYWNrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmcuaXNGdW5jdGlvbihhcnJheUNhbGxiYWNrKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhcnJheUNhbGxiYWNrKHIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVG8gY2hhbmdlIGZvbGRlciwgeW91IHNob3VsZCBwYXNzIGFuIGFycmF5IG9mIGNhbGxiYWNrcyEnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIC8vIENhbGwgY2FsbGJhY2sgaWYgcGFyYW1ldGVyIGlzIG5vdCBhbiBhcnJheSBhbmQgaXMgY2FsbGFibGVcclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChuZy5pc0Z1bmN0aW9uKG9uU3VjY2VzcykpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG9uU3VjY2VzcyhyKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBJbiBvdGhlciBjYXNlIHRocm93IGVycm9yXHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RvIGNoYW5nZSBmb2xkZXIsIHlvdSBzaG91bGQgcGFzcyBhbiBhcnJheSBvZiBjYWxsYmFja3Mgb3Igc2luZ2xlIGNhbGxiYWNrIScpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIHVwZGF0ZUNvb2tpZShmb2xkZXIpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEdldCBtYW5hZ2VyIGxhc3QgbG9jYXRpb24gZnJvbSBjYWNoZSBvciBkZWZhdWx0IHJvb3QgZGlyXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gW21hbmFnZXJdXHJcbiAgICAgICAgICogQHJldHVybnMge3tkaXI6IHN0cmluZywgbmFtZTogc3RyaW5nfX1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBnZXRNYW5hZ2VyQ29va2llT3JEZWZhdWx0KG1hbmFnZXIpIHtcclxuICAgICAgICAgICAgbWFuYWdlciA9IG5nLmlzRGVmaW5lZChtYW5hZ2VyKSA/IG1hbmFnZXIgOiB7ZGlyOiAnJywgbmFtZTogJyd9O1xyXG5cclxuICAgICAgICAgICAgdmFyIGNvb2tpZURpciA9ICRjb29raWVzLmdldCgnbWFuYWdlci1kaXInKSxcclxuICAgICAgICAgICAgICAgIG5hbWUgPSAkY29va2llcy5nZXQoJ21hbmFnZXItZGlyLW5hbWUnKTtcclxuICAgICAgICAgICAgaWYgKG5nLmlzRGVmaW5lZChjb29raWVEaXIpICYmIGNvb2tpZURpciAhPSAnJykge1xyXG4gICAgICAgICAgICAgICAgbWFuYWdlci5kaXIgPSBjb29raWVEaXI7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKCFuYW1lIHx8IG5hbWUgPT09ICdudWxsJykge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgPSAnJztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIG1hbmFnZXIubmFtZSA9IG5hbWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRsb2cuZGVidWcoe2dldE1hbmFnZXJDb29raWVPckRlZmF1bHQ6IG1hbmFnZXJ9KTtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiBtYW5hZ2VyO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLyoqXHJcbiAgICAgICAgICogR3JhYiByZXNwb25zZSBkYXRhIGZyb20gcmVzb3VyY2UgcmVxdWVzdFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIHJlc3BvbnNlXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gb25Mb2FkQ29tcGxldGVkKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgIC8vJGxvZy5pbmZvKHJlc3BvbnNlKTtcclxuICAgICAgICAgICAgJHNjb3BlLmZvbGRlci5pdGVtcyA9IHJlc3BvbnNlLmdldEl0ZW1zKCk7XHJcbiAgICAgICAgICAgICRzY29wZS5mb2xkZXIubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAvLyRsb2cuaW5mbygkc2NvcGUuZm9sZGVyKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIFVwZGF0ZSBjb29raWVzIGZvciBuZXcgbWFuYWdlciBpbnN0YW5jZSwgdG8gYmUgb3BlbmVkIGluIHNhbWUgbG9jYXRpb25cclxuICAgICAgICAgKlxyXG4gICAgICAgICAqIEBwYXJhbSB7b2JqZWN0fSBmb2xkZXJcclxuICAgICAgICAgKiBAcGFyYW0ge3N0cmluZ30gZm9sZGVyLmRpclxyXG4gICAgICAgICAqIEBwYXJhbSB7c3RyaW5nfSBmb2xkZXIubmFtZVxyXG4gICAgICAgICAqL1xyXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZUNvb2tpZShmb2xkZXIpIHtcclxuICAgICAgICAgICAgJGNvb2tpZXMucHV0KCdtYW5hZ2VyLWRpcicsIGZvbGRlci5kaXIgfHwgJycpO1xyXG4gICAgICAgICAgICAkY29va2llcy5wdXQoJ21hbmFnZXItZGlyLW5hbWUnLCBmb2xkZXIubmFtZSB8fCAnJyk7XHJcbiAgICAgICAgICAgIC8vJGxvZy5kZWJ1Zyhmb2xkZXIpO1xyXG4gICAgICAgICAgICAkc2NvcGUuZm9sZGVyLm1hbmFnZXIgPSBmb2xkZXI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KShhbmd1bGFyLCB3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSkpOyIsIihmdW5jdGlvbiAoY3JpcCkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgIGNyaXAuZmlsZW1hbmFnZXJcclxuICAgICAgICAuc2VydmljZSgnRGlyJywgRGlyKTtcclxuXHJcbiAgICBEaXIuJGluamVjdCA9IFtcclxuICAgICAgICAnJHJlc291cmNlJywgJyRyb290U2NvcGUnXHJcbiAgICBdO1xyXG5cclxuICAgIGZ1bmN0aW9uIERpcigkcmVzb3VyY2UsICRyb290U2NvcGUpIHtcclxuICAgICAgICByZXR1cm4gJHJlc291cmNlKCRyb290U2NvcGUuZGlyVXJsKCc6ZGlyLzpuYW1lJyksIHtcclxuICAgICAgICAgICAgZGlyOiAnQGRpcicsXHJcbiAgICAgICAgICAgIG5hbWU6ICdAbmFtZSdcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSkod2luZG93LmNyaXAgfHwgKHdpbmRvdy5jcmlwID0ge30pKTsiLCIoZnVuY3Rpb24gKG5nLCBjcmlwKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgY3JpcC5maWxlbWFuYWdlclxyXG4gICAgICAgIC5zZXJ2aWNlKCdEaXJSZXNwb25zZVNlcnZpY2UnLCBEaXJSZXNwb25zZVNlcnZpY2UpO1xyXG5cclxuICAgIERpclJlc3BvbnNlU2VydmljZS4kaW5qZWN0ID0gW1xyXG4gICAgICAgICckcm9vdFNjb3BlJ1xyXG4gICAgXTtcclxuXHJcbiAgICBmdW5jdGlvbiBEaXJSZXNwb25zZVNlcnZpY2UoJHJvb3RTY29wZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICdleHRlbmQnOiBleHRlbmQsXHJcbiAgICAgICAgICAgICdleHRlbmRJdGVtJzogZXh0ZW5kSXRlbVxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEV4dGVuZCBEaXIgcmVzb3VyY2UgcmVxdWVzdCByZXNwb25zZSB3aXRoIHJlcXVpcmVkIGluZm9ybWF0aW9uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gcmVzb3VyY2VEYXRhXHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gZXh0ZW5kKHJlc291cmNlRGF0YSkge1xyXG4gICAgICAgICAgICBuZy5leHRlbmQocmVzb3VyY2VEYXRhLCB7XHJcbiAgICAgICAgICAgICAgICAnZ2V0SXRlbXMnOiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1zID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgbmcuZm9yRWFjaChyZXNvdXJjZURhdGEsIGZ1bmN0aW9uICh2LCBrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4dGVuZEl0ZW0odiwgayk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHVzaCh2KTtcclxuICAgICAgICAgICAgICAgICAgICB9LCBpdGVtcyk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtcztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBHZW5lcmF0ZSBVSSBpZCBmb3IgaXRlbVxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGtleVxyXG4gICAgICAgICAqIEByZXR1cm5zIHtzdHJpbmd9XHJcbiAgICAgICAgICovXHJcbiAgICAgICAgZnVuY3Rpb24gaWRHZW4oa2V5KSB7XHJcbiAgICAgICAgICAgIHJldHVybiAnbGlzdC1pdGVtLScgKyBrZXk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBEZXRlcm1pbmUgaXMgaXRlbSBhIGZvbGRlclxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGl0ZW1cclxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBpc0RpcihpdGVtKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBpdGVtICYmIG5nLmlzRGVmaW5lZChpdGVtLnR5cGUpICYmIGl0ZW0udHlwZSA9PT0gJ2Rpcic7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvKipcclxuICAgICAgICAgKiBEZXRlcm1pbmUgaXMgaXRlbSBhbiBhIGZvbGRlciB1cFxyXG4gICAgICAgICAqXHJcbiAgICAgICAgICogQHBhcmFtIGl0ZW1cclxuICAgICAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn1cclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBpc0RpclVwKGl0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGlzRGlyKGl0ZW0pICYmIGl0ZW0ubmFtZSA9PSAnJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8qKlxyXG4gICAgICAgICAqIEV4dGVuZCBzaW5nbGUgaXRlbSB3aXRoIHJlcXVpcmVkIGluZm9ybWF0aW9uXHJcbiAgICAgICAgICpcclxuICAgICAgICAgKiBAcGFyYW0gaXRlbVxyXG4gICAgICAgICAqIEBwYXJhbSBrZXlcclxuICAgICAgICAgKi9cclxuICAgICAgICBmdW5jdGlvbiBleHRlbmRJdGVtKGl0ZW0sIGtleSkge1xyXG4gICAgICAgICAgICBpdGVtLmlkZW50aWZpZXIgPSBpZEdlbihrZXkpO1xyXG4gICAgICAgICAgICBpdGVtLmlzRGlyID0gaXNEaXIoaXRlbSk7XHJcbiAgICAgICAgICAgIGl0ZW0uaXNEaXJVcCA9IGlzRGlyVXAoaXRlbSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59KShhbmd1bGFyLCB3aW5kb3cuY3JpcCB8fCAod2luZG93LmNyaXAgPSB7fSkpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
